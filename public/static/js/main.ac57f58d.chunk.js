(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{158:function(e,t,n){},177:function(e,t){},268:function(e){e.exports=JSON.parse('{"v":"4.8.0","meta":{"g":"LottieFiles AE 1.1.0","a":"","k":"","d":"","tc":""},"fr":25,"ip":0,"op":66,"w":800,"h":800,"nm":"Comp 1","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"dot3","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":5,"s":[551,397.941,0],"to":[0,-22.5,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":12,"s":[551,262.941,0],"to":[0,0,0],"ti":[0,-6.667,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":18,"s":[551,397.941,0],"to":[0,6.667,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":23.334,"s":[551,302.941,0],"to":[0,0,0],"ti":[0,-4.833,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":28.667,"s":[551,397.941,0],"to":[0,4.833,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":34,"s":[551,331.941,0],"to":[0,0,0],"ti":[0,-2.5,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":39.334,"s":[551,397.941,0],"to":[0,2.5,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":44.667,"s":[551,346.941,0],"to":[0,0,0],"ti":[0,-4.667,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":50.889,"s":[551,397.941,0],"to":[0,4.667,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.167,"y":0},"t":58,"s":[551,374.941,0],"to":[0,0,0],"ti":[0,-3.833,0]},{"t":65.111328125,"s":[551,397.941,0]}],"ix":2},"a":{"a":0,"k":[1335.652,770.152,0],"ix":1},"s":{"a":0,"k":[130,130,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[74.305,74.305],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.258990747788,0.286569991766,0.955193014706,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[1327.957,768.566],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":66,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"dot2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":2,"s":[408,397.941,0],"to":[0,-22.5,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":9.444,"s":[408,262.941,0],"to":[0,0,0],"ti":[0,-6.667,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":14.889,"s":[408,397.941,0],"to":[0,6.667,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":20.223,"s":[408,302.941,0],"to":[0,0,0],"ti":[0,-4.833,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":25.556,"s":[408,397.941,0],"to":[0,4.833,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":30.889,"s":[408,331.941,0],"to":[0,0,0],"ti":[0,-2.5,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":36.223,"s":[408,397.941,0],"to":[0,2.5,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":41.556,"s":[408,346.941,0],"to":[0,0,0],"ti":[0,-4.667,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":47.777,"s":[408,397.941,0],"to":[0,4.667,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.167,"y":0},"t":54.889,"s":[408,374.941,0],"to":[0,0,0],"ti":[0,-3.833,0]},{"t":62,"s":[408,397.941,0]}],"ix":2},"a":{"a":0,"k":[1335.652,770.152,0],"ix":1},"s":{"a":0,"k":[130,130,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[74.305,74.305],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.256910286698,0.489340928022,0.917356004902,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[1327.957,768.566],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":66,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"dot1","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":0,"s":[267,397.941,0],"to":[0,-22.5,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":5.444,"s":[267,262.941,0],"to":[0,0,0],"ti":[0,-6.667,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":11.889,"s":[267,397.941,0],"to":[0,6.667,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":18.223,"s":[267,302.941,0],"to":[0,0,0],"ti":[0,-4.833,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":23.556,"s":[267,397.941,0],"to":[0,4.833,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":28.889,"s":[267,331.941,0],"to":[0,0,0],"ti":[0,-2.5,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":34.223,"s":[267,397.941,0],"to":[0,2.5,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":39.556,"s":[267,346.941,0],"to":[0,0,0],"ti":[0,-4.667,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":45.777,"s":[267,397.941,0],"to":[0,4.667,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.167,"y":0},"t":52.889,"s":[267,374.941,0],"to":[0,0,0],"ti":[0,-3.833,0]},{"t":60,"s":[267,397.941,0]}],"ix":2},"a":{"a":0,"k":[1335.652,770.152,0],"ix":1},"s":{"a":0,"k":[130,130,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[74.305,74.305],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"fl","c":{"a":0,"k":[0.374571078431,0.662682267731,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[1327.957,768.566],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":66,"st":0,"bm":0}],"markers":[]}')},297:function(e,t,n){},298:function(e,t,n){},837:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(68),s=n.n(r),c=(n(297),n(298),n(861)),i=n(862),o=n(863),l=n(897),u=n(26),d=n(9),j=n.n(d),b=n(12),p=n(5),x=n(279),h=n(122),f=n(857),O=n(895),g=n(858),m=n(859),v=n(894),k=n(14),y=n.n(k),C=n(886),w=n(2),S=function(){var e=Object(a.useState)(!1),t=Object(p.a)(e,2),n=t[0],r=(t[1],Object(a.useState)()),s=Object(p.a)(r,2),c=s[0],i=s[1],o=Object(a.useState)(),l=Object(p.a)(o,2),d=l[0],k=l[1],S=Object(a.useState)(!1),A=Object(p.a)(S,2),E=A[0],z=A[1],_=Object(C.a)(),F=Object(u.e)(),I=function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z(!0),c&&d){e.next=5;break}return _({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),z(!1),e.abrupt("return");case 5:return e.prev=5,t={headers:{"Content-type":"application/json"}},e.next=9,y.a.post("/api/user/login",{email:c,password:d},t);case 9:n=e.sent,a=n.data,_({title:"Login Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(a)),z(!1),F.push("/provider"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),_({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),z(!1);case 21:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(v.b,{spacing:"10px",children:[Object(w.jsxs)(h.a,{id:"email",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Email or phone "}),Object(w.jsx)(O.a,{type:"email",placeholder:"Enter Your Email or Phone",onChange:function(e){return i(e.target.value)}})]}),Object(w.jsxs)(h.a,{id:"password",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Password"}),Object(w.jsxs)(g.a,{size:"md",children:[Object(w.jsx)(O.a,{onChange:function(e){return k(e.target.value)},type:n?"text":"password",placeholder:"Enter password"}),Object(w.jsx)(m.a,{width:"4.5rem"})]})]}),Object(w.jsx)(x.a,{colorScheme:"green",width:"100%",style:{marginTop:15},onClick:I,isLoading:E,children:"Login"})]})},A=n(151),E=n(896),z=function(){var e=Object(a.useState)(!1),t=Object(p.a)(e,2),n=t[0],r=t[1],s=function(){return r(!n)},c=Object(a.useState)(""),i=Object(p.a)(c,2),o=i[0],l=i[1],d=Object(a.useState)(""),k=Object(p.a)(d,2),S=k[0],z=k[1],_=Object(a.useState)(""),F=Object(p.a)(_,2),I=F[0],B=F[1],N=Object(a.useState)(""),D=Object(p.a)(N,2),R=D[0],M=D[1],P=Object(a.useState)(),Y=Object(p.a)(P,2),L=Y[0],W=Y[1],T=Object(a.useState)(!1),H=Object(p.a)(T,2),U=H[0],G=H[1],K=Object(C.a)(),q=Object(u.e)(),J=Object(a.useState)(""),V=Object(p.a)(J,2),Z=V[0],Q=V[1],X=Object(a.useState)(),$=Object(p.a)(X,2),ee=$[0],te=$[1],ne=Object(a.useState)("2"),ae=Object(p.a)(ne,2),re=ae[0],se=ae[1],ce=function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,a,r,s,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G(!0),t=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,n=/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/,a=(new Date).getFullYear(),r=new Date(ee).getFullYear(),!(o.length<=0)){e.next=9;break}return K({title:"Please Enter your name ",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),G(!1),e.abrupt("return");case 9:if(!(a-r<0)){e.next=13;break}return K({title:"Age > 0",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),G(!1),e.abrupt("return");case 13:if(t.test(S)){e.next=17;break}return K({title:"Please enter a valid email address",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),G(!1),e.abrupt("return");case 17:if(!(R.length<=6)){e.next=21;break}return K({title:"Password must be more than 6 characters",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),G(!1),e.abrupt("return");case 21:if(R===I){e.next=25;break}return K({title:"Passwords Do Not Match",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),G(!1),e.abrupt("return");case 25:if(n.test(Z)){e.next=29;break}return K({title:"Phone number is required just number, from 10 to 12 characters",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),G(!1),e.abrupt("return");case 29:return e.prev=29,console.log("sex",re),s={headers:{"Content-type":"application/json"}},e.next=34,y.a.post("/api/user",{name:o,email:S,password:R,phone:Z,sex:re,birth:ee,pic:L},s);case 34:c=e.sent,i=c.data,console.log(i),K({title:"Please check your email for further instructions on how to complete your account register.",status:"success",duration:7e3,isClosable:!0,position:"bottom"}),G(!1),q.push("/"),e.next=46;break;case 42:e.prev=42,e.t0=e.catch(29),K({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),G(!1);case 46:case"end":return e.stop()}}),e,null,[[29,42]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(v.b,{spacing:"5px",children:[Object(w.jsxs)(h.a,{id:"first-name",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Name"}),Object(w.jsx)(O.a,{placeholder:"Enter Your Name",onChange:function(e){return l(e.target.value)}})]}),Object(w.jsxs)(h.a,{id:"birthday",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Birthday"}),Object(w.jsx)(O.a,{type:"date",onChange:function(e){te(e.target.value)}})]}),Object(w.jsxs)(h.a,{id:"sex",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Sex"}),Object(w.jsx)(A.a,{value:re,onChange:se,children:Object(w.jsxs)(v.a,{direction:"row",children:[Object(w.jsx)(E.a,{colorScheme:"green",value:"1",children:"Male"}),Object(w.jsx)(E.a,{colorScheme:"green",value:"2",children:"Female"}),Object(w.jsx)(E.a,{colorScheme:"green",value:"3",children:"Other"})]})})]}),Object(w.jsxs)(h.a,{id:"email",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Email Address"}),Object(w.jsx)(O.a,{type:"email",placeholder:"Enter Your Email Address",onChange:function(e){return z(e.target.value)}})]}),Object(w.jsxs)(h.a,{id:"password",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Password"}),Object(w.jsxs)(g.a,{size:"md",children:[Object(w.jsx)(O.a,{type:n?"text":"password",placeholder:"Enter Password",onChange:function(e){return M(e.target.value)}}),Object(w.jsx)(m.a,{width:"4.5rem",children:Object(w.jsx)(x.a,{h:"1.75rem",size:"sm",onClick:s,children:n?"Hide":"Show"})})]})]}),Object(w.jsxs)(h.a,{id:"password",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Confirm Password"}),Object(w.jsxs)(g.a,{size:"md",children:[Object(w.jsx)(O.a,{type:n?"text":"password",placeholder:"Confirm password",onChange:function(e){return B(e.target.value)}}),Object(w.jsx)(m.a,{width:"4.5rem",children:Object(w.jsx)(x.a,{h:"1.75rem",size:"sm",onClick:s,children:n?"Hide":"Show"})})]})]}),Object(w.jsxs)(h.a,{id:"phone",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Phone Number"}),Object(w.jsx)(O.a,{type:"tel",p:1.5,required:!0,pattern:"[0-9]{3}-[0-9]{2}-[0-9]{3}",placeholder:"Enter Your Phone Number",onChange:function(e){return Q(e.target.value)}})]}),Object(w.jsxs)(h.a,{id:"pic",children:[Object(w.jsx)(f.a,{children:"Upload your Picture"}),Object(w.jsx)(O.a,{type:"file",p:1.5,accept:"image/*",onChange:function(e){return function(e){if(G(!0),void 0!==e){if(console.log(e),"image/jpeg"!==e.type&&"image/png"!==e.type)return K({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void G(!1);var t=new FormData;t.append("file",e),t.append("upload_preset","MongoChat04"),t.append("cloud_name","dfgkg5eej"),fetch("https://api.cloudinary.com/v1_1/dfgkg5eej/image/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){W(e.url.toString()),G(!1)})).catch((function(e){console.log(e),G(!1)}))}else K({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})}(e.target.files[0])}})]}),Object(w.jsx)(x.a,{colorScheme:"green",width:"100%",style:{marginTop:15},onClick:ce,isLoading:U,children:"Sign Up"})]})},_=n.p+"static/media/message-logo-removebg-preview.b66391f0.png",F=Object(a.createContext)({}),I=function(){return Object(a.useContext)(F)},B=function(e){var t=e.children,n=Object(a.useState)(null),r=Object(p.a)(n,2),s=r[0],c=r[1],i=Object(a.useState)(JSON.parse(localStorage.getItem("userInfo"))),o=Object(p.a)(i,2),l=o[0],d=o[1],j=Object(a.useState)([]),b=Object(p.a)(j,2),x=b[0],h=b[1],f=Object(a.useState)([]),O=Object(p.a)(f,2),g=O[0],m=O[1],v=Object(a.useState)(),k=Object(p.a)(v,2),y=k[0],C=k[1],S=Object(a.useState)([]),A=Object(p.a)(S,2),E=A[0],z=A[1],_=Object(a.useState)(!1),I=Object(p.a)(_,2),B=I[0],N=I[1],D=Object(u.e)();return Object(a.useEffect)((function(){l?B?D.push("/friend"):D.push("/chats"):D.push("/")}),[D]),Object(w.jsx)(F.Provider,{value:{user:l,setuser:d,selectedChat:s,setSelectedChat:c,notification:x,setNotification:h,chats:g,setChats:m,selectedFriend:B,setselectedFriend:N,socket:y,setSocket:C,input:E,setInput:z},children:t})};var N=function(){var e=Object(u.e)();return Object(a.useEffect)((function(){var t=JSON.parse(localStorage.getItem("userInfo"));console.log("Home page: ",t),t&&e.push("/chats")}),[e]),Object(w.jsxs)(c.a,{maxW:"xl",centerContent:!0,children:[Object(w.jsx)(i.a,{d:"flex",justifyContent:"center",p:3,bg:"white",w:"100%",m:"40px 0 15px 0",borderRadius:"lg",borderWidth:"1px",mt:"4rem",children:Object(w.jsx)(o.a,{src:_,w:"37%"})}),Object(w.jsx)(i.a,{bg:"white",w:"100%",p:4,borderRadius:"lg",borderWidth:"1px",children:Object(w.jsxs)(l.e,{isFitted:!0,variant:"soft-rounded",colorScheme:"green",children:[Object(w.jsxs)(l.b,{mb:"1em",children:[Object(w.jsx)(l.a,{children:"Login"}),Object(w.jsx)(l.a,{children:"Sign Up"})]}),Object(w.jsxs)(l.d,{children:[Object(w.jsx)(l.c,{children:Object(w.jsx)(S,{})}),Object(w.jsx)(l.c,{children:Object(w.jsx)(z,{})})]})]})})]})},D=(n(158),n(20)),R=n(869),M=n(867),P=n(860),Y=function(e,t,n,a){return n<e.length-1&&e[n+1].sender._id===t.sender._id&&e[n].sender._id!==a?"auto auto auto 38px":n<e.length-1&&e[n+1].sender._id!==t.sender._id&&e[n].sender._id!==a||n===e.length-1&&e[n].sender._id!==a?"auto auto auto 0px":"auto 10px auto auto"},L=function(e,t,n,a){return n<e.length-1&&(e[n+1].sender._id!==t.sender._id||void 0===e[n+1].sender._id)&&e[n].sender._id!==a},W=function(e,t,n){return t===e.length-1&&e[e.length-1].sender._id!==n&&e[e.length-1].sender._id},T=function(e,t,n){return n>0&&e[n-1].sender._id===t.sender._id},H=function(e,t){return t[0]._id===e._id?t[1].name:t[0].name},U=function(e,t,n){return t>0&&e.sender._id===n},G=function(e,t){return t[0]._id===e._id?t[1].pic:t[0].pic},K=function(e,t){return t[0]._id===e._id?t[1]:t[0]},q=n(866),J=n(877),V=n(878),Z=n(868),Q=n(107),X=n(888),$=n(870),ee=n(66),te=function(e){var t=e.user,n=e.children,r=e.statusFiend,s=Object(q.a)(),c=s.isOpen,i=s.onOpen,l=s.onClose,u=(I().selectedChat,JSON.parse(localStorage.getItem("userInfo")),Object(a.useState)(!1)),d=Object(p.a)(u,2),h=(d[0],d[1]),f=Object(C.a)(),O=function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 5:t=e.sent,t.data,l(!0),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),f({title:"Error Occured!",description:"FRIEND",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),h(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[n?Object(w.jsx)("span",{onClick:i,children:n}):Object(w.jsx)(M.a,{d:{base:"flex"},icon:Object(w.jsx)(Z.a,{}),onClick:i}),Object(w.jsxs)(ee.a,{size:"lg",onClose:l,isOpen:c,isCentered:!0,children:[Object(w.jsx)(ee.h,{}),Object(w.jsxs)(ee.d,{h:"410px",children:[Object(w.jsx)(ee.g,{fontSize:"40px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:t.name}),Object(w.jsx)(ee.c,{}),Object(w.jsxs)(ee.b,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:[Object(w.jsx)(o.a,{borderRadius:"full",boxSize:"150px",src:t.pic,alt:t.name}),Object(w.jsxs)(R.a,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",children:["Email: ",t.email]})]}),Object(w.jsxs)(ee.f,{children:[(console.log("TINH TRANG:",r),void 0!==r&&2==r[0].status&&Object(w.jsx)(x.a,{onClick:O,colorScheme:"red",mr:5,children:"Unfriend"})),Object(w.jsx)(x.a,{onClick:l,children:"Close"})]})]})]})]})},ne=n(871),ae=n(872),re=function(e){var t=e.messages,n=e.m,r=e.i,s=e.socket,c=Object(a.useState)("none"),l=Object(p.a)(c,2),u=l[0],d=l[1],x=Object(a.useState)(),h=Object(p.a)(x,2),f=h[0],O=h[1],g=Object(C.a)(),m=function(e){if("image"!=e)return"block",e},v=function(e){return new Date(e).toLocaleString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"})},k=I().user,S=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),f){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(k.token)}},e.next=9,y.a.post("/api/message/recallMessage",{id:f._id},n);case 9:a=e.sent,r=a.data,s.emit("recall message",r),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),g({title:"Error Occured!",description:"Box Message - Recall Message error",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(i.a,{style:{display:"flex"},children:[(L(t,n,r,k._id)||W(t,r,k._id))&&Object(w.jsx)(te,{user:n.sender,children:Object(w.jsx)($.a,{mt:"7px",mr:1,size:"sm",cursor:"pointer",name:n.sender.name,src:n.sender.pic,onClick:function(){}})}),!n.recallMessage&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(i.a,{w:"100%",h:"25%",d:"flex",onMouseEnter:function(){d("flex"),O(n)},onMouseLeave:function(){d("none"),O(null)},children:"image"===n.content?Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(i.a,{display:"flex",width:"100%",justifyContent:"space-between",children:Object(w.jsxs)(i.a,{style:{margin:Y(t,n,r,k._id),marginTop:T(t,n,r,k._id)?3:10,minWidth:"0px",maxWidth:"300px",position:"relative"},children:[Object(w.jsx)(o.a,{minHeight:"0px",maxHeight:"300px",borderRadius:5,src:function(e){if(e)return"none",e}(n.pic)}),Object(w.jsx)(R.a,{}),Object(w.jsxs)(X.a,{children:[Object(w.jsx)(X.b,{as:M.a,fontSize:"15px",size:"xs",style:{zIndex:"162",backgroundColor:"white",position:"absolute",bottom:0,right:U(n,r,k._id)?"".concat(n.pic).size:-30,display:"".concat(u)},icon:Object(w.jsx)(ne.a,{}),onClick:function(){return d("flex")}}),Object(w.jsxs)(X.e,{mt:"-20px",style:{right:U(n,r,k._id)?0:-240,zIndex:"2",d:"flex",position:"absolute"},children:[Object(w.jsxs)(X.d,{color:"red",onClick:S,children:[Object(w.jsx)(ae.a,{color:"red",mr:"10px"}),"Recall Message"]}),Object(w.jsx)(X.c,{})]})]})]})})}):Object(w.jsx)(w.Fragment,{children:void 0!==n.file?Object(w.jsxs)("a",{style:{display:"flex",backgroundColor:"".concat(n.sender._id===k._id?"#B9F5D0":"#ffffff"),margin:Y(t,n,r,k._id),marginTop:T(t,n,r,k._id)?3:10,borderRadius:"8px",padding:"5px 15px",minWidth:"140px",maxWidth:"80%",height:"70"},href:n.file,children:[Object(w.jsx)(o.a,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAABYgAAAWIBXyfQUwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAO/SURBVHic7ZpPaBxVHMc/783sbroxBNuiLbZU8U9FY8CDQqkHweqh4D9oMKCiJhQtVDwIKsVepAcPggjqQcSrrRRBQalYKootYhFUGmJYqi1tLSpuU5LaZrPzfh42Na5sdibzXubtmvlcdubtb76/73z37Xu77EJOTk7OMkZZK3wwVET6n0GZW1NaiBD5kEfeO2jtJU13a4V9I6+h1POWKgajNjP87jfWfhaJtlZQaosTH1pecaCTorE9BQcaAPeyb3SzI63EuAjAHYpdWbfsrABgK3u335Flw04LALTZgzhYnBPiYBscHQNusbfSxOfAx6BqAFTLg0RBv9MOyoyz441XYwOQL+4OKdYeBza2ev6tCytHp41avdD1M6LZe6mP8dlSerNn++Giq7X2X5RrP8QH8PVdb4PssOkzJZrbfr+Ok1HKm1iqAAIj8WuAcL9tnz5leLnvT1sZ90RaxQegxGLuzvPEivNcG866kHJKZrtAQQkv9FazapeYTLfB0fIkG4LOmgWZBlBUwq4OWwvCrBtuL0+iBA7VykSi2FSfjr9oZRXqi3utvvzrSj6aWhVbp2RoKOCa6sOIvr5lxcDsbrT0LqgQCqwzUJJFGfyHE5fSXZeA/bKGoTMDbWtC1p57B1EjsMANHEswSSYM3DfjYT6158Hwj9gajWLYutMFDZUl+KBiSSAmtkYDZSfdKgHUnShlirtdYEbB8Q57DyTA7Tb4U6HrZoHbAGp03Sxw7/ZYAYyCVREY4NeL7eurKaaMVnBVAFekctiE+wAMc1tnCFEdJs46bwE0QrhzNWwM7GQc2ckeIzCW4FNkDN0bAEA9fp+Po7sDcEAegG8DvskD8G3AN3kAvg34Jg/AtwGvqOUeQE/9dHd9d01Db631/460nKY09fT/OgCNGJ59fVP7mmVOHoBvA77JA/BtgOGd8Oan8NSLoOb+sBKGsHNPY3zro+m1lYr9vc7vLnDz7TDyUuP4pkEYOwrfHoJ7tsEDTzbGbxyA776C304tXr+kTsSV+A3g6vXN52s3NB7XrJsfU7px3ioAQejRZ1ooGzQTUHgszoLfAKbPN59PnZt7/O/4ZOvrjdTUtqPrWz+ZDL9rwPeH4chn88eHDzSOD+6Hyo8gBg68Dz+PL5kFJc9tSfnDfgKiOkxU4usKRZitJR+/TLE4oz75pSe9Qd8z4DIL3WS7m3dEZwTgEQ1Evk1YYP321QhHXDjxQqlw3FYixKhhAtmNcIMLT02ICimvGHSvi1AIKxTDh5xr5+Tk5Cwn/gboKu+NfeitigAAAABJRU5ErkJggg==",mr:5}),Object(w.jsxs)(i.a,{children:[Object(w.jsx)(R.a,{fontWeight:"bold",children:m(n.content)}),Object(w.jsxs)(i.a,{display:"flex",mt:3,justifyContent:"space-between",children:[Object(w.jsx)(R.a,{fontSize:"15px",color:"gray",paddingRight:"0px",display:"flex",children:v(n.createdAt)}),Object(w.jsxs)(X.a,{children:[Object(w.jsx)(X.b,{as:M.a,fontSize:"15px",size:"xs",style:{backgroundColor:"white",position:"relative",mr:"0px",display:"".concat(u)},icon:Object(w.jsx)(ne.a,{}),onClick:function(){return d("flex")}}),Object(w.jsxs)(X.e,{mt:"-20px",style:{right:U(n,r,k._id)?0:-240,zIndex:"2",d:"flex",position:"absolute"},children:[Object(w.jsxs)(X.d,{color:"red",onClick:S,children:[Object(w.jsx)(ae.a,{color:"red",mr:"10px"}),"Recall Message"]}),Object(w.jsx)(X.c,{})]})]})]})]})]}):Object(w.jsxs)(i.a,{style:{backgroundColor:"".concat(n.sender._id===k._id?"#B9F5D0":"#ffffff"),margin:Y(t,n,r,k._id),marginTop:T(t,n,r,k._id)?3:10,borderRadius:"8px",padding:"5px 15px",minWidth:"140px",maxWidth:"80%",height:"70"},children:[Object(w.jsx)(R.a,{children:m(n.content)}),Object(w.jsxs)(i.a,{display:"flex",mt:3,justifyContent:"space-between",children:[Object(w.jsx)(R.a,{fontSize:"15px",color:"gray",paddingRight:"0px",display:"flex",children:v(n.createdAt)}),Object(w.jsxs)(X.a,{children:[Object(w.jsx)(X.b,{as:M.a,fontSize:"15px",size:"xs",style:{backgroundColor:"white",position:"relative",mr:"0px",display:"".concat(u)},icon:Object(w.jsx)(ne.a,{}),onClick:function(){return d("flex")}}),Object(w.jsxs)(X.e,{mt:"-20px",style:{right:U(n,r,k._id)?0:-240,zIndex:"2",d:"flex",position:"absolute"},children:[Object(w.jsxs)(X.d,{color:"red",onClick:S,children:[Object(w.jsx)(ae.a,{color:"red",mr:"10px"}),"Recall Message"]}),Object(w.jsx)(X.c,{})]})]})]})]})})})}),n.recallMessage&&Object(w.jsxs)(i.a,{style:{backgroundColor:"".concat(n.sender._id===k._id?"#B9F5D0":"#ffffff"),margin:Y(t,n,r,k._id),marginTop:T(t,n,r,k._id)?3:10,borderRadius:"8px",padding:"5px 15px",maxWidth:"80%",height:"70",display:"block"},children:[Object(w.jsx)(R.a,{color:"gray",children:"Message Recall"}),Object(w.jsx)(R.a,{fontSize:"15px",color:"gray",paddingRight:"0px",display:"flex",children:v(n.createdAt)})]})]},n._id)})},se=function(e){var t=e.messages,n=e.socket,r=Object(a.useRef)(null);return Object(a.useEffect)((function(){setTimeout((function(){var e;null===(e=r.current)||void 0===e||e.scrollIntoView({behavior:"auto"})}),500)}),[t]),Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(Q.a,{children:[t&&t.map((function(e,a){return Object(w.jsx)(re,{messages:t,m:e,i:a,socket:n},a)})),Object(w.jsx)("div",{ref:r})]})})},ce=n(268),ie=n(269),oe=n.n(ie),le=n(92),ue=n(899),de=n(891),je=n(874),be=n(873),pe=function(e){var t=e.user,n=e.handleFunction;e.admin;return Object(w.jsxs)(be.a,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",onClick:n,children:[t.name,Object(w.jsx)(je.a,{pl:1})]})},xe=function(e){var t=e.user,n=e.handleFunction;return Object(w.jsxs)(i.a,{onClick:n,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#ABEBC6",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[Object(w.jsx)($.a,{mr:2,size:"sm",cursor:"pointer",src:t.pic}),Object(w.jsx)(i.a,{children:Object(w.jsx)(R.a,{children:t.name})})]})},he=n(875),fe=function(e){var t=e.user,n=e.handleFunction,a=e.admin;return Object(w.jsxs)(i.a,{onClick:n,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[Object(w.jsx)($.a,{mr:2,size:"sm",cursor:"pointer",name:t.name,src:t.pic}),Object(w.jsxs)(i.a,{children:[Object(w.jsx)(R.a,{children:t.name}),Object(w.jsx)(R.a,{fontSize:"xs",children:a._id===t._id&&Object(w.jsx)("span",{children:" (Owner)"})})]}),Object(w.jsx)(he.a,{as:je.a})]})},Oe=function(e){var t=e.fetchMessages,n=e.fetchAgain,r=e.setFetchAgain,s=Object(a.useState)(),c=Object(p.a)(s,2),o=c[0],l=c[1],u=Object(a.useState)(""),d=Object(p.a)(u,2),f=d[0],g=d[1],m=Object(a.useState)([]),v=Object(p.a)(m,2),k=v[0],S=v[1],A=Object(a.useState)(!1),E=Object(p.a)(A,2),z=E[0],_=E[1],F=Object(a.useState)(!1),B=Object(p.a)(F,2),N=B[0],D=B[1],R=Object(C.a)(),M=I(),Y=M.selectedChat,L=M.setSelectedChat,W=M.user;console.log("info chat box",W);var T=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g(t),console.log("query :",f),t){e.next=5;break}return S(null),e.abrupt("return");case 5:return e.prev=5,_(!0),n={headers:{Authorization:"Bearer ".concat(W.token)}},e.next=10,y.a.get("/api/user?search=".concat(t),n);case 10:a=e.sent,r=a.data,console.log("SEARCH GROUP: ",r),_(!1),S(r),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),R({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"}),_(!1);case 21:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(b.a)(j.a.mark((function e(){var t,a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,D(!0),t={headers:{Authorization:"Bearer ".concat(W.token)}},e.next=7,y.a.put("/api/chat/rename",{chatId:Y._id,chatName:o},t);case 7:a=e.sent,s=a.data,console.log(s._id),L(s),r(!n),D(!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),R({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),D(!1);case 19:l("");case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(b.a)(j.a.mark((function e(t){var a,s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Y.users.find((function(e){return e._id===t._id}))){e.next=3;break}return R({title:"User Already in group!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:if(Y.groupAdmin._id===W._id){e.next=6;break}return R({title:"Only admins can add someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 6:return e.prev=6,_(!0),a={headers:{Authorization:"Bearer ".concat(W.token)}},e.next=11,y.a.put("/api/chat/groupadd",{chatId:Y._id,userId:t._id},a);case 11:s=e.sent,c=s.data,L(c),r(!n),_(!1),R({title:"Success",description:"Add memeber success",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),R({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),_(!1);case 23:l("");case 24:case"end":return e.stop()}}),e,null,[[6,19]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(b.a)(j.a.mark((function e(a){var s,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y.groupAdmin._id===W._id||a._id===W._id){e.next=3;break}return R({title:"Only admins can remove someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:return e.prev=3,_(!0),s={headers:{Authorization:"Bearer ".concat(W.token)}},e.next=8,y.a.put("/api/chat/groupremove",{chatId:Y._id,userId:a._id},s);case 8:c=e.sent,i=c.data,a._id===W._id?L():L(i),r(!n),t(),_(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),R({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),_(!1);case 20:l("");case 21:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(i.a,{background:"white",w:"113%",ml:"-25px",borderRadius:5,children:Object(w.jsx)(de.a,{defaultIndex:[0],allowMultiple:!0,children:Object(w.jsxs)(de.d,{children:[Object(w.jsx)("h2",{children:Object(w.jsxs)(de.b,{children:[Object(w.jsx)(i.a,{flex:"1",textAlign:"left",fontWeight:"bold",children:"Group Members"}),Object(w.jsx)(de.c,{})]})}),Object(w.jsxs)(de.e,{pb:4,children:[Object(w.jsxs)(h.a,{d:"flex",children:[Object(w.jsx)(O.a,{placeholder:"Chat Name",mb:3,value:o,onChange:function(e){return l(e.target.value)}}),Object(w.jsx)(x.a,{variant:"solid",colorScheme:"teal",ml:1,isLoading:N,onClick:H,children:"Update"})]}),Object(w.jsx)(h.a,{children:Object(w.jsx)(O.a,{placeholder:"Add User to group",mb:1,onChange:function(e){return T(e.target.value)}})}),z?Object(w.jsx)(P.a,{size:"lg"}):null===k||void 0===k?void 0:k.map((function(e){return Object(w.jsx)(xe,{user:e,handleFunction:function(){return U(e)}},e._id)})),Object(w.jsx)(i.a,{d:"flex",flexWrap:"wrap",pb:3,children:Y.users.map((function(e){return Object(w.jsx)(fe,{user:e,handleFunction:function(){return G(e)},admin:Y.groupAdmin},e._id)}))})]})]})})})},ge=function(e){e.fetchMessages,e.fetchAgain,e.setFetchAgain;var t=Object(a.useState)(),n=Object(p.a)(t,2),r=(n[0],n[1],Object(a.useState)("")),s=Object(p.a)(r,2),c=(s[0],s[1],Object(a.useState)([])),l=Object(p.a)(c,2),u=(l[0],l[1],Object(a.useState)(!1)),d=Object(p.a)(u,2),j=(d[0],d[1],Object(a.useState)(!1)),b=Object(p.a)(j,2),x=(b[0],b[1],Object(C.a)(),I()),h=x.selectedChat;x.setSelectedChat,x.user;return Object(w.jsx)(i.a,{background:"white",w:"113%",ml:"-25px",borderRadius:5,children:Object(w.jsx)(de.a,{defaultIndex:[0],allowMultiple:!0,children:Object(w.jsxs)(de.d,{children:[Object(w.jsx)("h2",{children:Object(w.jsxs)(de.b,{children:[Object(w.jsx)(i.a,{flex:"1",textAlign:"left",fontWeight:"bold",children:"File"}),Object(w.jsx)(de.c,{})]})}),Object(w.jsx)(de.e,{pb:4,children:Object(w.jsx)(i.a,{d:"flex",flexWrap:"wrap",pb:3,children:h.users.map((function(e){return Object(w.jsx)(o.a,{src:e.avartar})}))})})]})})})},me=n(270),ve=function(e){Object(me.a)(e);var t=Object(a.useState)(!1),n=Object(p.a)(t,2),r=(n[0],n[1]),s=Object(a.useState)([]),c=Object(p.a)(s,2),l=c[0],u=c[1],d=Object(C.a)(),x=I(),h=x.selectedChat,f=(x.setSelectedChat,x.user);Object(a.useEffect)((function(){O()}),[]);var O=function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(f.token)}},r(!0),e.next=7,y.a.get("/api/message/image/".concat(h._id),t);case 7:n=e.sent,a=n.data,u(a),r(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),d({title:"Error Occured!",description:e.t0,status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsx)(i.a,{background:"white",w:"113%",ml:"-25px",borderRadius:5,children:Object(w.jsx)(de.a,{defaultIndex:[0],allowMultiple:!0,children:Object(w.jsxs)(de.d,{children:[Object(w.jsx)("h2",{children:Object(w.jsxs)(de.b,{children:[Object(w.jsx)(i.a,{flex:"1",textAlign:"left",fontWeight:"bold",children:"Image/Video"}),Object(w.jsx)(de.c,{})]})}),Object(w.jsx)(de.e,{pb:4,children:Object(w.jsx)(i.a,{d:"flex",flexWrap:"wrap",pb:3,children:l.map((function(e){return Object(w.jsx)(o.a,{src:e.pic,width:"25%"})}))})})]})})})},ke=n(876),ye=n(280),Ce=n(108),we=n(271),Se=n.n(we),Ae=n(272),Ee={bucketName:"07-upload-image",region:"ap-southeast-1",accessKeyId:"AKIA24335YBYTDKA2YT3",secretAccessKey:"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"};Se.a.config.update({accessKeyId:"AKIA24335YBYTDKA2YT3",secretAccessKey:"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"});var ze,_e=function(e){var t=e.socketConnected,n=e.socket,r=e.selectedChat,s=e.user,c=Object(a.useState)(!1),o=Object(p.a)(c,2),l=o[0],u=o[1],d=Object(a.useState)(""),x=Object(p.a)(d,2),f=x[0],g=x[1],m=Object(a.useState)(!1),v=Object(p.a)(m,2),k=v[0],S=v[1],A=Object(C.a)(),E=Object(a.useState)(!1),z=Object(p.a)(E,2),_=z[0],F=z[1],B=I(),N=(B.input,B.setInput),D=function(){document.getElementById("file").value=""},R=function(){var e=Object(b.a)(j.a.mark((function e(t){var a,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key||!f){e.next=16;break}return n.emit("stop typing",r._id),N(f.trim()),e.prev=3,a={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(s.token)}},g(""),e.next=8,y.a.post("/api/message",{content:f.trim(),chatId:r},a);case 8:c=e.sent,i=c.data,n.emit("new message",i),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),A({title:"Error Occured!",description:e.t0,status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(b.a)(j.a.mark((function e(a){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g(a.target.value),t){e.next=3;break}return e.abrupt("return");case 3:k||(S(!0),n.emit("typing",r._id)),s=(new Date).getTime(),5e3,setTimeout((function(){(new Date).getTime()-s>=5e3&&k&&(n.emit("stop typing",r._id),S(!1))}),5e3);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(b.a)(j.a.mark((function e(t){var a,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(s.token)}},g(""),console.log("pic n\xe8 b\u1ea1n \u01a1ii@@@@@@: ",t),e.next=6,y.a.post("/api/message",{content:" image",chatId:r,pic:t},a);case 6:c=e.sent,i=c.data,n.emit("new message",i),document.getElementById("imagine").value="",e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),A({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(b.a)(j.a.mark((function e(t){var a,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F(!0),a=t.target.files,c=[],F(!0),0!==a.length){e.next=11;break}return A({title:"Please Select an File!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),D(),F(!1),e.abrupt("return");case 11:i=0;case 12:if(!(i<a.length)){e.next=22;break}if(!(a[i].size>1048576)){e.next=18;break}return A({title:"Size of File is too big",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),D(),F(!1),e.abrupt("return");case 18:c.push(a[i]);case 19:i++,e.next=12;break;case 22:c.forEach((function(e){Object(Ae.uploadFile)(e,Ee).then(function(){var e=Object(b.a)(j.a.mark((function e(t){var a,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("file: ",t),e.prev=1,a={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(s.token)}},e.next=5,y.a.post("/api/message/file",{fileName:t.key,chatId:r,fileURL:t.location},a);case 5:c=e.sent,i=c.data,n.emit("new message",i),F(!0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),A({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 14:F(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e),D(),F(!1)}))})),F(!1);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(ke.a,{templateColumns:"repeat(9, 1fr)",gap:3,children:[Object(w.jsxs)(ke.b,{w:"100%",pt:3,colSpan:1,d:"flex",children:[Object(w.jsxs)(i.a,{className:"emoji",children:[Object(w.jsx)(M.a,{className:"emojiHC",variant:"outline",colorScheme:"teal",fontSize:"20px",size:"md",icon:Object(w.jsx)(le.b,{}),onClick:function(){u(!l)}}),l&&Object(w.jsx)(ye.a,{className:"emojiPickerReactHC",emojiStyle:"google",onEmojiClick:function(e){var t=e.unified.split("-"),n=[];t.forEach((function(e){return n.push("0x"+e)}));var a=String.fromCodePoint.apply(String,n),r=f;g(r+=a)}})]}),Object(w.jsxs)(i.a,{className:"send",children:[Object(w.jsx)(M.a,{variant:"outline",colorScheme:"teal",size:"md",fontSize:"20px",icon:Object(w.jsx)(Ce.c,{}),onClick:function(){document.getElementById("imagine").click()}}),Object(w.jsx)("input",{type:"file",style:{display:"none"},id:"imagine",accept:"image/*",onChange:function(e){return function(e){if(F(!0),void 0!==e){if("image/jpeg"!==e.type&&"image/png"!==e.type)return A({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void F(!1);var t=new FormData;t.append("file",e),t.append("upload_preset","MongoChat04"),t.append("cloud_name","dfgkg5eej"),fetch("https://api.cloudinary.com/v1_1/dfgkg5eej/image/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){console.log(e.url.toString()),Y(e.url.toString()),console.log("DO DO DO "),F(!1)})).catch((function(e){console.log(e),F(!1)})),console.log("CHAY CHAY NHE!!!")}else A({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})}(e.target.files[0])}})]}),Object(w.jsxs)(i.a,{className:"micro",children:[Object(w.jsx)(M.a,{size:"md",variant:"outline",colorScheme:"teal",fontSize:"20px",icon:Object(w.jsx)(le.c,{}),onClick:function(){document.getElementById("file").click()}}),Object(w.jsx)("input",{type:"file",style:{display:"none"},id:"file",accept:"file_extension",multiple:!0,onChange:function(e){return L(e)}})]})]}),Object(w.jsxs)(ke.b,{w:"100%",colSpan:8,className:"input-container",pt:3,d:"flex",children:[Object(w.jsx)(h.a,{onKeyDown:R,isRequired:!0,children:Object(w.jsx)(O.a,{className:"col",bg:"#E0E0E0",placeholder:"Enter a message..",value:f,onChange:P,width:"98%",size:"md"})}),Object(w.jsx)(M.a,{position:"relative",variant:"outline",colorScheme:"teal",fontSize:"20px",size:"md",icon:Object(w.jsx)(le.a,{}),onClick:Y,isLoading:_,mb:1})]})]})})},Fe=function(e){var t=e.fetchAgain,n=e.setFetchAgain,r=e.socket,s=e.socketConnected,c={loop:!0,autoplay:!0,animationData:ce,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},l=Object(a.useState)([]),d=Object(p.a)(l,2),x=d[0],h=d[1],f=Object(a.useState)(!1),O=Object(p.a)(f,2),g=O[0],m=O[1],v=Object(a.useState)(),k=Object(p.a)(v,2),S=(k[0],k[1],Object(a.useState)(!1)),A=Object(p.a)(S,2),E=A[0],z=A[1],_=Object(C.a)(),F=Object(q.a)(),B=F.isOpen,N=F.onOpen,Y=F.onClose,L=Object(a.useState)(!1),W=Object(p.a)(L,2),T=W[0],U=W[1],Q=Object(a.useState)(!1),X=Object(p.a)(Q,2),$=X[0],ne=X[1],ae=Object(a.useState)(),re=Object(p.a)(ae,2),ie=re[0],de=re[1],je=Object(a.useState)(""),be=Object(p.a)(je,2),pe=be[0],xe=be[1],he=Object(a.useState)(!1),fe=Object(p.a)(he,2),me=fe[0],ke=fe[1],ye=Object(u.e)(),Ce=I(),we=Ce.selectedChat,Se=Ce.setSelectedChat,Ae=Ce.user,Ee=Ce.setuser,Fe=Ce.notification,Ie=Ce.setNotification,Be=(Ce.setSocket,Ce.chats),Ne=(Ce.setChats,JSON.parse(localStorage.getItem("userInfo"))),De=function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(we){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={headers:{Authorization:"Bearer ".concat(Ae.token)}},m(!0),e.next=7,y.a.get("/api/message/".concat(we._id),t);case 7:n=e.sent,a=n.data,h(a),m(!1),r.emit("join chat",we._id),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),_({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(!t.isGroupChat){e.next=6;break}return ne(!1),U(!1),e.abrupt("return");case 6:return e.prev=6,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(Ae.token)}},e.next=10,y.a.post("/api/friend/getStatusFriend",{user:t.users[0],friend:t.users[1]},n);case 10:a=e.sent,r=a.data,de(r),r.length>0?1==r[0].status?(console.log("da gui loi moi: ",r),U(!1),ne(!0),r[0].user==Ae._id?(xe("Request Sended"),ke(!0)):(xe("Accept"),ke(!1))):(console.log("da la banj roi",r),ne(!1),U(!1)):(console.log("chua gui gi ca"),U(!0),ne(!1)),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),_({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 19:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(Ae.token)}},e.next=6,y.a.post("/api/friend/sendRequest",{user:Ae._id,friend:K(Ae,t.users)._id},n);case 6:a=e.sent,1==a.data.status&&Re(t),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),_({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),Pe=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(!t.isGroupChat){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(Ae.token)}},e.next=8,y.a.post("/api/friend/makeFriend",{user:Ae._id,friend:K(Ae,t.users)._id},n);case 8:a=e.sent,(r=a.data)&&(console.log("dua da ta day:",r),Re(t)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),_({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){r&&(r.on("typing",(function(){return z(!0)})),r.on("stop typing",(function(){return z(!1)})))})),Object(a.useEffect)((function(){r&&r.on("recalled mess",(function(e){ze&&ze._id===e.chat._id&&(Ye(x,e),h(x))}))}),[x]);var Ye=function(e,t){e.forEach((function(e){e._id==t._id&&(e.recallMessage=1)}))};Object(a.useEffect)((function(){null==Ae&&(Ee(Ne),ye.go(0)),De(),Re(we),ze=we}),[we]),Object(a.useEffect)((function(){r?r.on("message recieved",(function(e){ze&&ze._id===e.chat._id&&void 0!=ze?(h([].concat(Object(D.a)(x),[e])),we.latestMessage=e):Fe.includes(e)||(Ie([].concat(Object(D.a)(Fe),[e])),console.log("thong bap",Fe),n(!t))})):Se(Be[Be.length-1])}),[x]);return Object(w.jsx)(w.Fragment,{children:we?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(i.a,{fontSize:{base:"28px",md:"30px"},pb:3,px:2,w:"100%",fontFamily:"Work sans",d:"flex",justifyContent:{base:"space-between"},alignItems:"center",children:[Object(w.jsx)(M.a,{d:{base:"flex",md:"none"},icon:Object(w.jsx)(J.a,{}),onClick:function(){return Se("")}}),!we.isGroupChat&&Object(w.jsx)(R.a,{fontSize:"25px",fontWeight:"bold",children:H(Ae,we.users)}),we.isGroupChat&&Object(w.jsx)(R.a,{fontSize:"25px",fontWeight:"bold",children:we.chatName.toString()}),Object(w.jsxs)(i.a,{w:"100px",d:"flex",justifyContent:{base:"space-around"},children:[Object(w.jsx)(M.a,{d:{base:"flex"},icon:Object(w.jsx)(V.a,{}),onClick:function(){window.open("http://localhost:3002/?id="+K(Ae,we.users)._id,"tri","scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=300,height=300"),r&&r.emit("callXXX",we)}}),Object(w.jsx)(M.a,{d:{base:"flex"},icon:Object(w.jsx)(Z.a,{}),onClick:N})]})]}),Object(w.jsxs)(i.a,{display:"flex",flexDir:"column",justifyContent:"flex-end",className:"singleChat",width:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:[g?Object(w.jsx)(P.a,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):Object(w.jsxs)(i.a,{className:"messages",children:[T&&Object(w.jsx)(i.a,{fontSize:{base:"100%",md:"100"},style:{position:"fixed",top:130,width:"65.5%",alignContent:"center"},children:Object(w.jsxs)(R.a,{display:"flex",background:"#16A085",w:"100%",borderRadius:5,fontSize:"20px",color:"white",justifyContent:"center",onClick:function(){Me(we),U(!1)},children:[Object(w.jsx)(le.e,{}),"Add Friend"]})}),$&&Object(w.jsx)(i.a,{fontSize:{base:"100%",md:"100"},style:{position:"fixed",width:"66%",alignContent:"center"},children:Object(w.jsxs)(R.a,{borderRadius:5,display:"flex",background:"#16A085",w:"100%",fontSize:"20px",color:"white",justifyContent:"center",onClick:function(){me?console.log("ko dc bam "):(console.log("da chap nhan"),Pe(we))},children:[!me&&Object(w.jsx)(le.d,{}),pe]})}),Object(w.jsx)(se,{messages:x,socket:r})]}),E?Object(w.jsx)("div",{children:Object(w.jsx)(oe.a,{options:c,width:70,style:{marginBottom:15,marginLeft:0}})}):Object(w.jsx)(w.Fragment,{}),Object(w.jsx)(_e,{socketConnected:s,socket:r,selectedChat:we,user:Ae})]}),Object(w.jsxs)(ue.a,{placement:"right",onClose:Y,isOpen:B,size:"sm",children:[Object(w.jsx)(ee.h,{}),Object(w.jsxs)(ue.b,{children:[Object(w.jsx)(ee.g,{borderBottomWidth:"1px",children:"Information"}),Object(w.jsxs)(ee.b,{background:"gray.100",children:[Object(w.jsx)(i.a,{background:"white",w:"113%",ml:"-25px",borderRadius:5,mb:"10px",children:x&&(we.isGroupChat?Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(i.a,{align:"center",justify:"center",pt:"15px",children:[Object(w.jsx)(o.a,{borderRadius:"full",boxSize:"50px",src:Ae.pic,alt:Ae.name}),Object(w.jsx)(R.a,{Text:!0,fontSize:"20px",fontWeight:"bold",children:we.chatName.toString()})]})}):Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(i.a,{align:"center",justify:"center",pt:"15px",children:[Object(w.jsx)(te,{user:K(Ae,we.users),statusFiend:ie,children:Object(w.jsx)(o.a,{borderRadius:"full",boxSize:"50px",src:G(Ae,we.users),alt:Ae.name})}),Object(w.jsx)(R.a,{fontSize:"20px",fontWeight:"bold",children:H(Ae,we.users)})]})}))}),Object(w.jsx)(i.a,{d:"contents",pb:2,children:x&&(we.isGroupChat?Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Oe,{w:"100%",fetchMessages:De,fetchAgain:t,setFetchAgain:n})}):Object(w.jsx)(w.Fragment,{}))}),Object(w.jsx)(i.a,{mt:"10px",children:Object(w.jsx)(ve,{})}),Object(w.jsx)(i.a,{mt:"10px",children:Object(w.jsx)(ge,{})})]})]})]})]}):Object(w.jsx)(i.a,{d:"flex",alignItems:"center",justifyContent:"center",h:"100%",children:Object(w.jsx)(R.a,{fontSize:"3xl",pb:3,fontFamily:"Work sans",children:"Click on user to start chatting..."})})})},Ie=function(e){var t=e.fetchAgain,n=e.setFetchAgain,a=e.socket,r=e.socketConnected,s=I().selectedChat;return Object(w.jsx)(i.a,{d:{base:s?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"white",w:{base:"100%",md:"68%"},borderRadius:"lg",borderWidth:"1px",children:Object(w.jsx)(Fe,{fetchAgain:t,setFetchAgain:n,socket:a,socketConnected:r})})},Be=n(879),Ne=n(889),De=function(){return Object(w.jsxs)(v.a,{children:[Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"}),Object(w.jsx)(Ne.a,{height:"45px"})]})},Re=function(e){var t=e.children,n=Object(q.a)(),r=n.isOpen,s=n.onOpen,c=n.onClose,o=Object(a.useState)(),l=Object(p.a)(o,2),u=l[0],d=l[1],f=Object(a.useState)([]),g=Object(p.a)(f,2),m=g[0],v=g[1],k=Object(a.useState)(""),S=Object(p.a)(k,2),A=(S[0],S[1]),E=Object(a.useState)([]),z=Object(p.a)(E,2),_=z[0],F=z[1],B=Object(a.useState)(!1),N=Object(p.a)(B,2),R=N[0],M=N[1],P=Object(C.a)(),Y=I(),L=Y.user,W=Y.chats,T=Y.setChats,H=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,M(!0),n={headers:{Authorization:"Bearer ".concat(L.token)}},e.next=8,y.a.get("/api/user?search=".concat(t),n);case 8:a=e.sent,r=a.data,M(!1),F(r),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),P({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u&&m){e.next=3;break}return P({title:"Please fill all the fields",status:"warning",duration:5e3,isClosable:!0,position:"top"}),e.abrupt("return");case 3:return e.prev=3,t={headers:{Authorization:"Bearer ".concat(L.token)}},e.next=7,y.a.post("/api/chat/group",{name:u,users:JSON.stringify(m.map((function(e){return e._id})))},t);case 7:n=e.sent,a=n.data,T([a].concat(Object(D.a)(W))),c(),P({title:"New Group Chat Created!",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),P({title:"Failed to Create the Chat!",description:e.t0.response.data,status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:v([]),F([]);case 19:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("span",{onClick:s,children:t}),Object(w.jsxs)(ee.a,{onClose:c,isOpen:r,isCentered:!0,children:[Object(w.jsx)(ee.h,{}),Object(w.jsxs)(ee.d,{children:[Object(w.jsx)(ee.g,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:"Create Group Chat"}),Object(w.jsx)(ee.c,{}),Object(w.jsxs)(ee.b,{d:"flex",flexDir:"column",alignItems:"center",children:[Object(w.jsx)(h.a,{children:Object(w.jsx)(O.a,{placeholder:"Chat Name",mb:3,onChange:function(e){return d(e.target.value)}})}),Object(w.jsx)(h.a,{children:Object(w.jsx)(O.a,{placeholder:"Add Users",mb:1,onChange:function(e){return H(e.target.value)}})}),Object(w.jsx)(i.a,{w:"100%",d:"flex",flexWrap:"wrap",children:m.map((function(e){return Object(w.jsx)(pe,{user:e,handleFunction:function(){return t=e,void v(m.filter((function(e){return e._id!==t._id})));var t}},e._id)}))}),R?Object(w.jsx)("div",{children:"Loading..."}):null===_||void 0===_?void 0:_.slice(0,4).map((function(e){return Object(w.jsx)(xe,{user:e,handleFunction:function(){return t=e,void(m.includes(t)?P({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):v([].concat(Object(D.a)(m),[t])));var t}},e._id)}))]}),Object(w.jsx)(ee.f,{children:Object(w.jsx)(x.a,{onClick:U,colorScheme:"blue",children:"Create Chat"})})]})]})]})},Me=function(e){var t=e.fetchAgain,n=e.socket,r=I(),s=(r.user,r.setuser),c=r.selectedChat,o=r.setSelectedChat,l=r.chats,d=r.setChats,h=JSON.parse(localStorage.getItem("userInfo")),f=Object(a.useState)([]),O=Object(p.a)(f,2),g=O[0],m=O[1],k=Object(C.a)(),S=Object(u.e)();Object(a.useEffect)((function(){s(h),null==h&&S.go(0),A()}),[t]);var A=function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={headers:{Authorization:"Bearer ".concat(h.token)}},e.next=4,y.a.get("/api/chat",t);case 4:n=e.sent,a=n.data,d(a),console.log("tin nhan",a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0),k({title:"Error Occured!",description:"Failed to Load the chats (MY CHAT)",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),E=function(e,t){e.forEach((function(e){e._id==t.chat._id&&(e.latestMessage=t,m(t))}))};Object(a.useEffect)((function(){n&&n.on("message recieved",(function(e){E(l,e),d((function(e){return l}))}))}),[c||l||g]),Object(a.useEffect)((function(){n&&n.on("recalled mess",(function(e){c&&c._id===e.chat._id?E(l,e):console.log("my chat ko dung")}))}),[c||l||g]);var z=function(e){return!(!c||c._id!==e._id)};return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(i.a,{d:{base:c?"none":"flex",md:"flex"},flexDir:"column",alignItems:"center",p:3,bg:"white",w:{base:"100%",md:"31%"},borderRadius:"lg",borderWidth:"1px",children:[Object(w.jsxs)(i.a,{pb:3,px:3,fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",d:"flex",w:"100%",justifyContent:"space-between",alignItems:"center",children:["My Chats",Object(w.jsx)(Re,{children:Object(w.jsx)(x.a,{d:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:Object(w.jsx)(Be.a,{}),children:"New Group Chat"})})]}),Object(w.jsx)(i.a,{d:"flex",flexDir:"column",p:3,bg:"#F8F8F8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:l?Object(w.jsx)(v.a,{overflowY:"scroll",children:l.map((function(e){return Object(w.jsxs)(i.a,{onClick:function(){return o(e)},cursor:"pointer",bg:z(e)?"#ABEBC6":"white",color:z(e)?"white":"black",px:3,py:2,display:"flex",borderRadius:"lg",children:[Object(w.jsx)($.a,{mt:3,mr:2,size:"sm",cursor:"pointer",src:1==e.isGroupChat?e.pic:G(h,e.users)}),Object(w.jsxs)(i.a,{width:"100%",children:[Object(w.jsxs)(i.a,{justifyContent:"space-between",d:"flex",children:[Object(w.jsx)(R.a,{fontSize:"lg",fontWeight:"400",color:"black",d:"flex",alignContent:"end",children:e.isGroupChat?e.chatName:H(h,e.users)}),e.latestMessage&&Object(w.jsx)(R.a,{color:"gray.500",children:(n=e.latestMessage.createdAt,new Date(n).toLocaleString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}))})]}),e.latestMessage&&Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(R.a,{fontSize:"md",color:"gray.500",children:[e.latestMessage.sender.name===h.name?"You":e.latestMessage.sender.name,":"," ",e.latestMessage.content.length>50?e.latestMessage.content.substring(0,51)+"...":(t=e.latestMessage,t.recallMessage?"Message Recall":t.content)]})})]})]},e._id);var t,n}))}):Object(w.jsx)(De,{})})]})})},Pe=n(273),Ye=n(274),Le=n(275),We=n(890),Te=n(880),He=n(881),Ue=n(882),Ge=n(150),Ke=n.n(Ge),qe=function(e){var t=e.chat,n=e.handleFunction;return Object(w.jsxs)(i.a,{onClick:n,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[Object(w.jsx)($.a,{mr:2,size:"sm",cursor:"pointer",src:t.pic}),Object(w.jsx)(i.a,{children:Object(w.jsx)(R.a,{children:t.chatName})})]})},Je=function(e){var t=e.user,n=e.children,r=Object(q.a)(),s=r.isOpen,c=r.onOpen,i=r.onClose,o=Object(a.useState)(t._id),l=Object(p.a)(o,2),d=l[0],g=(l[1],Object(a.useState)(t.name)),m=Object(p.a)(g,2),k=m[0],S=m[1],z=Object(a.useState)(t.pic),_=Object(p.a)(z,2),F=_[0],I=_[1],B=Object(a.useState)(t.birth),N=Object(p.a)(B,2),D=N[0],R=N[1],P=Object(a.useState)(t.sex.toString()),Y=Object(p.a)(P,2),L=Y[0],W=Y[1],T=Object(C.a)(),H=Object(a.useState)(!1),U=Object(p.a)(H,2),G=U[0],K=U[1],J=Object(a.useState)(t.token),V=Object(p.a)(J,2),Q=V[0],X=(V[1],Object(u.e)()),te=function(){document.getElementById("avartar").value=""},ne=function(){var e=Object(b.a)(j.a.mark((function e(){var n,a,r,s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K(!0),n=(new Date).getFullYear(),a=new Date(D).getFullYear(),!(k.length<=0)){e.next=7;break}return T({title:"Please Enter your name ",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),K(!1),e.abrupt("return");case 7:if(!(n-a<0)){e.next=11;break}return T({title:"Age > 0",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),K(!1),e.abrupt("return");case 11:return e.prev=11,r={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t.token)}},e.next=15,y.a.post("/api/user/updateProfile",{userId:d,name:k,sex:L,birth:D,pic:F},r);case 15:s=e.sent,c=s.data,localStorage.removeItem("userInfo"),c.token=Q,localStorage.setItem("userInfo",JSON.stringify(c)),setTimeout((function(){X.push("/")}),1e3),T({title:"Update Success",status:"success",duration:7e3,isClosable:!0,position:"bottom"}),K(!1),i(),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(11),T({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),K(!1);case 30:case"end":return e.stop()}}),e,null,[[11,26]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[n?Object(w.jsx)("span",{onClick:c,children:n}):Object(w.jsx)(M.a,{d:{base:"flex"},icon:Object(w.jsx)(Z.a,{}),onClick:c}),Object(w.jsxs)(ee.a,{size:"lg",onClose:function(){i(),I(t.pic),S(t.name),R(t.birth),te()},isOpen:s,children:[Object(w.jsx)(ee.h,{}),Object(w.jsxs)(ee.d,{h:"410px",children:[Object(w.jsx)(ee.g,{fontSize:"40px",fontFamily:"Work sans",d:"flex",justifyContent:"center"}),Object(w.jsx)(ee.c,{}),Object(w.jsxs)(ee.b,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:[Object(w.jsx)($.a,{borderRadius:"full",boxSize:"100px",src:F,onClick:function(){document.getElementById("avartar").click()}}),Object(w.jsx)("input",{type:"file",style:{display:"none"},id:"avartar",accept:"image/*",onChange:function(e){return function(e){if(console.log("tam hinh",e),K(!0),void 0===e)return T({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void K(!1);if("image/jpeg"!==e.type&&"image/png"!==e.type)return T({title:"Please Select an Image!",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),te(),void K(!1);var t=new FormData;t.append("file",e),t.append("upload_preset","MongoChat04"),t.append("cloud_name","dfgkg5eej"),fetch("https://api.cloudinary.com/v1_1/dfgkg5eej/image/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){I(e.url.toString()),K(!1),te()})).catch((function(e){console.log(e),K(!1)})),console.log("CHAY CHAY NHE!!!")}(e.target.files[0])}}),Object(w.jsxs)(h.a,{id:"first-name",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Name"}),Object(w.jsx)(O.a,{placeholder:"Enter Your Name",value:k,onChange:function(e){return S(e.target.value)}})]}),Object(w.jsxs)(h.a,{id:"birthday",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Birthday"}),Object(w.jsx)(O.a,{type:"date",value:function(){var e=new Date(D),t=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():e.getDate();return e.getFullYear()+"-"+t+"-"+n}(),onChange:function(e){R(e.target.value)}})]}),Object(w.jsxs)(h.a,{id:"sex",isRequired:!0,children:[Object(w.jsx)(f.a,{children:"Sex"}),Object(w.jsx)(A.a,{value:L,onChange:W,children:Object(w.jsxs)(v.a,{direction:"row",children:[Object(w.jsx)(E.a,{colorScheme:"green",value:"1",children:"Male"}),Object(w.jsx)(E.a,{colorScheme:"green",value:"2",children:"Female"}),Object(w.jsx)(E.a,{colorScheme:"green",value:"3",children:"Other"})]})})]})]}),Object(w.jsxs)(ee.f,{children:[Object(w.jsx)(x.a,{isLoading:G,onClick:function(){i(),I(t.pic),S(t.name),R(t.birth),te()},mr:3,children:"Close"}),Object(w.jsx)(x.a,{isLoading:G,onClick:ne,colorScheme:"green",children:"Update"})]})]})]})]})};var Ve,Ze=function(){var e=Object(a.useState)(""),t=Object(p.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)([]),c=Object(p.a)(s,2),o=c[0],l=c[1],d=Object(a.useState)([]),h=Object(p.a)(d,2),f=h[0],g=h[1],m=Object(a.useState)(!1),v=Object(p.a)(m,2),k=v[0],S=v[1],A=Object(a.useState)(!1),E=Object(p.a)(A,2),z=E[0],_=E[1],F=I(),B=F.setSelectedChat,N=F.setuser,Y=F.notification,L=F.setNotification,W=F.chats,T=F.selectedFriend,U=F.setselectedFriend,G=F.setChats,K=F.input;Object(a.useEffect)((function(){}),[K]);var J=JSON.parse(localStorage.getItem("userInfo")),V=Object(u.e)();Object(a.useEffect)((function(){null==J&&V.go(0)}),[V]);var Z=Object(C.a)(),Q=Object(q.a)(),ne=Q.isOpen,ae=Q.onOpen,re=Q.onClose,se=function(){var e=Object(b.a)(j.a.mark((function e(){var t,a,r,s,c,i,o,u,d;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l([]),n){e.next=4;break}return Z({title:"Please Enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"}),e.abrupt("return");case 4:return e.prev=4,S(!0),t={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(J.token)}},e.next=9,y.a.get("/api/friend/findUserFriend?search=".concat(n,"&userId=").concat(J._id),t);case 9:a=e.sent,(r=a.data).length>0&&(l(r),S(!1)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),Z({title:"Error Occured!",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:return e.prev=17,S(!0),s={headers:{Authorization:"Bearer ".concat(J.token)}},e.next=22,y.a.get("/api/user?search=".concat(n),s);case 22:c=e.sent,(i=c.data).length>0&&(l(i),console.log("in ra ne")),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(17),Z({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 30:return e.prev=30,S(!0),o={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(J.token)}},e.next=35,y.a.get("/api/chat/searchGroupChat?id=".concat(J._id,"&chatName=").concat(n),o);case 35:u=e.sent,d=u.data,S(!1),g(d),console.log("toi"),e.next=45;break;case 42:e.prev=42,e.t2=e.catch(30),Z({title:"Error Occured!",description:e.t2,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 45:case"end":return e.stop()}}),e,null,[[4,14],[17,27],[30,42]])})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_(!0),n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(J.token)}},e.next=5,y.a.post("/api/chat",{userId:t},n);case 5:a=e.sent,r=a.data,W.find((function(e){return e._id===r._id}))||G([r].concat(Object(D.a)(W))),B(r),_(!1),re(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),Z({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(i.a,{d:"flex",justifyContent:"space-between",alignItems:"center",bg:"#117A65",w:"100%",p:"5px 10px 5px 10px",children:[Object(w.jsx)(We.a,{label:"Search Users to chat",hasArrow:!0,placement:"bottom-end",children:Object(w.jsx)(x.a,{_hover:{background:"gray.400"},leftIcon:Object(w.jsx)(Te.a,{color:"white"}),variant:"ghost",onClick:ae,children:Object(w.jsx)(R.a,{d:{base:"none",md:"flex"},color:"white",px:4,children:"Search User"})})}),Object(w.jsxs)(i.a,{w:"450px",d:"flex",justifyContent:"space-between",children:[Object(w.jsx)(M.a,{variant:"ghost",fontSize:"35px",size:"lg",_hover:{background:"#16A085"},onClick:function(){V.push("/chats"),U(!1)},style:{background:"".concat(!1===T?"#16A085":"117A65")},icon:Object(w.jsx)(Ce.b,{color:"white"})}),Object(w.jsx)(M.a,{variant:"ghost",fontSize:"35px",size:"lg",_hover:{background:"#16A085"},onClick:function(){V.push("/friend"),U(!0)},style:{background:"".concat(!0===T?"#16A085":"117A65")},icon:Object(w.jsx)(Pe.a,{color:"white"})}),Object(w.jsx)(M.a,{variant:"ghost",fontSize:"35px",size:"lg",_hover:{background:"gray.400"},icon:Object(w.jsx)(Ye.a,{color:"white"})}),Object(w.jsx)(M.a,{variant:"ghost",fontSize:"35px",size:"lg",_hover:{background:"gray.400"},icon:Object(w.jsx)(Le.a,{color:"white"})})]}),Object(w.jsxs)("div",{children:[Object(w.jsxs)(X.a,{children:[Object(w.jsxs)(X.b,{p:1,children:[Object(w.jsx)(Ke.a,{count:Y.length,effect:Ge.Effect.SCALE}),Object(w.jsx)(He.a,{fontSize:"2xl",m:1,color:"white"})]}),Object(w.jsxs)(X.e,{pl:2,children:[!Y.length&&"No New Messages",Y.map((function(e){return Object(w.jsx)(X.d,{onClick:function(){B(e.chat),L(Y.filter((function(t){return t!==e})))},children:e.chat.isGroupChat?"New Message in ".concat(e.chat.chatName):"New Message from ".concat(H(J,e.chat.users))},e._id)}))]})]}),Object(w.jsxs)(X.a,{children:[Object(w.jsx)(X.b,{as:x.a,bg:"white",rightIcon:Object(w.jsx)(Ue.a,{}),children:Object(w.jsx)($.a,{size:"sm",cursor:"pointer",name:J.name,src:J.pic})}),Object(w.jsxs)(X.e,{style:{right:-80,top:-9,zIndex:1,position:"absolute"},children:[Object(w.jsxs)(te,{user:J,children:[Object(w.jsx)(X.d,{children:"My Profile"})," "]}),Object(w.jsx)(Je,{user:J,children:Object(w.jsx)(X.d,{children:"Update my profile"})}),Object(w.jsx)(X.c,{}),Object(w.jsx)(X.d,{onClick:function(){N(null),localStorage.removeItem("userInfo"),B(null),V.push("/")},children:"Logout"})]})]})]})]}),Object(w.jsxs)(ue.a,{placement:"left",onClose:re,isOpen:ne,children:[Object(w.jsx)(ee.h,{}),Object(w.jsxs)(ue.b,{children:[Object(w.jsx)(ee.g,{borderBottomWidth:"1px",children:"Search Users"}),Object(w.jsxs)(ee.b,{children:[Object(w.jsxs)(i.a,{d:"flex",pb:2,children:[Object(w.jsx)(O.a,{placeholder:"Search by name or email",mr:2,value:n,onChange:function(e){return r(e.target.value)}}),Object(w.jsx)(x.a,{onClick:se,children:"Go"})]}),k?Object(w.jsx)(De,{}):Object(w.jsxs)(de.a,{defaultIndex:[0],allowMultiple:!0,children:[o.length>0&&Object(w.jsxs)(de.d,{children:[Object(w.jsxs)(de.b,{children:[Object(w.jsxs)(i.a,{flex:"1",textAlign:"left",fontWeight:"bold",children:["Individual (",o.length,")"]}),Object(w.jsx)(de.c,{})]}),Object(w.jsx)(de.e,{pb:4,children:null===o||void 0===o?void 0:o.map((function(e){return Object(w.jsx)(xe,{user:e,handleFunction:function(){return ce(e._id)}},e._id)}))})]}),f.length>0&&Object(w.jsxs)(de.d,{children:[Object(w.jsx)("h2",{children:Object(w.jsxs)(de.b,{children:[Object(w.jsxs)(i.a,{flex:"1",textAlign:"left",fontWeight:"bold",children:["Group (",f.length,")"]}),Object(w.jsx)(de.c,{})]})}),Object(w.jsx)(de.e,{pb:4,children:null===f||void 0===f?void 0:f.map((function(e,t){return Object(w.jsx)(qe,{chat:e,handleFunction:function(){return ce(e._id)}},e._id)}))})]})]}),z&&Object(w.jsx)(P.a,{ml:"auto",d:"flex"})]})]})]})]})},Qe=n(276),Xe=n.n(Qe),$e=function(e){var t=e.isOpen,n=e.onOpen,a=e.onClose,r=e.otherUser;e.socket,Object(C.a)();return Object(w.jsx)(w.Fragment,{children:r&&Object(w.jsxs)(ee.a,{size:"xl",onOpen:n,onClose:a,isOpen:t,children:[Object(w.jsx)(ee.h,{}),Object(w.jsxs)(ee.d,{children:[Object(w.jsxs)(ee.g,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:[Object(w.jsx)($.a,{mr:2,size:"md",cursor:"pointer",name:r.name,src:r.pic}),Object(w.jsx)(R.a,{fontSize:"15px",children:r.name})]}),Object(w.jsx)(ee.c,{}),Object(w.jsxs)(ee.b,{d:"flex",flexDir:"column",alignItems:"center",children:[Object(w.jsx)(M.a,{onClick:function(){window.open("http://localhost:3002/?id="+r._id,"tri","scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=300,height=300")},icon:Object(w.jsx)(Ce.a,{})}),Object(w.jsx)(M.a,{})]}),Object(w.jsx)(ee.f,{})]})]})})},et=function(){var e=JSON.parse(localStorage.getItem("userInfo")),t=Object(a.useState)(!1),n=Object(p.a)(t,2),r=n[0],s=n[1],c=Object(u.e)(),o=Object(a.useState)(!1),l=Object(p.a)(o,2),d=l[0],j=l[1],b=Object(q.a)(),x=b.isOpen,h=b.onOpen,f=b.onClose,O=(Object(C.a)(),Object(a.useState)()),g=Object(p.a)(O,2),m=g[0],v=g[1];return Object(a.useEffect)((function(){null==e&&c.go(0)}),[c]),Object(a.useEffect)((function(){(Ve=Xe()("http://localhost:5000")).emit("setup",e),Ve.on("connected",(function(){return j(!0)})),console.log("SINGLE CHAT:",Ve)}),[]),Object(a.useEffect)((function(){Ve&&Ve.on("callYYY",(function(t){console.log("alo call"),e._id!=K(e,t.users)._id&&(v(K(e,t.users)),console.log("nguoi kia",m),h())}))})),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("div",{style:{width:"100%"},children:[e&&Object(w.jsx)(Ze,{}),Object(w.jsxs)(i.a,{d:"flex",justifyContent:"space-between",w:"100%",h:"91.5vh",p:"10px",children:[e&&Object(w.jsx)(Me,{fetchAgain:r,socket:Ve}),e&&Object(w.jsx)(Ie,{fetchAgain:r,setFetchAgain:s,socket:Ve,socketConnected:d})]})]}),Object(w.jsx)($e,{onOpen:h,onClose:f,isOpen:x,otherUser:m,socket:Ve})]})},tt=n(883),nt=function(){var e=I(),t=e.user,n=e.setSelectedChat,r=e.chats,s=e.setChats,c=e.setselectedFriend,o=Object(C.a)(),l=Object(a.useState)([]),d=Object(p.a)(l,2),h=d[0],f=d[1],O=Object(a.useState)(!1),g=Object(p.a)(O,2),m=(g[0],g[1]),k=Object(u.e)();Object(a.useEffect)((function(){S()}),[]);var S=function(){var e=Object(b.a)(j.a.mark((function e(){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t.token)}},e.next=4,y.a.post("/api/friend/getListFriend",{userId:t._id},n);case 4:a=e.sent,r=a.data,console.log("friends",r),f(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),o({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(b.a)(j.a.mark((function e(a){var i,l,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m(!0),i={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t.token)}},e.next=5,y.a.post("/api/chat",{userId:a},i);case 5:l=e.sent,u=l.data,r.find((function(e){return e._id===u._id}))||s([u].concat(Object(D.a)(r))),n(u),c(!1),m(!1),k.push("/chats"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),o({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"});case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(i.a,{d:"flex",flexDir:"column",alignItems:"left",pt:3,bg:"white",w:{base:"100%",md:"25%"},borderRadius:"lg",borderWidth:"1px",children:Object(w.jsx)(i.a,{fontSize:{base:"28px",md:"50px"},w:"100%",bg:"white",alignItems:"center",children:Object(w.jsxs)(Q.a,{bg:"white",children:[Object(w.jsxs)(i.a,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",d:"block",w:"100%",justifyContent:"space-between",alignItems:"initial",children:[Object(w.jsx)(x.a,{d:"flex",w:"100%",leftIcon:Object(w.jsx)(Be.a,{}),bg:"white",fontSize:"15px",justifyContent:"initial",children:"Add New Friend By Email"}),Object(w.jsx)(x.a,{d:"flex",w:"100%",leftIcon:Object(w.jsx)(Be.a,{}),bg:"white",justifyContent:"initial",fontSize:"17px",children:"List Friends"}),Object(w.jsx)(x.a,{d:"flex",w:"100%",leftIcon:Object(w.jsx)(Be.a,{}),bg:"white",justifyContent:"initial",fontSize:"17px",children:"List Groups"})]}),Object(w.jsx)(tt.a,{orientation:"horizontal",bg:"gray.200",h:"2px"}),Object(w.jsx)(i.a,{d:"flex",flexDir:"column",p:3,bg:"white",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:Object(w.jsx)(de.a,{defaultIndex:[0],allowMultiple:!0,children:Object(w.jsxs)(de.d,{children:[Object(w.jsxs)(de.b,{children:[Object(w.jsx)(i.a,{flex:"1",textAlign:"left",children:"My Friends"}),Object(w.jsx)(de.c,{})]}),Object(w.jsx)(de.e,{pb:4,children:h?Object(w.jsx)(v.a,{overflowY:"scroll",children:h.map((function(e){return Object(w.jsx)(i.a,{children:Object(w.jsx)(R.a,{fontSize:"20px",children:Object(w.jsx)(xe,{user:e,handleFunction:function(){return A(e._id)}},e._id)})},e._id)}))}):Object(w.jsx)(De,{})})]})})})]})})})})},at=function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Q.a,{})})},rt=function(e){e.fetchAgain;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(i.a,{d:{base:"flex",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"white",w:{base:"100%",md:"74%"},borderRadius:"lg",borderWidth:"1px",children:Object(w.jsx)(at,{})})})},st=function(){var e=JSON.parse(localStorage.getItem("userInfo")),t=Object(a.useState)(!1),n=Object(p.a)(t,2),r=n[0],s=(n[1],Object(u.e)());return Object(a.useEffect)((function(){null==e&&s.go(0)}),[s]),Object(w.jsxs)("div",{style:{width:"100%"},children:[e&&Object(w.jsx)(Ze,{}),Object(w.jsxs)(i.a,{d:"flex",justifyContent:"space-between",w:"100%",h:"91.5vh",p:"10px",children:[e&&Object(w.jsx)(nt,{}),Object(w.jsx)(rt,{fetchAgain:r})]})]})};var ct=function(){return Object(w.jsx)(B,{children:Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)(u.a,{path:"/",component:N,exact:!0}),Object(w.jsx)(u.a,{path:"/provider",component:B}),Object(w.jsx)(u.a,{path:"/chats",component:et}),Object(w.jsx)(u.a,{path:"/friend",component:st})]})})},it=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,901)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),s(e),c(e)}))},ot=n(887),lt=n(44);s.a.render(Object(w.jsx)(ot.a,{children:Object(w.jsx)(lt.a,{children:Object(w.jsx)(B,{children:Object(w.jsx)(ct,{})})})}),document.getElementById("root")),it()}},[[837,1,2]]]);
//# sourceMappingURL=main.ac57f58d.chunk.js.map