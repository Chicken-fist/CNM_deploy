{"version":3,"sources":["components/Authentication/Login.js","components/Authentication/Signup.js","img/message-logo-removebg-preview.png","Context/ChatProvider.js","Pages/Homepage.js","config/ChatLogics.js","components/miscellaneous/ProfileModal.js","components/miscellaneous/BoxMessage.js","img/folder.png","components/ScrollableChat.js","components/userAvatar/UserBadgeItem.js","components/userAvatar/UserListItem.js","components/userAvatar/UserListItemGroup.js","components/miscellaneous/BoxInformationGroupMember.js","components/miscellaneous/BoxInfoFile.js","components/miscellaneous/BoxInforImage.js","components/ChatComponent/InputComponent.js","components/SingleChat.js","components/Chatbox.js","components/ChatLoading.js","components/miscellaneous/GroupChatModal.js","components/MyChats.js","components/userAvatar/GroupListItem.js","components/miscellaneous/UpdateProfileModal.js","components/miscellaneous/SideDrawer.js","Pages/Chatpage.js","components/Call/CallModal.js","components/FriendComponent/MyFriend.js","components/FriendComponent/ScrollableFriend.js","components/FriendComponent/FriendTable.js","Pages/ChatFriend.js","App.js","reportWebVitals.js","index.js"],"names":["Login","useState","show","email","setEmail","password","setPassword","loading","setLoading","toast","useToast","history","useHistory","submitHandler","a","title","status","duration","isClosable","position","config","headers","axios","post","data","localStorage","setItem","JSON","stringify","push","description","response","message","spacing","id","isRequired","type","placeholder","onChange","e","target","value","size","width","colorScheme","style","marginTop","onClick","isLoading","Signup","setShow","handleClick","name","setName","confirmpassword","setConfirmpassword","pic","setPic","phone","setPhone","birth","setBirth","sex","setsex","regexName","regexPhone","DatePresent","Date","getFullYear","birhtUser","length","test","console","log","direction","h","p","required","pattern","accept","pics","undefined","FormData","append","fetch","method","body","then","res","json","url","toString","catch","err","postDetails","files","ChatContext","createContext","ChatState","useContext","ChatProvider","children","selectedChat","setSelectedChat","parse","getItem","user","setuser","notification","setNotification","chats","setChats","socket","setSocket","input","setInput","selectedFriend","setselectedFriend","useEffect","Provider","Homepage","maxW","centerContent","d","justifyContent","bg","w","m","borderRadius","borderWidth","mt","src","logo","isFitted","variant","mb","isSameSenderMargin","messages","i","userId","sender","_id","isSameSender","isLastMessage","isSameUser","getSender","loggedUser","users","showMenu","getSenderPic","getUserOther","ProfileModal","statusFiend","useDisclosure","isOpen","onOpen","onClose","unfrinedFriend","base","icon","InfoOutline","isCentered","fontSize","fontFamily","flexDir","alignItems","boxSize","alt","md","mr","BoxMessage","isShown","setIsShown","mess","setmess","handleContent","content","handleTimeSend","timeSend","toLocaleString","hour12","hour","minute","handleMessageClick","event","preventDefault","Authorization","token","emit","display","cursor","recallMessage","onMouseEnter","onMouseLeave","margin","minWidth","maxWidth","minHeight","maxHeight","handlePic","as","IconButton","zIndex","backgroundColor","bottom","right","DragHandle","color","Repeat","file","padding","height","href","fontWeight","paddingRight","createdAt","ScrollableChat","bottomRef","useRef","setTimeout","current","scrollIntoView","behavior","map","ref","UserBadgeItem","handleFunction","admin","px","py","Close","pl","UserListItem","_hover","background","UserListItemGroup","CloseIcon","BoxInformationChat","fetchMessages","fetchAgain","setFetchAgain","groupChatName","setGroupChatName","search","setSearch","searchResult","setSearchResult","renameloading","setRenameLoading","handleSearch","query","get","handleRename","put","chatId","chatName","handleAddUser","user1","find","u","groupAdmin","handleRemove","ml","defaultIndex","allowMultiple","flex","textAlign","pb","flexWrap","BoxInfoFile","avartar","BoxInfoIamge","setPics","fetchImage","bucketName","region","accessKeyId","secretAccessKey","AWS","update","selectedChatCompare","InputComponent","socketConnected","showEmojiPicker","setShowEmojiPicker","newMessage","setNewMessage","typing","setTyping","deleteFileInInput","document","getElementById","sendMessage","key","trim","typingHandler","lastTypingTime","getTime","pic1","submitHandlerFile","objectFile","checkedFiles","forEach","file1","uploadFile","filee","fileName","fileURL","location","error","templateColumns","gap","pt","colSpan","className","emojiStyle","onEmojiClick","sym","unified","split","codesArray","el","emoji","String","fromCodePoint","click","multiple","onKeyDown","SingleChat","defaultOptions","loop","autoplay","animationData","rendererSettings","preserveAspectRatio","setMessages","istyping","setIsTyping","showMakeFriend","setshowMakeFriend","showAcceptFriend","setshowAcceptFriend","setStatusFiend","contentSendRequest","setcontentSendRequest","disable","setdisable","checkStatusFriend","isGroupChat","friend","addFriend","makeFriend","on","chat","xuLyRecall","messa","newMessageRecieved","latestMessage","includes","ArrowBack","Phone","window","open","overflowY","alignSelf","top","alignContent","options","marginBottom","marginLeft","placement","borderBottomWidth","align","justify","Text","Chatbox","ChatLoading","GroupChatModal","selectedUsers","setSelectedUsers","handleSubmit","delUser","filter","sel","slice","userToAdd","MyChats","chat1","setchat1","fetchChats","xuLyChats","chatsX","prevState","handleBackgroup","lg","rightIcon","Add","substring","lastestMessage","GroupListItem","UpdateProfileModal","deleteImageInInput","updateProfile","removeItem","x","month","getMonth","date","getDate","SideDrawer","searchResultGroup","setsearchResultGroup","loadingChat","setLoadingChat","accessChat","c","label","hasArrow","leftIcon","Search2","count","effect","Effect","SCALE","Bell","notif","n","Button","ChevronDown","CallModal","otherUser","Chatpage","setSocketConnected","setotherUser","go","io","MyFriends","friends","setFriens","fetchFriend","orientation","ScrollableFriend","FriendTable","Friendpage","MyFriend","App","path","component","exact","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render"],"mappings":"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","file":"static/js/main.da981c81.chunk.js","sourcesContent":["import { Button } from \"@chakra-ui/button\";\r\nimport { FormControl, FormLabel } from \"@chakra-ui/form-control\";\r\nimport { Input, InputGroup, InputRightElement } from \"@chakra-ui/input\";\r\nimport { VStack } from \"@chakra-ui/layout\";\r\nimport { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useToast } from \"@chakra-ui/react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\n// var emailExport = '';\r\n// var passwordExport = '';\r\n\r\nconst Login = () => {\r\n  const [show, setShow] = useState(false);\r\n  // const handleClick = () => setShow(!show);\r\n  const [email, setEmail] = useState();\r\n  const [password, setPassword] = useState();\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const toast = useToast();\r\n  const history = useHistory();\r\n\r\n  const submitHandler = async () => {\r\n    setLoading(true);\r\n    if (!email || !password) {\r\n      toast({\r\n        title: \"Please Fill all the Feilds\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n        },\r\n      };\r\n      const { data } = await axios.post(\r\n        \"/api/user/login\",\r\n        { email, password },\r\n        config\r\n      );\r\n      toast({\r\n        title: \"Login Successful\",\r\n        status: \"success\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      localStorage.setItem(\"userInfo\", JSON.stringify(data));\r\n\r\n      setLoading(false);\r\n      history.push(\"/provider\");\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error.response.data.message,\r\n        // description: \"LYour pass\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <VStack spacing=\"10px\">\r\n      <FormControl id=\"email\" isRequired>\r\n        <FormLabel>Email or phone </FormLabel>\r\n        <Input\r\n          // value={email}\r\n          type=\"email\"\r\n          placeholder=\"Enter Your Email or Phone\"\r\n          onChange={(e) => setEmail(e.target.value)}\r\n        />\r\n      </FormControl>\r\n      <FormControl id=\"password\" isRequired>\r\n        <FormLabel>Password</FormLabel>\r\n        <InputGroup size=\"md\">\r\n          <Input\r\n            // value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            type={show ? \"text\" : \"password\"}\r\n            placeholder=\"Enter password\"\r\n          />\r\n          <InputRightElement width=\"4.5rem\">\r\n            {/* <Button h=\"1.75rem\" size=\"sm\" onClick={handleClick}>\r\n              {show ? \"Hide\" : \"Show\"}\r\n            </Button> */}\r\n          </InputRightElement>\r\n        </InputGroup>\r\n      </FormControl>\r\n      <Button\r\n        colorScheme=\"green\"\r\n        width=\"100%\"\r\n        style={{ marginTop: 15 }}\r\n        onClick={submitHandler}\r\n        isLoading={loading}\r\n      >\r\n        Login\r\n      </Button>\r\n      {/* <Button\r\n        variant=\"solid\"\r\n        colorScheme=\"red\"\r\n        width=\"100%\"\r\n        onClick={() => {\r\n          setEmail(\"guest@example.com\");\r\n          setPassword(\"123456\");\r\n        }}\r\n      >\r\n        Get Guest User Credentials\r\n      </Button> */}\r\n    </VStack>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","import { Button } from \"@chakra-ui/button\";\r\nimport { FormControl, FormLabel } from \"@chakra-ui/form-control\";\r\nimport { Input, InputGroup, InputRightElement } from \"@chakra-ui/input\";\r\nimport { VStack, Stack } from \"@chakra-ui/layout\";\r\nimport { useToast } from \"@chakra-ui/toast\";\r\nimport axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { Radio, RadioGroup } from \"@chakra-ui/react\";\r\n\r\nconst Signup = () => {\r\n  const [show, setShow] = useState(false); // show password, default: false ko cho coi\r\n  const handleClick = () => setShow(!show); // click -> show\r\n\r\n  // const [picLoading, setPicLoading] = useState(false);\r\n  const [name, setName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [confirmpassword, setConfirmpassword] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [pic, setPic] = useState();\r\n  const [loading, setLoading] = useState(false);\r\n  const toast = useToast();\r\n  const history = useHistory();\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [birth, setBirth] = useState();\r\n  const [sex, setsex] = useState('2');\r\n\r\n  const submitHandler = async () => {\r\n    setLoading(true);\r\n    var regexName = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i;\r\n    var regexPhone =\r\n      /^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$/;\r\n    var DatePresent = new Date().getFullYear();\r\n    var birhtUser = new Date(birth).getFullYear();\r\n    if (name.length <= 0) {\r\n      toast({\r\n        title: \"Please Enter your name \",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    // console.log(DatePresent - birhtUser);\r\n    if (DatePresent - birhtUser < 0) {\r\n      toast({\r\n        title: \"Age > 0\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (!regexName.test(email)) {\r\n      toast({\r\n        title: \"Please enter a valid email address\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    if (password.length <= 6) {\r\n      toast({\r\n        title: \"Password must be more than 6 characters\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    if (password !== confirmpassword) {\r\n      toast({\r\n        title: \"Passwords Do Not Match\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    if (!regexPhone.test(phone)) {\r\n      toast({\r\n        title: \"Phone number is required just number, from 10 to 12 characters\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    // console.log(name, email, password, pic);\r\n    try {\r\n      console.log(\"sex\", sex);\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n        },\r\n      };\r\n      const { data } = await axios.post(\r\n        \"/api/user\",\r\n        {\r\n          name,\r\n          email,\r\n          password,\r\n          phone,\r\n          sex,\r\n          birth,\r\n          pic,\r\n        },\r\n        config\r\n      );\r\n      console.log(data);\r\n      toast({\r\n        title:\r\n          \"Please check your email for further instructions on how to complete your account register.\",\r\n        status: \"success\",\r\n        duration: 7000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      // localStorage.setItem(\"userInfo\", JSON.stringify(data));\r\n      setLoading(false);\r\n      history.push(\"/\");\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error.response.data.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const postDetails = (pics) => {\r\n    setLoading(true);\r\n    if (pics === undefined) {\r\n      toast({\r\n        title: \"Please Select an Image!\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      return;\r\n    }\r\n    console.log(pics);\r\n    if (pics.type === \"image/jpeg\" || pics.type === \"image/png\") {\r\n      const data = new FormData();\r\n      data.append(\"file\", pics);\r\n      data.append(\"upload_preset\", \"MongoChat04\");\r\n      data.append(\"cloud_name\", \"dfgkg5eej\");\r\n      fetch(\"https://api.cloudinary.com/v1_1/dfgkg5eej/image/upload\", {\r\n        method: \"post\",\r\n        body: data,\r\n      })\r\n        .then((res) => res.json())\r\n        .then((data) => {\r\n          setPic(data.url.toString());\r\n          // console.log(data.url.toString());\r\n          setLoading(false);\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          setLoading(false);\r\n        });\r\n    } else {\r\n      toast({\r\n        title: \"Please Select an Image!\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <VStack spacing=\"5px\">\r\n      <FormControl id=\"first-name\" isRequired>\r\n        <FormLabel>Name</FormLabel>\r\n        <Input\r\n          placeholder=\"Enter Your Name\"\r\n          onChange={(e) => setName(e.target.value)}\r\n        />\r\n      </FormControl>\r\n      <FormControl id=\"birthday\" isRequired>\r\n        <FormLabel>Birthday</FormLabel>\r\n        <Input\r\n          type=\"date\"\r\n          onChange={(e) => {\r\n            setBirth(e.target.value);\r\n          }}\r\n        />\r\n      </FormControl>\r\n      <FormControl id=\"sex\" isRequired>\r\n        <FormLabel>Sex</FormLabel>\r\n        <RadioGroup value={sex} onChange={setsex}>\r\n          <Stack direction=\"row\">\r\n            <Radio\r\n              colorScheme=\"green\"\r\n              value='1'\r\n            >\r\n              Male\r\n            </Radio>\r\n            <Radio\r\n              colorScheme=\"green\"\r\n              value='2'\r\n             \r\n            >\r\n              Female\r\n            </Radio>\r\n            <Radio\r\n              colorScheme=\"green\"\r\n              value='3'\r\n              \r\n            >\r\n              Other\r\n            </Radio>\r\n          </Stack>\r\n        </RadioGroup>\r\n      </FormControl>\r\n      <FormControl id=\"email\" isRequired>\r\n        <FormLabel>Email Address</FormLabel>\r\n        <Input\r\n          type=\"email\"\r\n          placeholder=\"Enter Your Email Address\"\r\n          onChange={(e) => setEmail(e.target.value)}\r\n        />\r\n      </FormControl>\r\n      <FormControl id=\"password\" isRequired>\r\n        <FormLabel>Password</FormLabel>\r\n        <InputGroup size=\"md\">\r\n          <Input\r\n            type={show ? \"text\" : \"password\"}\r\n            placeholder=\"Enter Password\"\r\n            onChange={(e) => setPassword(e.target.value)}\r\n          />\r\n          <InputRightElement width=\"4.5rem\">\r\n            <Button h=\"1.75rem\" size=\"sm\" onClick={handleClick}>\r\n              {show ? \"Hide\" : \"Show\"}\r\n            </Button>\r\n          </InputRightElement>\r\n        </InputGroup>\r\n      </FormControl>\r\n      <FormControl id=\"password\" isRequired>\r\n        <FormLabel>Confirm Password</FormLabel>\r\n        <InputGroup size=\"md\">\r\n          <Input\r\n            type={show ? \"text\" : \"password\"}\r\n            placeholder=\"Confirm password\"\r\n            onChange={(e) => setConfirmpassword(e.target.value)}\r\n          />\r\n          <InputRightElement width=\"4.5rem\">\r\n            <Button h=\"1.75rem\" size=\"sm\" onClick={handleClick}>\r\n              {show ? \"Hide\" : \"Show\"}\r\n            </Button>\r\n          </InputRightElement>\r\n        </InputGroup>\r\n      </FormControl>\r\n      <FormControl id=\"phone\" isRequired>\r\n        <FormLabel>Phone Number</FormLabel>\r\n        <Input\r\n          type=\"tel\"\r\n          p={1.5}\r\n          required\r\n          pattern=\"[0-9]{3}-[0-9]{2}-[0-9]{3}\"\r\n          placeholder=\"Enter Your Phone Number\"\r\n          onChange={(e) => setPhone(e.target.value)}\r\n        />\r\n      </FormControl>\r\n      <FormControl id=\"pic\">\r\n        <FormLabel>Upload your Picture</FormLabel>\r\n        <Input\r\n          type=\"file\"\r\n          p={1.5}\r\n          accept=\"image/*\"\r\n          onChange={(e) => postDetails(e.target.files[0])}\r\n        />\r\n      </FormControl>\r\n      <Button\r\n        colorScheme=\"green\"\r\n        width=\"100%\"\r\n        style={{ marginTop: 15 }}\r\n        onClick={submitHandler}\r\n        isLoading={loading}\r\n        // color='green'\r\n      >\r\n        Sign Up\r\n      </Button>\r\n    </VStack>\r\n  );\r\n};\r\n\r\nexport default Signup;\r\n","export default __webpack_public_path__ + \"static/media/message-logo-removebg-preview.b66391f0.png\";","import React, { createContext, useContext, useEffect, useState } from \"react\";\r\n// import {useState} from \"react-usestateref\"\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nexport const ChatContext = createContext({});\r\n// contextAPI: qly state of our app -> fetch state directly from 1 place\r\n// truy cập accessAPI mọi nơi\r\nconst ChatProvider = ({ children }) => {\r\n  const [selectedChat, setSelectedChat] = useState(null);\r\n\r\n  const [user, setuser] = useState(\r\n    JSON.parse(localStorage.getItem(\"userInfo\"))\r\n  );\r\n  const [notification, setNotification] = useState([]);\r\n  const [chats, setChats] = useState([]);\r\n  const [socket, setSocket] = useState();\r\n  const [input, setInput] = useState([]);\r\n  const [selectedFriend, setselectedFriend] = useState(false);\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      if(selectedFriend){\r\n        history.push(\"/friend\");\r\n      }\r\n      else{\r\n        history.push(\"/chats\");\r\n      }\r\n      \r\n    } else {\r\n      history.push(\"/\");\r\n    }\r\n  }, [history]);\r\n  return (\r\n    <ChatContext.Provider\r\n      value={{\r\n        user,\r\n        setuser,\r\n        selectedChat,\r\n        setSelectedChat,\r\n        notification,\r\n        setNotification,\r\n        chats,\r\n        setChats,\r\n        selectedFriend,\r\n        setselectedFriend,\r\n        socket,\r\n        setSocket,\r\n        input,\r\n        setInput,\r\n      }}\r\n    >\r\n      {children}\r\n    </ChatContext.Provider>\r\n  );\r\n};\r\n\r\nexport const ChatState = () => {\r\n  return useContext(ChatContext);\r\n};\r\n\r\nexport default ChatProvider;\r\n","import {\r\n  Box,\r\n  Container,\r\n  Tab,\r\n  TabList,\r\n  TabPanel,\r\n  TabPanels,\r\n  Tabs,\r\n  Text,\r\n  Image,\r\n} from \"@chakra-ui/react\";\r\nimport { useEffect } from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport Login from \"../components/Authentication/Login\";\r\nimport Signup from \"../components/Authentication/Signup\";\r\nimport logo from \"../img/message-logo-removebg-preview.png\"\r\nimport ChatState from \"../Context/ChatProvider\"\r\n\r\nfunction Homepage() {\r\n  const history = useHistory();\r\n  // const {selectedFriend} = ChatState();  \r\n\r\n  useEffect(() => {\r\n    const user = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n    console.log(\"Home page: \", user);\r\n    if (user) {\r\n      // if(selectedFriend){\r\n      //   history.push(\"/friend\");\r\n      // }\r\n      // else{\r\n        history.push(\"/chats\");\r\n      // }\r\n      \r\n    }\r\n  }, [history]);\r\n\r\n  return (\r\n    <Container maxW=\"xl\" centerContent>\r\n      <Box\r\n        d=\"flex\"\r\n        justifyContent=\"center\"\r\n        p={3}\r\n        bg=\"white\"\r\n        w=\"100%\"\r\n        m=\"40px 0 15px 0\"\r\n        borderRadius=\"lg\"\r\n        borderWidth=\"1px\"\r\n        mt=\"4rem\"\r\n      >\r\n        {/* <Text fontSize=\"4xl\" fontFamily=\"Work sans\">\r\n          Hoang Chi\r\n        </Text> */}\r\n        <Image src={logo} w=\"37%\"/>\r\n      </Box>\r\n      <Box bg=\"white\" w=\"100%\" p={4} borderRadius=\"lg\" borderWidth=\"1px\">\r\n        <Tabs isFitted variant=\"soft-rounded\" colorScheme=\"green\">\r\n          <TabList mb=\"1em\">\r\n            <Tab>Login</Tab>\r\n            <Tab>Sign Up</Tab>\r\n          </TabList>\r\n          <TabPanels>\r\n            <TabPanel>\r\n              <Login />\r\n            </TabPanel>\r\n            <TabPanel>\r\n              <Signup />\r\n            </TabPanel>\r\n          </TabPanels>\r\n        </Tabs>\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default Homepage;\r\n","export const isSameSenderMargin = (messages, m, i, userId) => {\r\n  // console.log(i === messages.length - 1);\r\n\r\n  if (\r\n    i < messages.length - 1 &&\r\n    messages[i + 1].sender._id === m.sender._id &&\r\n    messages[i].sender._id !== userId\r\n  )\r\n    return \"auto auto auto 38px\";\r\n  else if (\r\n    (i < messages.length - 1 &&\r\n      messages[i + 1].sender._id !== m.sender._id &&\r\n      messages[i].sender._id !== userId) ||\r\n    (i === messages.length - 1 && messages[i].sender._id !== userId)\r\n  )\r\n    return \"auto auto auto 0px\";\r\n  else return \"auto 10px auto auto\";\r\n};\r\n\r\n// Xu lis tin nhan (2 fucntion) : mess cúi cùng, mess cùng 1 người -> ava xuống bét\r\nexport const isSameSender = (messages, m, i, userId) => {\r\n  return (\r\n    i < messages.length - 1 &&\r\n    (messages[i + 1].sender._id !== m.sender._id ||\r\n      messages[i + 1].sender._id === undefined) &&\r\n    messages[i].sender._id !== userId\r\n  );\r\n};\r\nexport const isLastMessage = (messages, i, userId) => {\r\n  return (\r\n    i === messages.length - 1 &&\r\n    messages[messages.length - 1].sender._id !== userId &&\r\n    messages[messages.length - 1].sender._id\r\n  );\r\n};\r\n\r\nexport const isSameUser = (messages, m, i) => {\r\n  return i > 0 && messages[i - 1].sender._id === m.sender._id;\r\n};\r\n\r\n// Message Private - Message nhom\r\nexport const getSender = (loggedUser, users) => {\r\n  return users[0]._id === loggedUser._id ? users[1].name : users[0].name;\r\n};\r\n\r\nexport const getSenderFull = (loggedUser, users) => {\r\n  return users[0]._id === loggedUser._id ? users[1] : users[0];\r\n};\r\n\r\nexport const showMenu = (m, i, userId) => {\r\n  // console.log(i === messages.length - 1);\r\n  return i > 0 && m.sender._id === userId;\r\n};\r\n\r\n// Message Private - Message nhom\r\nexport const getSenderPic = (loggedUser, users) => {\r\n  return users[0]._id === loggedUser._id ? users[1].pic : users[0].pic;\r\n};\r\n\r\nexport const getUserOther = (loggedUser, users) => {\r\n  return users[0]._id === loggedUser._id ? users[1] : users[0];\r\n};\r\n\r\n// export const getLastMessage = (lastMessage) => {\r\n//   return lastMessage.recallMessage ? \"Message Recall\" : lastMessage.content;\r\n// };\r\n","import { ViewIcon, InfoOutlineIcon } from \"@chakra-ui/icons\";\r\nimport {\r\n  Modal,\r\n  ModalOverlay,\r\n  ModalContent,\r\n  ModalHeader,\r\n  ModalFooter,\r\n  ModalBody,\r\n  ModalCloseButton,\r\n  Button,\r\n  useDisclosure,\r\n  IconButton,\r\n  Text,\r\n  Image,\r\n} from \"@chakra-ui/react\";\r\nimport axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { useToast } from \"@chakra-ui/toast\";\r\nimport { getUserOther } from \"../../config/ChatLogics\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\n\r\nconst ProfileModal = ({ user, children, statusFiend }) => {\r\n  const { isOpen, onOpen, onClose } = useDisclosure();\r\n  const { selectedChat } = ChatState();\r\n  const loggedUser = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n  \r\n  const [loading, setLoading] = useState(false);\r\n  const toast = useToast();\r\n  const unfrinedFriend = async () => {\r\n    return;\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${loggedUser.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.post(\r\n        \"/api/friend/unfriend\",\r\n        {\r\n          user: loggedUser._id,\r\n          friend: user._id,\r\n        },\r\n        config\r\n        );\r\n        onClose(true);\r\n      } catch (error) {\r\n        toast({\r\n          title: \"Error Occured!\",\r\n          description: \"FRIEND\",\r\n          status: \"error\",\r\n          duration: 5000,\r\n          isClosable: true,\r\n          position: \"bottom\",\r\n        });\r\n        setLoading(false);\r\n      }\r\n    };\r\n    const checkStatusFriend = () => {\r\n      console.log(\"TINH TRANG:\", statusFiend);\r\n      if(statusFiend !== undefined){\r\n        if(statusFiend[0].status == 2 ){\r\n\r\n          return true ;\r\n        }\r\n      }\r\n      return false;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {children ? (\r\n        <span onClick={onOpen}>{children}</span>\r\n      ) : (\r\n        <IconButton\r\n          d={{ base: \"flex\" }}\r\n          icon={<InfoOutlineIcon />}\r\n          onClick={onOpen}\r\n        />\r\n      )}\r\n      <Modal size=\"lg\" onClose={onClose} isOpen={isOpen} isCentered>\r\n        <ModalOverlay />\r\n        <ModalContent h=\"410px\">\r\n          <ModalHeader\r\n            fontSize=\"40px\"\r\n            fontFamily=\"Work sans\"\r\n            d=\"flex\"\r\n            justifyContent=\"center\"\r\n          >\r\n            {user.name}\r\n          </ModalHeader>\r\n          <ModalCloseButton />\r\n          <ModalBody\r\n            d=\"flex\"\r\n            flexDir=\"column\"\r\n            alignItems=\"center\"\r\n            justifyContent=\"space-between\"\r\n          >\r\n            <Image\r\n              borderRadius=\"full\"\r\n              boxSize=\"150px\"\r\n              src={user.pic}\r\n              alt={user.name}\r\n            />\r\n            <Text\r\n              fontSize={{ base: \"28px\", md: \"30px\" }}\r\n              fontFamily=\"Work sans\"\r\n            >\r\n              Email: {user.email}\r\n            </Text>\r\n          </ModalBody>\r\n          <ModalFooter>\r\n            {checkStatusFriend() && (\r\n              <Button onClick={unfrinedFriend} colorScheme=\"red\" mr={5}>\r\n                Unfriend\r\n              </Button>\r\n            )}\r\n            <Button onClick={onClose}>Close</Button>\r\n          </ModalFooter>\r\n        </ModalContent>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProfileModal;\r\n","import {\r\n  Image,\r\n  Box,\r\n  IconButton,\r\n  Menu,\r\n  MenuButton,\r\n  MenuList,\r\n  MenuItem,\r\n  MenuDivider,\r\n  useToast,\r\n  Text,\r\n} from \"@chakra-ui/react\";\r\nimport {\r\n  isLastMessage,\r\n  isSameSender,\r\n  isSameSenderMargin,\r\n  isSameUser,\r\n  showMenu,\r\n} from \"../../config/ChatLogics\";\r\nimport { Avatar } from \"@chakra-ui/avatar\";\r\nimport { Tooltip } from \"@chakra-ui/tooltip\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { DragHandleIcon, RepeatIcon } from \"@chakra-ui/icons\";\r\nimport axios from \"axios\";\r\nimport files from \"../../img/folder.png\";\r\n\r\nvar displayText = \"block\";\r\nvar displayRecall = \"block\";\r\nconst BoxMessage = ({ messages, m, i, socket }) => {\r\n  const [isShown, setIsShown] = useState(\"none\");\r\n  const [mess, setmess] = useState();\r\n  const toast = useToast();\r\n  const handlePic = (pic) => {\r\n    if (pic) {\r\n      displayText = \"none\";\r\n      return pic;\r\n    }\r\n  };\r\n\r\n  const handleContent = (content) => {\r\n    if (content != \"image\") {\r\n      displayText = \"block\";\r\n      // console.log(\"content\", content);\r\n      return content;\r\n    }\r\n  };\r\n\r\n  const handleTimeSend = (timeSend) => {\r\n    const date = new Date(timeSend);\r\n\r\n    return date.toLocaleString(\"en-US\", {\r\n      hour12: false,\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  };\r\n\r\n  const { user } = ChatState();\r\n\r\n  const handleSelected = () => {};\r\n\r\n  //hien nut ban menu\r\n  const handleShowMenu = () => {\r\n    setIsShown(\"flex\");\r\n    setmess(m);\r\n  };\r\n\r\n  const handleMessageClick = async (event) => {\r\n    event.preventDefault();\r\n    if (!mess) {\r\n      return;\r\n    } else {\r\n      try {\r\n        const config = {\r\n          headers: {\r\n            \"Content-type\": \"application/json\",\r\n            Authorization: `Bearer ${user.token}`,\r\n          },\r\n        };\r\n        const { data } = await axios.post(\r\n          \"/api/message/recallMessage\",\r\n          {\r\n            id: mess._id,\r\n          },\r\n          config\r\n        );\r\n        // console.log(\"BOX MESSAGE: \", data);\r\n        // xuLyMess(messages, data);\r\n        socket.emit(\"recall message\", data);\r\n      } catch (e) {\r\n        toast({\r\n          title: \"Error Occured!\",\r\n          description: \"Box Message - Recall Message error\",\r\n          status: \"error\",\r\n          duration: 5000,\r\n          isClosable: true,\r\n          position: \"bottom-left\",\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Box style={{ display: \"flex\" }} key={m._id}>\r\n        {(isSameSender(messages, m, i, user._id) ||\r\n          isLastMessage(messages, i, user._id)) && (\r\n          <ProfileModal user={m.sender}>\r\n            <Avatar\r\n              mt=\"7px\"\r\n              mr={1}\r\n              size=\"sm\"\r\n              cursor=\"pointer\"\r\n              name={m.sender.name}\r\n              src={m.sender.pic}\r\n              onClick={() => handleSelected()}\r\n            />\r\n          </ProfileModal>\r\n        )}\r\n        {!m.recallMessage && (\r\n          <>\r\n            <Box\r\n              w=\"100%\"\r\n              h=\"25%\"\r\n              d=\"flex\"\r\n              onMouseEnter={handleShowMenu}\r\n              onMouseLeave={() => {\r\n                setIsShown(\"none\");\r\n                setmess(null);\r\n              }}\r\n            >\r\n              {m.content === \"image\" ? (\r\n                <>\r\n                  <Box\r\n                    display=\"flex\"\r\n                    // bg=\"red\"\r\n                    // right=\"230px\"\r\n                    width=\"100%\"\r\n                    justifyContent={\"space-between\"}\r\n                  >\r\n                    <Box\r\n                      style={{\r\n                        margin: isSameSenderMargin(messages, m, i, user._id),\r\n                        marginTop: isSameUser(messages, m, i, user._id)\r\n                          ? 3\r\n                          : 10,\r\n                        minWidth: \"0px\",\r\n                        maxWidth: \"300px\",\r\n                        \r\n\r\n                        // width: \"50%\",\r\n                        position: \"relative\",\r\n                      }}\r\n                    >\r\n                      <Image\r\n                        minHeight=\"0px\"\r\n                        maxHeight=\"300px\"\r\n                        borderRadius={5}\r\n                        src={handlePic(m.pic)}\r\n                      />\r\n                      <Text />\r\n                      <Menu>\r\n                        <MenuButton\r\n                          as={IconButton}\r\n                          fontSize=\"15px\"\r\n                          size=\"xs\"\r\n                          style={{\r\n                            zIndex: \"162\",\r\n                            backgroundColor: \"white\",\r\n                            position: \"absolute\",\r\n                            // mr: \"100px\",\r\n                            bottom: 0,\r\n                            right: showMenu(m, i, user._id)\r\n                              ? `${m.pic}`.size\r\n                              : -30,\r\n                            display: `${isShown}`,\r\n                          }}\r\n                          icon={<DragHandleIcon />}\r\n                          onClick={() => setIsShown(\"flex\")}\r\n                        />\r\n                        <MenuList\r\n                          mt=\"-20px\"\r\n                          style={{\r\n                            right: showMenu(m, i, user._id) ? 0 : -240,\r\n                            zIndex: \"2\",\r\n                            d: \"flex\",\r\n                            position: \"absolute\",\r\n                          }}\r\n                        >\r\n                          <MenuItem color=\"red\" onClick={handleMessageClick}>\r\n                            <RepeatIcon color=\"red\" mr=\"10px\" />\r\n                            Recall Message\r\n                          </MenuItem>\r\n                          <MenuDivider />\r\n                        </MenuList>\r\n                      </Menu>\r\n                    </Box>\r\n                  </Box>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  {m.file !== undefined ? (\r\n                    <a\r\n                      style={{\r\n                        display: \"flex\",\r\n                        backgroundColor: `${\r\n                          m.sender._id === user._id ? \"#B9F5D0\" : \"#ffffff\"\r\n                        }`,\r\n                        margin: isSameSenderMargin(messages, m, i, user._id),\r\n                        marginTop: isSameUser(messages, m, i, user._id)\r\n                          ? 3\r\n                          : 10,\r\n                        borderRadius: \"8px\",\r\n                        padding: \"5px 15px\",\r\n                        minWidth: \"140px\",\r\n                        maxWidth: \"80%\",\r\n                        height: \"70\",\r\n                      }}\r\n                      href={m.file}\r\n                    >\r\n                      <Image src={files} mr={5} />\r\n                      <Box>\r\n                        <Text fontWeight=\"bold\">\r\n                          {handleContent(m.content)}\r\n                        </Text>\r\n\r\n                        <Box\r\n                          display=\"flex\"\r\n                          // bg=\"red\"\r\n                          mt={3}\r\n                          justifyContent={\"space-between\"}\r\n                        >\r\n                          <Text\r\n                            fontSize=\"15px\"\r\n                            color=\"gray\"\r\n                            paddingRight=\"0px\"\r\n                            display=\"flex\"\r\n                          >\r\n                            {handleTimeSend(m.createdAt)}\r\n                          </Text>\r\n                          <Menu>\r\n                            <MenuButton\r\n                              as={IconButton}\r\n                              fontSize=\"15px\"\r\n                              size=\"xs\"\r\n                              style={{\r\n                                backgroundColor: \"white\",\r\n                                position: \"relative\",\r\n                                mr: \"0px\",\r\n                                display: `${isShown}`,\r\n                                // zIndex: \"1\",\r\n                              }}\r\n                              icon={<DragHandleIcon />}\r\n                              onClick={() => setIsShown(\"flex\")}\r\n                            />\r\n                            <MenuList\r\n                              mt=\"-20px\"\r\n                              // position={\"fixed\"}\r\n                              // zIndex={2}\r\n                              style={{\r\n                                // margin: showMenu(messages, m, i, user._id),\r\n                                right: showMenu(m, i, user._id) ? 0 : -240,\r\n                                zIndex: \"2\",\r\n                                d: \"flex\",\r\n                                position: \"absolute\",\r\n                                // top: \"200px\",\r\n                              }}\r\n                            >\r\n                              <MenuItem\r\n                                color=\"red\"\r\n                                onClick={handleMessageClick}\r\n                              >\r\n                                <RepeatIcon color=\"red\" mr=\"10px\" />\r\n                                Recall Message\r\n                              </MenuItem>\r\n                              <MenuDivider />\r\n                            </MenuList>\r\n                          </Menu>\r\n                        </Box>\r\n                      </Box>\r\n                    </a>\r\n                  ) : (\r\n                    <Box\r\n                      // onMouseOver={() => setIsShown(\"flex\")}\r\n                      style={{\r\n                        backgroundColor: `${\r\n                          m.sender._id === user._id ? \"#B9F5D0\" : \"#ffffff\"\r\n                        }`,\r\n                        margin: isSameSenderMargin(messages, m, i, user._id),\r\n                        marginTop: isSameUser(messages, m, i, user._id)\r\n                          ? 3\r\n                          : 10,\r\n                        borderRadius: \"8px\",\r\n                        padding: \"5px 15px\",\r\n                        minWidth: \"140px\",\r\n                        maxWidth: \"80%\",\r\n                        height: \"70\",\r\n                      }}\r\n                    >\r\n                      <Text>{handleContent(m.content)}</Text>\r\n\r\n                      <Box\r\n                        display=\"flex\"\r\n                        // bg=\"red\"\r\n                        mt={3}\r\n                        justifyContent={\"space-between\"}\r\n                      >\r\n                        <Text\r\n                          fontSize=\"15px\"\r\n                          color=\"gray\"\r\n                          paddingRight=\"0px\"\r\n                          display=\"flex\"\r\n                        >\r\n                          {handleTimeSend(m.createdAt)}\r\n                        </Text>\r\n                        <Menu>\r\n                          <MenuButton\r\n                            as={IconButton}\r\n                            fontSize=\"15px\"\r\n                            size=\"xs\"\r\n                            style={{\r\n                              backgroundColor: \"white\",\r\n                              position: \"relative\",\r\n                              mr: \"0px\",\r\n                              display: `${isShown}`,\r\n                              // zIndex: \"1\",\r\n                            }}\r\n                            icon={<DragHandleIcon />}\r\n                            onClick={() => setIsShown(\"flex\")}\r\n                          />\r\n                          <MenuList\r\n                            mt=\"-20px\"\r\n                            // position={\"fixed\"}\r\n                            // zIndex={2}\r\n                            style={{\r\n                              // margin: showMenu(messages, m, i, user._id),\r\n                              right: showMenu(m, i, user._id) ? 0 : -240,\r\n                              zIndex: \"2\",\r\n                              d: \"flex\",\r\n                              position: \"absolute\",\r\n                              // top: \"200px\",\r\n                            }}\r\n                          >\r\n                            <MenuItem color=\"red\" onClick={handleMessageClick}>\r\n                              <RepeatIcon color=\"red\" mr=\"10px\" />\r\n                              Recall Message\r\n                            </MenuItem>\r\n                            <MenuDivider />\r\n                          </MenuList>\r\n                        </Menu>\r\n                      </Box>\r\n                    </Box>\r\n                  )}\r\n                </>\r\n              )}\r\n            </Box>\r\n          </>\r\n        )}\r\n        {/* <IconMenu></IconMenu> */}\r\n\r\n        {m.recallMessage && (\r\n          // onMouseOver={() => setIsShown(\"flex\")}\r\n\r\n          <Box\r\n            style={{\r\n              backgroundColor: `${\r\n                m.sender._id === user._id ? \"#B9F5D0\" : \"#ffffff\"\r\n              }`,\r\n              margin: isSameSenderMargin(messages, m, i, user._id),\r\n              marginTop: isSameUser(messages, m, i, user._id) ? 3 : 10,\r\n              borderRadius: \"8px\",\r\n              padding: \"5px 15px\",\r\n              maxWidth: \"80%\",\r\n              height: \"70\",\r\n              display: \"block\",\r\n            }}\r\n          >\r\n            <Text color=\"gray\">Message Recall</Text>\r\n            <Text\r\n              fontSize=\"15px\"\r\n              color=\"gray\"\r\n              paddingRight=\"0px\"\r\n              display=\"flex\"\r\n            >\r\n              {handleTimeSend(m.createdAt)}\r\n            </Text>\r\n          </Box>\r\n        )}\r\n      </Box>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default BoxMessage;\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAABYgAAAWIBXyfQUwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAO/SURBVHic7ZpPaBxVHMc/783sbroxBNuiLbZU8U9FY8CDQqkHweqh4D9oMKCiJhQtVDwIKsVepAcPggjqQcSrrRRBQalYKootYhFUGmJYqi1tLSpuU5LaZrPzfh42Na5sdibzXubtmvlcdubtb76/73z37Xu77EJOTk7OMkZZK3wwVET6n0GZW1NaiBD5kEfeO2jtJU13a4V9I6+h1POWKgajNjP87jfWfhaJtlZQaosTH1pecaCTorE9BQcaAPeyb3SzI63EuAjAHYpdWbfsrABgK3u335Flw04LALTZgzhYnBPiYBscHQNusbfSxOfAx6BqAFTLg0RBv9MOyoyz441XYwOQL+4OKdYeBza2ev6tCytHp41avdD1M6LZe6mP8dlSerNn++Giq7X2X5RrP8QH8PVdb4PssOkzJZrbfr+Ok1HKm1iqAAIj8WuAcL9tnz5leLnvT1sZ90RaxQegxGLuzvPEivNcG866kHJKZrtAQQkv9FazapeYTLfB0fIkG4LOmgWZBlBUwq4OWwvCrBtuL0+iBA7VykSi2FSfjr9oZRXqi3utvvzrSj6aWhVbp2RoKOCa6sOIvr5lxcDsbrT0LqgQCqwzUJJFGfyHE5fSXZeA/bKGoTMDbWtC1p57B1EjsMANHEswSSYM3DfjYT6158Hwj9gajWLYutMFDZUl+KBiSSAmtkYDZSfdKgHUnShlirtdYEbB8Q57DyTA7Tb4U6HrZoHbAGp03Sxw7/ZYAYyCVREY4NeL7eurKaaMVnBVAFekctiE+wAMc1tnCFEdJs46bwE0QrhzNWwM7GQc2ckeIzCW4FNkDN0bAEA9fp+Po7sDcEAegG8DvskD8G3AN3kAvg34Jg/AtwGvqOUeQE/9dHd9d01Db631/460nKY09fT/OgCNGJ59fVP7mmVOHoBvA77JA/BtgOGd8Oan8NSLoOb+sBKGsHNPY3zro+m1lYr9vc7vLnDz7TDyUuP4pkEYOwrfHoJ7tsEDTzbGbxyA776C304tXr+kTsSV+A3g6vXN52s3NB7XrJsfU7px3ioAQejRZ1ooGzQTUHgszoLfAKbPN59PnZt7/O/4ZOvrjdTUtqPrWz+ZDL9rwPeH4chn88eHDzSOD+6Hyo8gBg68Dz+PL5kFJc9tSfnDfgKiOkxU4usKRZitJR+/TLE4oz75pSe9Qd8z4DIL3WS7m3dEZwTgEQ1Evk1YYP321QhHXDjxQqlw3FYixKhhAtmNcIMLT02ICimvGHSvi1AIKxTDh5xr5+Tk5Cwn/gboKu+NfeitigAAAABJRU5ErkJggg==\"","import ScrollableFeed from \"react-scrollable-feed\";\r\nimport BoxMessage from \"./miscellaneous/BoxMessage\";\r\nimport { useRef, useEffect, useState } from \"react\";\r\n\r\nconst ScrollableChat = ({ messages, socket }) => {\r\n\r\n  const bottomRef = useRef(null);\r\n\r\n\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      bottomRef.current?.scrollIntoView({behavior:\"auto\"});\r\n    },500);\r\n  }, [messages]);\r\n  return (\r\n    <>\r\n      <ScrollableFeed>\r\n      \r\n\r\n        {messages &&\r\n          messages.map((m, i) => (\r\n            <BoxMessage key={i} messages={messages} m={m} i={i} socket={socket} />\r\n          ))}\r\n{/* style={{display: \"none\",height:\"300px\", width:\"300px\"}}  */}\r\n      <div  ref={bottomRef}  />     \r\n      </ScrollableFeed>\r\n     \r\n    </>\r\n  );\r\n};\r\n\r\nexport default ScrollableChat;\r\n","import { CloseIcon } from \"@chakra-ui/icons\";\r\nimport { Badge } from \"@chakra-ui/layout\";\r\n\r\nconst UserBadgeItem = ({ user, handleFunction, admin }) => {\r\n  return (\r\n    <Badge\r\n      px={2}\r\n      py={1}\r\n      borderRadius=\"lg\"\r\n      m={1}\r\n      mb={2}\r\n      variant=\"solid\"\r\n      fontSize={12}\r\n      colorScheme=\"purple\"\r\n      cursor=\"pointer\"\r\n      onClick={handleFunction}\r\n    >\r\n      {user.name}\r\n      {/* {admin === user._id && <span> (Admin)</span>} */}\r\n      <CloseIcon pl={1} />\r\n    </Badge>\r\n  );\r\n};\r\n\r\nexport default UserBadgeItem;\r\n","import { Avatar } from \"@chakra-ui/avatar\";\r\nimport { Text, Box } from \"@chakra-ui/react\";\r\n\r\nconst UserListItem = ({ user, handleFunction }) => {\r\n  return (\r\n    <Box\r\n      onClick={handleFunction}\r\n      cursor=\"pointer\"\r\n      bg=\"#E8E8E8\"\r\n      _hover={{\r\n        background: \"#ABEBC6\",\r\n        color: \"white\",\r\n      }}\r\n      w=\"100%\"\r\n      d=\"flex\"\r\n      alignItems=\"center\"\r\n      color=\"black\"\r\n      px={3}\r\n      py={2}\r\n      mb={2}\r\n      borderRadius=\"lg\"\r\n    >\r\n      <Avatar\r\n        mr={2}\r\n        size=\"sm\"\r\n        cursor=\"pointer\"\r\n        // name={user.name}\r\n        src={user.pic}\r\n      />\r\n      <Box>\r\n        <Text>{user.name}</Text>\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default UserListItem;\r\n","import { Avatar } from \"@chakra-ui/avatar\";\r\nimport { Box, Text,TagRightIcon } from \"@chakra-ui/react\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\nimport { CloseIcon } from \"@chakra-ui/icons\";\r\n\r\nconst UserListItemGroup = ({ user, handleFunction, admin }) => {\r\n  return (\r\n    <Box\r\n\r\n      onClick={handleFunction}\r\n      cursor=\"pointer\"\r\n      bg=\"#E8E8E8\"\r\n      _hover={{\r\n        background: \"#38B2AC\",\r\n        color: \"white\",\r\n      }}\r\n      w=\"100%\"\r\n      d=\"flex\"\r\n      alignItems=\"center\"\r\n      color=\"black\"\r\n      px={3}\r\n      py={2}\r\n      mb={2}\r\n      borderRadius=\"lg\"\r\n      \r\n      \r\n    >\r\n      \r\n      <Avatar\r\n        mr={2}\r\n        size=\"sm\"\r\n        cursor=\"pointer\"\r\n        name={user.name}\r\n        src={user.pic}\r\n      />\r\n      <Box>\r\n        <Text>{user.name}</Text>\r\n        <Text fontSize=\"xs\">\r\n        {admin._id === user._id && <span> (Owner)</span>}\r\n        </Text>\r\n      </Box>\r\n        <TagRightIcon as={CloseIcon} />\r\n      \r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default UserListItemGroup;\r\n","import { InfoOutlineIcon } from \"@chakra-ui/icons\";\r\nimport {\r\n  Button,\r\n  Image,\r\n  FormControl,\r\n  Input,\r\n  useToast,\r\n  Box,\r\n  Accordion,\r\n  AccordionItem,\r\n  AccordionButton,\r\n  AccordionPanel,\r\n  AccordionIcon,\r\n  Spinner,\r\n} from \"@chakra-ui/react\";\r\nimport axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\nimport UserBadgeItem from \"../userAvatar/UserBadgeItem\";\r\nimport UserListItem from \"../userAvatar/UserListItem\";\r\nimport UserListItemGroup from \"../userAvatar/UserListItemGroup\";\r\n\r\nconst BoxInformationChat = ({ fetchMessages, fetchAgain, setFetchAgain }) => {\r\n  const [groupChatName, setGroupChatName] = useState();\r\n  const [search, setSearch] = useState(\"\");\r\n  const [searchResult, setSearchResult] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [renameloading, setRenameLoading] = useState(false);\r\n  const toast = useToast();\r\n\r\n  const { selectedChat, setSelectedChat, user } = ChatState();\r\n  console.log(\"info chat box\", user);\r\n\r\n  const handleSearch = async (query) => {\r\n    setSearch(query);\r\n    console.log(\"query :\", search);\r\n    if (!query) {\r\n      setSearchResult(null);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.get(`/api/user?search=${query}`, config);\r\n      console.log(\"SEARCH GROUP: \",data);\r\n      setLoading(false);\r\n      setSearchResult(data);\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to Load the Search Results\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRename = async () => {\r\n    if (!groupChatName) return;\r\n\r\n    try {\r\n      setRenameLoading(true);\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.put(\r\n        `/api/chat/rename`,\r\n        {\r\n          chatId: selectedChat._id,\r\n          chatName: groupChatName,\r\n        },\r\n        config\r\n      );\r\n\r\n      console.log(data._id);\r\n      // setSelectedChat(\"\");\r\n      setSelectedChat(data);\r\n      setFetchAgain(!fetchAgain);\r\n      setRenameLoading(false);\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error.response.data.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setRenameLoading(false);\r\n    }\r\n    setGroupChatName(\"\");\r\n  };\r\n\r\n  const handleAddUser = async (user1) => {\r\n    if (selectedChat.users.find((u) => u._id === user1._id)) {\r\n      toast({\r\n        title: \"User Already in group!\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (selectedChat.groupAdmin._id !== user._id) {\r\n      toast({\r\n        title: \"Only admins can add someone!\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.put(\r\n        `/api/chat/groupadd`,\r\n        {\r\n          chatId: selectedChat._id,\r\n          userId: user1._id,\r\n        },\r\n        config\r\n      );\r\n\r\n      setSelectedChat(data);\r\n      setFetchAgain(!fetchAgain);\r\n      setLoading(false);\r\n      toast({\r\n        title: \"Success\",\r\n        description: \"Add memeber success\",\r\n        status: \"success\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error.response.data.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n    }\r\n    setGroupChatName(\"\");\r\n  };\r\n\r\n  const handleRemove = async (user1) => {\r\n    if (selectedChat.groupAdmin._id !== user._id && user1._id !== user._id) {\r\n      // ko là admin & ko thể remove chính mình\r\n      toast({\r\n        title: \"Only admins can remove someone!\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.put(\r\n        `/api/chat/groupremove`,\r\n        {\r\n          chatId: selectedChat._id,\r\n          userId: user1._id,\r\n        },\r\n        config\r\n      );\r\n\r\n      user1._id === user._id ? setSelectedChat() : setSelectedChat(data);\r\n      setFetchAgain(!fetchAgain);\r\n      fetchMessages();\r\n      setLoading(false);\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error.response.data.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n    }\r\n    setGroupChatName(\"\");\r\n  };\r\n\r\n  return (\r\n    \r\n    <Box background=\"white\" w=\"113%\" ml=\"-25px\" borderRadius={5}>\r\n\r\n      <Accordion defaultIndex={[0]} allowMultiple>\r\n        <AccordionItem>\r\n        <h2>\r\n      <AccordionButton>\r\n        <Box flex='1' textAlign='left' fontWeight=\"bold\">\r\n          Group Members\r\n        </Box>\r\n        <AccordionIcon />\r\n      </AccordionButton>\r\n      </h2>\r\n      <AccordionPanel pb={4}>\r\n      <FormControl d=\"flex\">\r\n              <Input\r\n                placeholder=\"Chat Name\"\r\n                mb={3}\r\n                value={groupChatName}\r\n                onChange={(e) => setGroupChatName(e.target.value)}\r\n              />\r\n              <Button\r\n                variant=\"solid\"\r\n                colorScheme=\"teal\"\r\n                ml={1}\r\n                isLoading={renameloading}\r\n                onClick={handleRename}\r\n              >\r\n                Update\r\n              </Button>\r\n            </FormControl>\r\n            <FormControl>\r\n              <Input\r\n                placeholder=\"Add User to group\"\r\n                mb={1}\r\n                onChange={(e) => handleSearch(e.target.value)}\r\n              />\r\n            </FormControl>\r\n\r\n            {loading ? ( // con quay khi search user\r\n              <Spinner size=\"lg\" />\r\n            ) : (\r\n              searchResult?.map((user) => (\r\n                <UserListItem\r\n                  key={user._id}\r\n                  user={user}\r\n                  handleFunction={() => handleAddUser(user)}\r\n                />\r\n              ))\r\n            )}\r\n      <Box   d=\"flex\" flexWrap=\"wrap\" pb={3} >\r\n              {selectedChat.users.map((u) => (\r\n                // <UserBadgeItem\r\n                //   key={u._id}\r\n                //   user={u}\r\n                //   admin={selectedChat.groupAdmin}\r\n                //   handleFunction={() => handleRemove(u)}\r\n                // />\r\n                <UserListItemGroup\r\n                  key={u._id}\r\n                  user={u}\r\n                  handleFunction={() => handleRemove(u)}\r\n                  admin={selectedChat.groupAdmin}\r\n                  \r\n                />\r\n              ))}\r\n        </Box>\r\n        </AccordionPanel>\r\n        </AccordionItem>\r\n        </Accordion>\r\n    </Box>\r\n   \r\n  );\r\n};\r\n\r\nexport default BoxInformationChat;\r\n","import { InfoOutlineIcon } from \"@chakra-ui/icons\";\r\nimport {\r\n  Button,\r\n  Image,\r\n  FormControl,\r\n  Input,\r\n  useToast,\r\n  Box,\r\n  Accordion,\r\n  AccordionItem,\r\n  AccordionButton,\r\n  AccordionPanel,\r\n  AccordionIcon,\r\n  Spinner,\r\n} from \"@chakra-ui/react\";\r\nimport axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\nimport UserBadgeItem from \"../userAvatar/UserBadgeItem\";\r\nimport UserListItem from \"../userAvatar/UserListItem\";\r\nimport UserListItemGroup from \"../userAvatar/UserListItemGroup\";\r\n\r\nconst BoxInfoFile = ({ fetchMessages, fetchAgain, setFetchAgain }) => {\r\n  const [groupChatName, setGroupChatName] = useState();\r\n  const [search, setSearch] = useState(\"\");\r\n  const [searchResult, setSearchResult] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [renameloading, setRenameLoading] = useState(false);\r\n  const toast = useToast();\r\n\r\n  const { selectedChat, setSelectedChat, user } = ChatState();\r\n  \r\n\r\n\r\n  return (\r\n    \r\n    <Box background=\"white\" w=\"113%\" ml=\"-25px\" borderRadius={5}>\r\n\r\n        <Accordion defaultIndex={[0]} allowMultiple>\r\n        <AccordionItem>\r\n        <h2>\r\n      <AccordionButton>\r\n        <Box flex='1' textAlign='left' fontWeight=\"bold\">\r\n          File\r\n        </Box>\r\n        <AccordionIcon />\r\n      </AccordionButton>\r\n      </h2>\r\n      <AccordionPanel pb={4}>\r\n      <Box   d=\"flex\" flexWrap=\"wrap\" pb={3} >\r\n              {selectedChat.users.map((u) => (\r\n                <Image src={u.avartar}></Image>\r\n                \r\n              ))}\r\n        </Box>\r\n        </AccordionPanel>\r\n        </AccordionItem>\r\n        </Accordion>\r\n\r\n        \r\n    </Box>\r\n   \r\n  );\r\n};\r\n\r\nexport default BoxInfoFile;\r\n","import { InfoOutlineIcon } from \"@chakra-ui/icons\";\r\nimport {\r\n  Button,\r\n  Image,\r\n  FormControl,\r\n  Input,\r\n  useToast,\r\n  Box,\r\n  Accordion,\r\n  AccordionItem,\r\n  AccordionButton,\r\n  AccordionPanel,\r\n  AccordionIcon,\r\n  Spinner,\r\n} from \"@chakra-ui/react\";\r\nimport axios from \"axios\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\n\r\nconst BoxInfoIamge = ({  }) => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [pics, setPics] = useState([]);\r\n  const toast = useToast();\r\n\r\n  const { selectedChat, setSelectedChat, user } = ChatState();\r\n\r\n  useEffect(() => {\r\n    fetchImage();\r\n  }, []);\r\n\r\n  const fetchImage = async () => {\r\n    if (!selectedChat) return;\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n\r\n      setLoading(true);\r\n\r\n      const { data } = await axios.get(\r\n        `/api/message/image/${selectedChat._id}`,\r\n        config\r\n      );\r\n      // setMessages(data);\r\n      setPics(data);\r\n      setLoading(false);\r\n\r\n      \r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box background=\"white\" w=\"113%\" ml=\"-25px\" borderRadius={5}>\r\n      <Accordion defaultIndex={[0]} allowMultiple>\r\n        <AccordionItem>\r\n          <h2>\r\n            <AccordionButton>\r\n              <Box flex=\"1\" textAlign=\"left\" fontWeight=\"bold\">\r\n                Image/Video\r\n              </Box>\r\n              <AccordionIcon />\r\n            </AccordionButton>\r\n          </h2>\r\n          <AccordionPanel pb={4}>\r\n            <Box d=\"flex\" flexWrap=\"wrap\" pb={3}>\r\n              {pics.map((u) => (\r\n                <Image src={u.pic} width=\"25%\"/>\r\n                // <UserListItemGroup\r\n                //   key={u._id}\r\n                //   user={u}\r\n                //   handleFunction={() => handleRemove(u)}\r\n                //   admin={selectedChat.groupAdmin}\r\n                // />\r\n              ))}\r\n            </Box>\r\n          </AccordionPanel>\r\n        </AccordionItem>\r\n      </Accordion>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default BoxInfoIamge;\r\n","import { FormControl } from \"@chakra-ui/form-control\";\r\nimport { Input } from \"@chakra-ui/input\";\r\nimport {\r\n  BsFillEmojiSmileFill,\r\n  \r\n  BsPaperclip,\r\n  BsFillArrowRightCircleFill,\r\n} from \"react-icons/bs\";\r\nimport axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { Box } from \"@chakra-ui/layout\";\r\nimport { IconButton, Grid, GridItem, useToast } from \"@chakra-ui/react\";\r\nimport EmojiPicker from \"emoji-picker-react\";\r\nimport { IoImageOutline } from \"react-icons/io5\";\r\nimport \"../styles.css\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\nimport AWS from \"aws-sdk\";\r\nimport { uploadFile } from \"react-s3\";\r\n\r\nconst S3_BUCKET = \"07-upload-image\";\r\nconst REGION = \"ap-southeast-1\";\r\nconst ACCESS_KEY = \"AKIA24335YBYTDKA2YT3\";\r\nconst SECRET_ACCESS_KEY = \"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\";\r\n\r\nconst config = {\r\n  bucketName: S3_BUCKET,\r\n  region: REGION,\r\n  accessKeyId: ACCESS_KEY,\r\n  secretAccessKey: SECRET_ACCESS_KEY,\r\n};\r\n\r\nAWS.config.update({\r\n  accessKeyId: \"AKIA24335YBYTDKA2YT3\",\r\n  secretAccessKey: \"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\",\r\n});\r\n\r\n\r\n\r\nconst InputComponent = ({ socketConnected, socket, selectedChat, user }) => {\r\n  \r\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false);\r\n  const [newMessage, setNewMessage] = useState(\"\");\r\n  const [typing, setTyping] = useState(false);\r\n  const toast = useToast();\r\n  const [loading, setLoading] = useState(false); // load, xoay vong vong\r\n\r\n  // const [pic, setPic] = useState();\r\n  const { input, setInput } = ChatState();\r\n  const handleEmojiClick = (event) => {\r\n    let sym = event.unified.split(\"-\");\r\n    let codesArray = [];\r\n    sym.forEach((el) => codesArray.push(\"0x\" + el));\r\n    let emoji = String.fromCodePoint(...codesArray);\r\n    let message = newMessage;\r\n    message += emoji;\r\n    setNewMessage(message);\r\n  };\r\n  //Goi input upload hien ra de chon image\r\n  const uploadImagine = () => {\r\n    const e3 = document.getElementById(\"imagine\");\r\n    // const e4 = refImage.current;\r\n    e3.click();\r\n  };\r\n  //Goi input upload hien ra de chon file\r\n  const deleteImageInInput = () => {\r\n    const e3 = document.getElementById(\"imagine\");\r\n\r\n    e3.value = \"\";\r\n  };\r\n\r\n  //Goi input upload hien ra de chon file\r\n  const deleteFileInInput = () => {\r\n    const e3 = document.getElementById(\"file\");\r\n    // const e4 = refImage.current;\r\n    e3.value = \"\";\r\n  };\r\n  //Goi input upload hien ra de chon image\r\n  const uploadFileLen = () => {\r\n    const e3 = document.getElementById(\"file\");\r\n    // const e4 = refImage.current;\r\n    e3.click();\r\n  };\r\n  // Ham gui tin nhan\r\n  const sendMessage = async (event) => {\r\n    // // param: sự kiện\r\n    if (event.key === \"Enter\" && newMessage) {\r\n      // enter khi có chữ\r\n      socket.emit(\"stop typing\", selectedChat._id);\r\n      setInput(newMessage.trim());\r\n      try {\r\n        const config = {\r\n          headers: {\r\n            \"Content-type\": \"application/json\",\r\n            Authorization: `Bearer ${user.token}`,\r\n          },\r\n        };\r\n        setNewMessage(\"\"); // xóa đi thông tin trong input\r\n        const { data } = await axios.post(\r\n          \"/api/message\",\r\n          {\r\n            content: newMessage.trim(),\r\n            chatId: selectedChat,\r\n          },\r\n          config\r\n        );\r\n        socket.emit(\"new message\", data);\r\n      } catch (error) {\r\n        toast({\r\n          // Toast : 1. toast = useToast -> 2. xài\r\n          title: \"Error Occured!\",\r\n          description: error,\r\n          status: \"error\",\r\n          duration: 5000,\r\n          isClosable: true,\r\n          position: \"bottom\",\r\n        });\r\n      }\r\n    }\r\n  };\r\n  //Ham xu ly typing co animation\r\n  const typingHandler = async (e) => {\r\n    setNewMessage(e.target.value);\r\n\r\n    if (!socketConnected) return;\r\n\r\n    if (!typing) {\r\n      setTyping(true);\r\n      socket.emit(\"typing\", selectedChat._id);\r\n    }\r\n    let lastTypingTime = new Date().getTime();\r\n    var timerLength = 5000;\r\n    setTimeout(() => {\r\n      var timeNow = new Date().getTime();\r\n      var timeDiff = timeNow - lastTypingTime;\r\n      if (timeDiff >= timerLength && typing) {\r\n        socket.emit(\"stop typing\", selectedChat._id);\r\n        setTyping(false);\r\n      }\r\n    }, timerLength);\r\n  };\r\n\r\n  //Hàm xử lý ảnh\r\n  const postDetails = (pics) => {\r\n    setLoading(true);\r\n    if (pics === undefined) {\r\n      toast({\r\n        title: \"Please Select an Image!\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      return;\r\n    }\r\n    // console.log(pics);\r\n    if (pics.type === \"image/jpeg\" || pics.type === \"image/png\") {\r\n      // setTimeout(() => {\r\n      const data = new FormData();\r\n      data.append(\"file\", pics);\r\n      data.append(\"upload_preset\", \"MongoChat04\");\r\n      data.append(\"cloud_name\", \"dfgkg5eej\");\r\n      fetch(\"https://api.cloudinary.com/v1_1/dfgkg5eej/image/upload\", {\r\n        method: \"post\",\r\n        body: data,\r\n      })\r\n        .then((res) => res.json())\r\n        .then((data) => {\r\n          // setPic(data.url.toString());\r\n          console.log(data.url.toString());\r\n          submitHandler(data.url.toString());\r\n          console.log(\"DO DO DO \");\r\n          setLoading(false);\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          setLoading(false);\r\n        });\r\n      // }, 4000);\r\n      console.log(\"CHAY CHAY NHE!!!\");\r\n      // submitHandler();\r\n    } else {\r\n      toast({\r\n        title: \"Please Select an Image!\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n  };\r\n  const submitHandler = async (pic1) => {\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      setNewMessage(\"\"); // xóa đi thông tin trong input\r\n      console.log(\"pic nè bạn ơii@@@@@@: \", pic1);\r\n      const { data } = await axios.post(\r\n        \"/api/message\",\r\n        {\r\n          content: \" image\",\r\n          chatId: selectedChat,\r\n          pic: pic1,\r\n        },\r\n        config\r\n      );\r\n      // console.log(data);\r\n      socket.emit(\"new message\", data);\r\n      deleteImageInInput();\r\n    } catch (error) {\r\n      toast({\r\n        // Toast : 1. toast = useToast -> 2. xài\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to send the Message\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n    }\r\n  };\r\n  const submitHandlerFile = async (e) => {\r\n    setLoading(true);\r\n    const objectFile = e.target.files;\r\n    const checkedFiles = [];\r\n    setLoading(true);\r\n    if (objectFile.length === 0) {\r\n      toast({\r\n        title: \"Please Select an File!\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      deleteFileInInput();\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    // console.log(pics);\r\n    else {\r\n      for (let i = 0; i < objectFile.length; i++) {\r\n        if (objectFile[i].size > 1048576) {\r\n          // console.log(objectFile[i].size);\r\n          toast({\r\n            title: \"Size of File is too big\",\r\n            status: \"warning\",\r\n            duration: 5000,\r\n            isClosable: true,\r\n            position: \"bottom\",\r\n          });\r\n          deleteFileInInput();\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        checkedFiles.push(objectFile[i]);\r\n      }\r\n    }\r\n\r\n    checkedFiles.forEach((file1) => {\r\n      uploadFile(file1, config)\r\n        .then(async (filee) => {\r\n          console.log(\"file: \", filee);\r\n          try {\r\n            const config = {\r\n              headers: {\r\n                \"Content-type\": \"application/json\",\r\n                Authorization: `Bearer ${user.token}`,\r\n              },\r\n            };\r\n            const { data } = await axios.post(\r\n              \"/api/message/file\",\r\n              {\r\n                fileName: filee.key,\r\n                chatId: selectedChat,\r\n                fileURL: filee.location,\r\n              },\r\n              config\r\n            );\r\n            socket.emit(\"new message\", data);\r\n            // deleteImageInInput();\r\n            setLoading(true);\r\n          } catch (error) {\r\n            toast({\r\n              // Toast : 1. toast = useToast -> 2. xài\r\n              title: \"Error Occured!\",\r\n              description: \"Failed to send the Message\",\r\n              status: \"error\",\r\n              duration: 5000,\r\n              isClosable: true,\r\n              position: \"bottom\",\r\n            });\r\n          }\r\n          setLoading(false);\r\n        })\r\n        .catch((err) => {\r\n          console.error(err);\r\n          deleteFileInInput();\r\n          setLoading(false);\r\n        });\r\n    });\r\n    setLoading(false);\r\n  };\r\n\r\n\r\n  const handleEmojiPickerhideShow = () => {\r\n    setShowEmojiPicker(!showEmojiPicker);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/*Input - thanh chat \r\n    onKeyDown: click Enter sẽ send mesage lun \r\n    mt: margin-top */}\r\n      <Grid templateColumns=\"repeat(9, 1fr)\" gap={3}>\r\n        <GridItem w=\"100%\" pt={3} colSpan={1} d=\"flex\">\r\n          <Box className=\"emoji\">\r\n            <IconButton\r\n              className=\"emojiHC\"\r\n              variant=\"outline\"\r\n              colorScheme=\"teal\"\r\n              fontSize=\"20px\"\r\n              size=\"md\"\r\n              icon={<BsFillEmojiSmileFill />}\r\n              onClick={handleEmojiPickerhideShow}\r\n            />\r\n            {showEmojiPicker && (\r\n              <EmojiPicker\r\n                className=\"emojiPickerReactHC\"\r\n                emojiStyle=\"google\"\r\n                onEmojiClick={handleEmojiClick}\r\n              />\r\n            )}\r\n          </Box>\r\n\r\n          <Box className=\"send\">\r\n            <IconButton\r\n              variant=\"outline\"\r\n              colorScheme=\"teal\"\r\n              size=\"md\"\r\n              fontSize=\"20px\"\r\n              icon={<IoImageOutline />}\r\n              onClick={uploadImagine}\r\n            />\r\n\r\n            {/* <img src={Attach} alt=\"\"  /> */}\r\n            <input\r\n              type=\"file\"\r\n              style={{ display: \"none\" }}\r\n              id=\"imagine\"\r\n              accept=\"image/*\"\r\n              onChange={(e) => postDetails(e.target.files[0])}\r\n            />\r\n            {/* </IconButton> */}\r\n          </Box>\r\n          <Box className=\"micro\">\r\n            <IconButton\r\n              size=\"md\"\r\n              variant=\"outline\"\r\n              colorScheme=\"teal\"\r\n              fontSize=\"20px\"\r\n              icon={<BsPaperclip />}\r\n              onClick={uploadFileLen}\r\n            />\r\n\r\n            {/* <img src={Attach} alt=\"\"  /> */}\r\n            <input\r\n              type=\"file\"\r\n              style={{ display: \"none\" }}\r\n              id=\"file\"\r\n              accept=\"file_extension\"\r\n              multiple\r\n              onChange={(e) => submitHandlerFile(e)}\r\n            />\r\n          </Box>\r\n        </GridItem>\r\n        <GridItem\r\n          w=\"100%\"\r\n          colSpan={8}\r\n          className=\"input-container\"\r\n          pt={3}\r\n          d=\"flex\"\r\n        >\r\n          <FormControl\r\n            // className=\"input-container\"\r\n            onKeyDown={sendMessage}\r\n            isRequired\r\n\r\n            // marginBottom={15}\r\n            // p={3}\r\n          >\r\n            <Input\r\n              className=\"col\"\r\n              bg=\"#E0E0E0\"\r\n              placeholder=\"Enter a message..\"\r\n              value={newMessage}\r\n              onChange={typingHandler}\r\n              width=\"98%\"\r\n              size=\"md\"\r\n              // onKeyDown={sendMessage}\r\n              // mr={1}\r\n            />\r\n          </FormControl>\r\n\r\n          <IconButton\r\n            position=\"relative\"\r\n            variant=\"outline\"\r\n            colorScheme=\"teal\"\r\n            fontSize=\"20px\"\r\n            size=\"md\"\r\n            icon={<BsFillArrowRightCircleFill />}\r\n            onClick={submitHandler}\r\n            isLoading={loading}\r\n            mb={1}\r\n          />\r\n        </GridItem>\r\n      </Grid>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default InputComponent;\r\n","import { Box, Text } from \"@chakra-ui/layout\";\r\nimport \"./styles.css\";\r\nimport {\r\n  IconButton,\r\n  Spinner,\r\n  useToast,\r\n  Image,\r\n  Divider,\r\n} from \"@chakra-ui/react\";\r\nimport { getSender, getUserOther, getSenderPic } from \"../config/ChatLogics\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useDisclosure } from \"@chakra-ui/hooks\";\r\nimport axios from \"axios\";\r\nimport { ArrowBackIcon, InfoOutlineIcon, PhoneIcon } from \"@chakra-ui/icons\";\r\nimport ScrollableChat from \"./ScrollableChat\";\r\nimport animationData from \"../animations/typing.json\";\r\nimport Lottie from \"react-lottie\";\r\nimport { BsPersonPlus, BsPersonCheck } from \"react-icons/bs\";\r\nimport ProfileModal from \"./miscellaneous/ProfileModal\";\r\nimport {\r\n  Drawer,\r\n  DrawerBody,\r\n  DrawerContent,\r\n  DrawerHeader,\r\n  DrawerOverlay,\r\n} from \"@chakra-ui/modal\";\r\nimport BoxInformationChat from \"./miscellaneous/BoxInformationGroupMember\";\r\nimport BoxInfoFile from \"./miscellaneous/BoxInfoFile\";\r\n\r\nimport { ChatState } from \"../Context/ChatProvider\";\r\n///////SOCKET///////\r\nimport BoxInfoIamge from \"./miscellaneous/BoxInforImage\";\r\nimport InputComponent from \"./ChatComponent/InputComponent\";\r\n\r\n// const ENDPOINT = \"http://172.16.10.54:5000\"; // socket den\r\nvar selectedChatCompare;\r\n//////SOCKET//////\r\n\r\nconst SingleChat = ({ fetchAgain, setFetchAgain, socket, socketConnected }) => {\r\n  const defaultOptions = {\r\n    loop: true,\r\n    autoplay: true,\r\n    animationData: animationData,\r\n    rendererSettings: {\r\n      preserveAspectRatio: \"xMidYMid slice\",\r\n    },\r\n  };\r\n\r\n  const [messages, setMessages] = useState([]);\r\n  const [loading, setLoading] = useState(false); // load, xoay vong vong\r\n  // const [socketConnected, setSocketConnected] = useState(false);\r\n\r\n  const [pic, setPic] = useState();\r\n  const [istyping, setIsTyping] = useState(false);\r\n  const toast = useToast();\r\n\r\n  const { isOpen, onOpen, onClose } = useDisclosure();\r\n  const [showMakeFriend, setshowMakeFriend] = useState(false);\r\n  const [showAcceptFriend, setshowAcceptFriend] = useState(false);\r\n  const [statusFiend, setStatusFiend] = useState();\r\n  const [contentSendRequest, setcontentSendRequest] = useState(\"\");\r\n  const [disable, setdisable] = useState(false);\r\n\r\n  const history = useHistory();\r\n\r\n  const {\r\n    selectedChat,\r\n    setSelectedChat,\r\n    user,\r\n    setuser,\r\n    notification,\r\n    setNotification,\r\n    setSocket,\r\n    chats,\r\n    setChats,\r\n  } = ChatState();\r\n  const user1 = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n\r\n  const fetchMessages = async () => {\r\n    if (!selectedChat) return;\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n\r\n      setLoading(true);\r\n\r\n      const { data } = await axios.get(\r\n        `/api/message/${selectedChat._id}`,\r\n        config\r\n      );\r\n      setMessages(data);\r\n\r\n      setLoading(false);\r\n\r\n      socket.emit(\"join chat\", selectedChat._id); // join room chat 1 -1\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to Load the Messages\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n    }\r\n  };\r\n\r\n  //Kiem tra xem la no da gui loi moi ket ban chua\r\n  const checkStatusFriend = async (selectedChat) => {\r\n    if (!selectedChat) return;\r\n    if (selectedChat.isGroupChat) {\r\n      setshowAcceptFriend(false);\r\n      setshowMakeFriend(false);\r\n      return;\r\n    }\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      // const { data } = await axios.post(`/api/chat`, { userId }, config);\r\n\r\n      const { data } = await axios.post(\r\n        `/api/friend/getStatusFriend`,\r\n        {\r\n          user: selectedChat.users[0],\r\n          friend: selectedChat.users[1],\r\n        },\r\n        config\r\n      );\r\n      setStatusFiend(data); //////////////////////////////////////////\r\n      if (data.length > 0) {\r\n        if (data[0].status == 1) {\r\n          console.log(\"da gui loi moi: \", data);\r\n          setshowMakeFriend(false);\r\n          setshowAcceptFriend(true);\r\n          if (data[0].user == user._id) {\r\n            setcontentSendRequest(\"Request Sended\");\r\n            setdisable(true);\r\n          } else {\r\n            setcontentSendRequest(\"Accept\");\r\n            setdisable(false);\r\n          }\r\n        } else {\r\n          console.log(\"da la banj roi\", data);\r\n          setshowAcceptFriend(false);\r\n          setshowMakeFriend(false);\r\n        }\r\n      } else {\r\n        console.log(\"chua gui gi ca\");\r\n        setshowMakeFriend(true);\r\n        setshowAcceptFriend(false);\r\n      }\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error fetching the chat\",\r\n        description: error.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  // gui loi moi ket ban ne\r\n  const addFriend = async (selectedChat) => {\r\n    if (!selectedChat) return;\r\n    // if (selectedChat.isGroupChat) return;\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      // const { data } = await axios.post(`/api/chat`, { userId }, config);\r\n\r\n      const { data } = await axios.post(\r\n        `/api/friend/sendRequest`,\r\n        {\r\n          user: user._id,\r\n          friend: getUserOther(user, selectedChat.users)._id,\r\n        },\r\n        config\r\n      );\r\n      if (data.status == 1) {\r\n        checkStatusFriend(selectedChat);\r\n      } else {\r\n        // console.log(\"da ket ban nhe\");\r\n      }\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error fetching the chat\",\r\n        description: error.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const makeFriend = async (selectedChat) => {\r\n    if (!selectedChat) return;\r\n    if (selectedChat.isGroupChat) return;\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      // const { data } = await axios.post(`/api/chat`, { userId }, config);\r\n\r\n      const { data } = await axios.post(\r\n        `/api/friend/makeFriend`,\r\n        {\r\n          user: user._id,\r\n          friend: getUserOther(user, selectedChat.users)._id,\r\n        },\r\n        config\r\n      );\r\n      if (data) {\r\n        console.log(\"dua da ta day:\", data);\r\n        checkStatusFriend(selectedChat);\r\n      }\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error fetching the chat\",\r\n        description: error.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  ///////////SOCKET////////////////////\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on(\"typing\", () => setIsTyping(true));\r\n      socket.on(\"stop typing\", () => setIsTyping(false));\r\n    }\r\n  });\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on(\"recalled mess\", (mess) => {\r\n        if (\r\n          !selectedChatCompare || // if chat is not selected or doesn't match current chat\r\n          selectedChatCompare._id !== mess.chat._id\r\n        ) {\r\n          return;\r\n        } else {\r\n          xuLyRecall(messages, mess);\r\n          setMessages(messages);\r\n        }\r\n      });\r\n    }\r\n  }, [messages]);\r\n\r\n  const xuLyRecall = (messages, data) => {\r\n    messages.forEach((messa) => {\r\n      if (messa._id == data._id) {\r\n        messa.recallMessage = 1;\r\n      }\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user == null) {\r\n      setuser(user1);\r\n      history.push(\"/\");\r\n    }\r\n    // tương tự như AJAX: fetchMessages -> thêm message vào\r\n    fetchMessages();\r\n    checkStatusFriend(selectedChat);\r\n    selectedChatCompare = selectedChat;\r\n    // eslint-disable-next-line\r\n  }, [selectedChat]);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on(\"message recieved\", (newMessageRecieved) => {\r\n        if (\r\n          !selectedChatCompare || // if chat is not selected or doesn't match current chat\r\n          selectedChatCompare._id !== newMessageRecieved.chat._id ||\r\n          selectedChatCompare == undefined\r\n        ) {\r\n          if (!notification.includes(newMessageRecieved)) {\r\n            // set notification\r\n            setNotification([...notification, newMessageRecieved]);\r\n            console.log(\"thong bap\", notification);\r\n            setFetchAgain(!fetchAgain);\r\n          }\r\n        } else {\r\n          setMessages([...messages, newMessageRecieved]);\r\n          selectedChat.latestMessage = newMessageRecieved;\r\n        }\r\n      });\r\n    } else {\r\n      setSelectedChat(chats[chats.length - 1]);\r\n    }\r\n  }, [messages]);\r\n\r\n  const handleMakeFriend = () => {\r\n    addFriend(selectedChat);\r\n    setshowMakeFriend(false);\r\n  };\r\n\r\n  const handleAcceptFriend = () => {\r\n    if (disable) {\r\n      console.log(\"ko dc bam \");\r\n    } else {\r\n      console.log(\"da chap nhan\");\r\n      makeFriend(selectedChat);\r\n    }\r\n  };\r\n  const openNewWindow = () => {\r\n    const params = `scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=300,height=300`;\r\n    window.open(\r\n      \"http://localhost:3002/?id=\" + getUserOther(user, selectedChat.users)._id,\r\n      \"tri\",\r\n      params\r\n    );\r\n    if (socket) {\r\n      socket.emit(\"callXXX\", selectedChat);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Có User chat chưa??? */}\r\n      {selectedChat ? (\r\n        <>\r\n          <Box\r\n            fontSize={{ base: \"28px\", md: \"30px\" }}\r\n            pb={3}\r\n            px={2}\r\n            w=\"100%\"\r\n            fontFamily=\"Work sans\"\r\n            d=\"flex\"\r\n            justifyContent={{ base: \"space-between\" }}\r\n            alignItems=\"center\"\r\n            // background=\"black\"\r\n          >\r\n            <IconButton\r\n              d={{ base: \"flex\", md: \"none\" }}\r\n              icon={<ArrowBackIcon />}\r\n              onClick={() => setSelectedChat(\"\")}\r\n            />\r\n            {!selectedChat.isGroupChat && (\r\n              <Text fontSize=\"25px\" fontWeight=\"bold\">\r\n                {getSender(user, selectedChat.users)}\r\n              </Text>\r\n            )}\r\n            {selectedChat.isGroupChat && (\r\n              <Text fontSize=\"25px\" fontWeight=\"bold\">\r\n                {/* Group chat -> hiện tên nhóm */}\r\n                {selectedChat.chatName.toString()}\r\n              </Text>\r\n            )}\r\n            <Box w=\"100px\" d=\"flex\" justifyContent={{ base: \"space-around\" }}>\r\n              <IconButton\r\n                d={{ base: \"flex\" }}\r\n                icon={<PhoneIcon />}\r\n                onClick={openNewWindow}\r\n              />\r\n              <IconButton\r\n                d={{ base: \"flex\" }}\r\n                icon={<InfoOutlineIcon />}\r\n                onClick={onOpen}\r\n              />\r\n            </Box>\r\n          </Box>\r\n\r\n          <Box\r\n            display=\"flex\"\r\n            flexDir=\"column\"\r\n            justifyContent=\"flex-end\"\r\n            className=\"singleChat\"\r\n            width=\"100%\"\r\n            h=\"100%\"\r\n            borderRadius=\"lg\"\r\n            overflowY=\"hidden\"\r\n            // position=\"absolute\"\r\n          >\r\n            {loading ? (\r\n              // Data load thì sẽ xoay vòng vòng\r\n              <Spinner\r\n                size=\"xl\"\r\n                w={20}\r\n                h={20}\r\n                alignSelf=\"center\"\r\n                margin=\"auto\"\r\n              />\r\n            ) : (\r\n              <Box className=\"messages\">\r\n                {showMakeFriend && (\r\n                  <Box\r\n                    fontSize={{ base: \"100%\", md: \"100\" }}\r\n                    style={{\r\n                      position: \"fixed\",\r\n                      top: 130,\r\n\r\n                      width: \"65.5%\",\r\n                      alignContent: \"center\",\r\n                    }}\r\n                  >\r\n                    <Text\r\n                      display=\"flex\"\r\n                      background=\"#16A085\"\r\n                      w=\"100%\"\r\n                      borderRadius={5}\r\n                      fontSize=\"20px\"\r\n                      color=\"white\"\r\n                      justifyContent={\"center\"}\r\n                      onClick={handleMakeFriend}\r\n                    >\r\n                      <BsPersonPlus />\r\n                      Add Friend\r\n                    </Text>\r\n                  </Box>\r\n                )}\r\n\r\n                {showAcceptFriend && (\r\n                  <Box\r\n                    fontSize={{ base: \"100%\", md: \"100\" }}\r\n                    style={{\r\n                      position: \"fixed\",\r\n\r\n                      width: \"66%\",\r\n                      alignContent: \"center\",\r\n                    }}\r\n                  >\r\n                    <Text\r\n                      borderRadius={5}\r\n                      display=\"flex\"\r\n                      background=\"#16A085\"\r\n                      w=\"100%\"\r\n                      fontSize=\"20px\"\r\n                      color=\"white\"\r\n                      justifyContent={\"center\"}\r\n                      onClick={handleAcceptFriend}\r\n                    >\r\n                      {!disable && <BsPersonCheck />}\r\n                      {contentSendRequest}\r\n                    </Text>\r\n                  </Box>\r\n                )}\r\n                <ScrollableChat\r\n                  messages={messages}\r\n                  socket={socket}\r\n                ></ScrollableChat>\r\n              </Box>\r\n            )}\r\n            {istyping ? (\r\n              <div>\r\n                <Lottie\r\n                  options={defaultOptions}\r\n                  // height={50}\r\n                  width={70}\r\n                  style={{ marginBottom: 15, marginLeft: 0 }}\r\n                />\r\n              </div>\r\n            ) : (\r\n              <></>\r\n            )}\r\n            <InputComponent\r\n              socketConnected={socketConnected}\r\n              socket={socket}\r\n              selectedChat={selectedChat}\r\n              user={user}\r\n            />\r\n          </Box>\r\n\r\n          <Drawer placement=\"right\" onClose={onClose} isOpen={isOpen} size=\"sm\">\r\n            <DrawerOverlay />\r\n            <DrawerContent>\r\n              <DrawerHeader borderBottomWidth=\"1px\">Information</DrawerHeader>\r\n              <DrawerBody background=\"gray.100\">\r\n                <Box\r\n                  background=\"white\"\r\n                  w=\"113%\"\r\n                  ml=\"-25px\"\r\n                  borderRadius={5}\r\n                  mb=\"10px\"\r\n                >\r\n                  {messages &&\r\n                    (!selectedChat.isGroupChat ? (\r\n                      <>\r\n                        <Box align=\"center\" justify=\"center\" pt=\"15px\">\r\n                          <ProfileModal user={getUserOther(user, selectedChat.users)} statusFiend={statusFiend}>\r\n                          <Image\r\n                            \r\n                            borderRadius=\"full\"\r\n                            boxSize=\"50px\"\r\n                            src={getSenderPic(user, selectedChat.users)}\r\n                            alt={user.name}\r\n                          />\r\n                          </ProfileModal>\r\n                          <Text fontSize=\"20px\" fontWeight=\"bold\">\r\n                            {getSender(user, selectedChat.users)}\r\n                          </Text>\r\n                        </Box>\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <Box align=\"center\" justify=\"center\" pt=\"15px\" >\r\n                          <Image\r\n                            // position=\"fixed\"\r\n                            borderRadius=\"full\"\r\n                            boxSize=\"50px\"\r\n                            src={user.pic}\r\n                            // zIndex={0}\r\n                            alt={user.name}\r\n                          />\r\n                          <Text Text fontSize=\"20px\" fontWeight=\"bold\">\r\n                            {/* Group chat -> hiện tên nhóm */}\r\n                            {selectedChat.chatName.toString()}\r\n                          </Text>\r\n                        </Box>\r\n                      </>\r\n                    ))}\r\n                </Box>\r\n                <Box d=\"contents\" pb={2}>\r\n                  {messages &&\r\n                    (!selectedChat.isGroupChat ? (\r\n                      <>\r\n                        {/* {getSender(user, selectedChat.users)}\r\n                <ProfileModal\r\n                  user={getSenderFull(user, selectedChat.users)}\r\n                /> */}\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        {/* Group chat -> hiện tên nhóm */}\r\n                        {/* {selectedChat.chatName.toString()} */}\r\n                        <BoxInformationChat\r\n                          w=\"100%\"\r\n                          fetchMessages={fetchMessages}\r\n                          fetchAgain={fetchAgain}\r\n                          setFetchAgain={setFetchAgain}\r\n                        />\r\n                      </>\r\n                    ))}\r\n                </Box>\r\n                <Box mt=\"10px\">\r\n                  <BoxInfoIamge />\r\n                </Box>\r\n                <Box mt=\"10px\">\r\n                  <BoxInfoFile />\r\n                </Box>\r\n              </DrawerBody>\r\n            </DrawerContent>\r\n          </Drawer>\r\n        </>\r\n      ) : (\r\n        // to get socket.io on same page\r\n        <Box d=\"flex\" alignItems=\"center\" justifyContent=\"center\" h=\"100%\">\r\n          <Text fontSize=\"3xl\" pb={3} fontFamily=\"Work sans\">\r\n            Click on user to start chatting...\r\n          </Text>\r\n        </Box>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SingleChat;\r\n","import { Box } from \"@chakra-ui/layout\";\r\nimport \"./styles.css\";\r\nimport SingleChat from \"./SingleChat\";\r\nimport { ChatState } from \"../Context/ChatProvider\";\r\n\r\nconst Chatbox = ({ fetchAgain, setFetchAgain, socket, socketConnected }) => {\r\n  const { selectedChat } = ChatState();\r\n\r\n  return (\r\n    <Box\r\n      // Boostrap, mất nếu thu nhỏ\r\n      d={{ base: selectedChat ? \"flex\" : \"none\", md: \"flex\" }}\r\n      alignItems=\"center\"\r\n      flexDir=\"column\"\r\n      p={3}\r\n      bg=\"white\"\r\n      w={{ base: \"100%\", md: \"68%\" }}\r\n      borderRadius=\"lg\"\r\n      borderWidth=\"1px\"\r\n    >\r\n      <SingleChat \r\n      fetchAgain={fetchAgain} \r\n      setFetchAgain={setFetchAgain} \r\n      socket={socket}\r\n      socketConnected={socketConnected}\r\n      />\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Chatbox;\r\n","import { Stack } from \"@chakra-ui/layout\";\r\nimport { Skeleton } from \"@chakra-ui/skeleton\";\r\n\r\nconst ChatLoading = () => {\r\n  return (\r\n    <Stack>\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n      <Skeleton height=\"45px\" />\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport default ChatLoading;\r\n","import {\r\n  Modal,\r\n  ModalOverlay,\r\n  ModalContent,\r\n  ModalHeader,\r\n  ModalFooter,\r\n  ModalBody,\r\n  ModalCloseButton,\r\n  Button,\r\n  useDisclosure,\r\n  FormControl,\r\n  Input,\r\n  useToast,\r\n  Box,\r\n} from \"@chakra-ui/react\";\r\nimport axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\nimport UserBadgeItem from \"../userAvatar/UserBadgeItem\";\r\nimport UserListItem from \"../userAvatar/UserListItem\";\r\n\r\nconst GroupChatModal = ({ children }) => {\r\n  const { isOpen, onOpen, onClose } = useDisclosure();\r\n  const [groupChatName, setGroupChatName] = useState();\r\n  const [selectedUsers, setSelectedUsers] = useState([]);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [searchResult, setSearchResult] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const toast = useToast();\r\n\r\n  const { user, chats, setChats } = ChatState();\r\n\r\n  const handleGroup = (userToAdd) => {\r\n    if (selectedUsers.includes(userToAdd)) {\r\n      toast({\r\n        title: \"User already added\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"top\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setSelectedUsers([...selectedUsers, userToAdd]);\r\n\r\n  };\r\n\r\n  const handleSearch = async (query) => {\r\n    setSearch(query);\r\n    if (!query) {\r\n      return;\r\n    }\r\n    try {\r\n      setLoading(true);\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.get(`/api/user?search=${query}`, config);\r\n      \r\n      setLoading(false);\r\n      \r\n      setSearchResult(data);\r\n\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to Load the Search Results\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDelete = (delUser) => {\r\n    setSelectedUsers(selectedUsers.filter((sel) => sel._id !== delUser._id));\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!groupChatName || !selectedUsers) {\r\n      toast({\r\n        title: \"Please fill all the fields\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"top\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.post(\r\n        `/api/chat/group`,\r\n        {\r\n          name: groupChatName,\r\n          users: JSON.stringify(selectedUsers.map((u) => u._id)),\r\n        },\r\n        config\r\n      );\r\n      setChats([data, ...chats]);\r\n      onClose();\r\n      toast({\r\n        title: \"New Group Chat Created!\",\r\n        status: \"success\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Failed to Create the Chat!\",\r\n        description: error.response.data,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n    }\r\n    setSelectedUsers([]);\r\n    setSearchResult([]);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <span onClick={onOpen}>{children}</span>\r\n\r\n      <Modal onClose={onClose} isOpen={isOpen} isCentered>\r\n        <ModalOverlay />\r\n        <ModalContent>\r\n          <ModalHeader\r\n            fontSize=\"35px\"\r\n            fontFamily=\"Work sans\"\r\n            d=\"flex\"\r\n            justifyContent=\"center\"\r\n          >\r\n            Create Group Chat\r\n          </ModalHeader>\r\n          <ModalCloseButton />\r\n          <ModalBody d=\"flex\" flexDir=\"column\" alignItems=\"center\">\r\n            <FormControl>\r\n              <Input\r\n                placeholder=\"Chat Name\"\r\n                mb={3}\r\n                onChange={(e) => setGroupChatName(e.target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl>\r\n              <Input\r\n                placeholder=\"Add Users\"\r\n                mb={1}\r\n                onChange={(e) => handleSearch(e.target.value)}\r\n              />\r\n            </FormControl>\r\n            <Box w=\"100%\" d=\"flex\" flexWrap=\"wrap\">\r\n              {selectedUsers.map((u) => (\r\n                <UserBadgeItem\r\n                  key={u._id}\r\n                  user={u}\r\n                  handleFunction={() => handleDelete(u)}\r\n                />\r\n              ))}\r\n            </Box>\r\n            {loading ? (\r\n              // <ChatLoading />\r\n              <div>Loading...</div>\r\n            ) : (\r\n              searchResult\r\n                ?.slice(0, 4)\r\n                .map((user) => (\r\n                  <UserListItem\r\n                    key={user._id}\r\n                    user={user}\r\n                    handleFunction={() => handleGroup(user)}\r\n                  />\r\n                ))\r\n            )}\r\n          </ModalBody>\r\n          <ModalFooter>\r\n            <Button onClick={handleSubmit} colorScheme=\"blue\">\r\n              Create Chat\r\n            </Button>\r\n          </ModalFooter>\r\n        </ModalContent>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default GroupChatModal;\r\n","import { AddIcon } from \"@chakra-ui/icons\";\r\nimport { Box, Stack, Text } from \"@chakra-ui/layout\";\r\nimport { useToast } from \"@chakra-ui/toast\";\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { getSender, getSenderPic, getSenderYou } from \"../config/ChatLogics\";\r\nimport ChatLoading from \"./ChatLoading\";\r\nimport GroupChatModal from \"./miscellaneous/GroupChatModal\";\r\nimport { Button } from \"@chakra-ui/react\";\r\nimport { ChatState } from \"../Context/ChatProvider\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { Avatar } from \"@chakra-ui/avatar\";\r\n\r\nconst MyChats = ({ fetchAgain, socket }) => {\r\n  const { user, setuser, selectedChat, setSelectedChat, chats, setChats } =\r\n    ChatState();\r\n  const loggedUser = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n\r\n  const [chat1, setchat1] = useState([]);\r\n\r\n  const toast = useToast();\r\n\r\n  const history = useHistory();\r\n\r\n  // const [plat, setplat] = useState(true);\r\n\r\n  const handleTimeSend = (timeSend) => {\r\n    const date = new Date(timeSend);\r\n\r\n    return date.toLocaleString(\"en-US\", {\r\n      hour12: false,\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  };\r\n\r\n  // console.log(\"log\", loggedUser);\r\n  useEffect(() => {\r\n    setuser(loggedUser);\r\n    if (loggedUser == null) {\r\n      history.push(\"/\");\r\n    }\r\n    fetchChats();\r\n  }, [fetchAgain]);\r\n\r\n  const fetchChats = async () => {\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${loggedUser.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.get(\"/api/chat\", config);\r\n\r\n      setChats(data);\r\n      console.log(\"tin nhan\", data);\r\n    } catch (error) {\r\n      console.log(error);\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to Load the chats (MY CHAT)\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n  const handleLastMessage = (lastestMessage) => {\r\n    if (lastestMessage.recallMessage) {\r\n      return \"Message Recall\";\r\n    }\r\n    return lastestMessage.content;\r\n  };\r\n\r\n  const xuLyChats = (chatsX, newMessageRecieved) => {\r\n    chatsX.forEach((chat) => {\r\n      if (chat._id == newMessageRecieved.chat._id) {\r\n        // chat.users.forEach((user1) => {\r\n        // if (user1._id == newMessageRecieved.sender._id) {\r\n        chat.latestMessage = newMessageRecieved;\r\n        setchat1(newMessageRecieved);\r\n        // }\r\n        // });\r\n      }\r\n    });\r\n  };\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on(\"message recieved\", (newMessageRecieved) => {\r\n        // console.log(\"on: \", socket);\r\n        xuLyChats(chats, newMessageRecieved);\r\n        setChats((prevState) => (prevState = chats));\r\n\r\n        // console.log(\"ham: \", chats);\r\n        // setplat(false);\r\n      });\r\n    }\r\n  }, [selectedChat || chats || chat1]);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on(\"recalled mess\", (mess) => {\r\n        // console.log(\"phong chat ben my chat\", selectedChat);\r\n        if (\r\n          !selectedChat || // if chat is not selected or doesn't match current chat\r\n          selectedChat._id !== mess.chat._id\r\n        ) {\r\n          console.log(\"my chat ko dung\");\r\n          return;\r\n        } else {\r\n          xuLyChats(chats, mess);\r\n        }\r\n      });\r\n    }\r\n  }, [selectedChat || chats || chat1]);\r\n\r\n  const handleBackgroup = (chat) => {\r\n    if (selectedChat) {\r\n      if (selectedChat._id === chat._id) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        d={{ base: selectedChat ? \"none\" : \"flex\", md: \"flex\" }}\r\n        flexDir=\"column\"\r\n        alignItems=\"center\"\r\n        p={3}\r\n        bg=\"white\"\r\n        w={{ base: \"100%\", md: \"31%\" }}\r\n        borderRadius=\"lg\"\r\n        borderWidth=\"1px\"\r\n      >\r\n        <Box\r\n          pb={3}\r\n          px={3}\r\n          fontSize={{ base: \"28px\", md: \"30px\" }}\r\n          fontFamily=\"Work sans\"\r\n          d=\"flex\"\r\n          w=\"100%\"\r\n          justifyContent=\"space-between\"\r\n          alignItems=\"center\"\r\n        >\r\n          My Chats\r\n          <GroupChatModal>\r\n            <Button\r\n              d=\"flex\"\r\n              fontSize={{ base: \"17px\", md: \"10px\", lg: \"17px\" }}\r\n              rightIcon={<AddIcon />}\r\n            >\r\n              New Group Chat\r\n            </Button>\r\n          </GroupChatModal>\r\n        </Box>\r\n        <Box\r\n          d=\"flex\"\r\n          flexDir=\"column\"\r\n          p={3}\r\n          bg=\"#F8F8F8\"\r\n          w=\"100%\"\r\n          h=\"100%\"\r\n          borderRadius=\"lg\"\r\n          overflowY=\"hidden\"\r\n        >\r\n          {chats ? (\r\n            <Stack overflowY=\"scroll\">\r\n              {chats.map((chat) => (\r\n                <Box\r\n                  onClick={() => setSelectedChat(chat)}\r\n                  cursor=\"pointer\"\r\n                  bg={handleBackgroup(chat) ? \"#ABEBC6\" : \"white\"}\r\n                  color={handleBackgroup(chat) ? \"white\" : \"black\"}\r\n                  px={3}\r\n                  py={2}\r\n                  display=\"flex\"\r\n                  borderRadius=\"lg\"\r\n                  key={chat._id}\r\n                >\r\n                  <Avatar\r\n                    mt={3}\r\n                    mr={2}\r\n                    size=\"sm\"\r\n                    cursor=\"pointer\"\r\n                    src={\r\n                      chat.isGroupChat == true\r\n                        ? chat.pic\r\n                        : // \"https://cdn-icons-png.flaticon.com/64/1911/1911087.png\"\r\n                          getSenderPic(loggedUser, chat.users)\r\n                    }\r\n                  />\r\n                  <Box width=\"100%\">\r\n                    <Box justifyContent=\"space-between\" d=\"flex\">\r\n                      <Text\r\n                        fontSize=\"lg\"\r\n                        fontWeight=\"400\"\r\n                        color=\"black\"\r\n                        d=\"flex\"\r\n                        alignContent=\"end\"\r\n                      >\r\n                        {!chat.isGroupChat\r\n                          ? getSender(loggedUser, chat.users)\r\n                          : chat.chatName}\r\n                      </Text>\r\n                      {chat.latestMessage && (\r\n                        <Text color=\"gray.500\">\r\n                          {handleTimeSend(chat.latestMessage.createdAt)}\r\n                        </Text>\r\n                      )}\r\n                    </Box>\r\n\r\n                    {chat.latestMessage && (\r\n                      <>\r\n                        <Text fontSize=\"md\" color=\"gray.500\">\r\n                          {chat.latestMessage.sender.name === loggedUser.name\r\n                            ? \"You\"\r\n                            : chat.latestMessage.sender.name}\r\n                          :{\" \"}\r\n                          {chat.latestMessage.content.length > 50\r\n                            ? chat.latestMessage.content.substring(0, 51) +\r\n                              \"...\"\r\n                            : handleLastMessage(chat.latestMessage)}\r\n                        </Text>\r\n                      </>\r\n                    )}\r\n\r\n                    {/* {chat.latestMessage.recallMessage && (\r\n                      <>\r\n                        <Text fontSize=\"md\" color=\"gray.500\">\r\n                          {chat.latestMessage.sender.name === loggedUser.name\r\n                            ? \"You\"\r\n                            : chat.latestMessage.sender.name}\r\n                          : Message Recall\r\n                        </Text>\r\n                      </>\r\n                    )} */}\r\n                  </Box>\r\n                </Box>\r\n              ))}\r\n            </Stack>\r\n          ) : (\r\n            <ChatLoading />\r\n          )}\r\n        </Box>\r\n      </Box>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MyChats;\r\n","import { Avatar } from \"@chakra-ui/avatar\";\r\nimport { Box, Text } from \"@chakra-ui/layout\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\n\r\nconst GroupListItem = ({ chat, handleFunction }) => {\r\n  return (\r\n    <Box\r\n      onClick={handleFunction}\r\n      cursor=\"pointer\"\r\n      bg=\"#E8E8E8\"\r\n      _hover={{\r\n        background: \"#38B2AC\",\r\n        color: \"white\",\r\n      }}\r\n      w=\"100%\"\r\n      d=\"flex\"\r\n      alignItems=\"center\"\r\n      color=\"black\"\r\n      px={3}\r\n      py={2}\r\n      mb={2}\r\n      borderRadius=\"lg\"\r\n    >\r\n      <Avatar\r\n        mr={2}\r\n        size=\"sm\"\r\n        cursor=\"pointer\"\r\n        // name={chat.name}\r\n        src={chat.pic}\r\n      />\r\n      <Box>\r\n        <Text>{chat.chatName}</Text>\r\n        \r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default GroupListItem;\r\n","import { InfoOutlineIcon } from \"@chakra-ui/icons\";\r\nimport {\r\n  Modal,\r\n  ModalOverlay,\r\n  ModalContent,\r\n  ModalHeader,\r\n  ModalFooter,\r\n  ModalBody,\r\n  ModalCloseButton,\r\n  Button,\r\n  useDisclosure,\r\n  IconButton,\r\n  Avatar,\r\n} from \"@chakra-ui/react\";\r\nimport { Stack } from \"@chakra-ui/layout\";\r\nimport { Input } from \"@chakra-ui/input\";\r\nimport { useState } from \"react\";\r\nimport { useToast } from \"@chakra-ui/toast\";\r\nimport axios from \"axios\";\r\nimport { FormControl, FormLabel } from \"@chakra-ui/form-control\";\r\nimport { Radio, RadioGroup } from \"@chakra-ui/react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n// import ChatLoading from \"../ChatLoading\";\r\n\r\nconst UpdateProfileModal = ({ user, children }) => {\r\n  const { isOpen, onOpen, onClose } = useDisclosure();\r\n  const [userId, setUserId] = useState(user._id);\r\n  const [name, setName] = useState(user.name);\r\n  const [pic, setPic] = useState(user.pic);\r\n  const [birth, setBirth] = useState(user.birth);\r\n  const [sex, setsex] = useState(user.sex.toString());\r\n  const toast = useToast();\r\n  const [loading, setLoading] = useState(false);\r\n  const [token, settoken] = useState(user.token);\r\n  const history = useHistory();\r\n\r\n  const handleTimeSend = () => {\r\n    const x = new Date(birth);\r\n    const month =\r\n      x.getMonth() + 1 < 10 ? \"0\" + (x.getMonth() + 1) : x.getMonth() + 1;\r\n    const date = x.getDate() < 10 ? \"0\" + x.getDate() : x.getDate();\r\n    const a = x.getFullYear() + \"-\" + month + \"-\" + date;\r\n    return a;\r\n  };\r\n\r\n  const deleteImageInInput = () => {\r\n    const e3 = document.getElementById(\"avartar\");\r\n\r\n    e3.value = \"\";\r\n  };\r\n\r\n  const postDetails = (pics) => {\r\n    console.log(\"tam hinh\", pics);\r\n    setLoading(true);\r\n    if (pics === undefined) {\r\n      toast({\r\n        title: \"Please Select an Image!\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    if (pics.type === \"image/jpeg\" || pics.type === \"image/png\") {\r\n      // setTimeout(() => {\r\n      const data = new FormData();\r\n      data.append(\"file\", pics);\r\n      data.append(\"upload_preset\", \"MongoChat04\");\r\n      data.append(\"cloud_name\", \"dfgkg5eej\");\r\n      fetch(\"https://api.cloudinary.com/v1_1/dfgkg5eej/image/upload\", {\r\n        method: \"post\",\r\n        body: data,\r\n      })\r\n        .then((res) => res.json())\r\n        .then((data) => {\r\n          // setPic(data.url.toString());\r\n          // console.log(data.url.toString());\r\n          setPic(data.url.toString());\r\n\r\n          setLoading(false);\r\n          deleteImageInInput();\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          setLoading(false);\r\n        });\r\n      // }, 4000);\r\n      console.log(\"CHAY CHAY NHE!!!\");\r\n      // submitHandler();\r\n    } else {\r\n      toast({\r\n        title: \"Please Select an Image!\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      deleteImageInInput();\r\n      setLoading(false);\r\n      return;\r\n    }\r\n  };\r\n\r\n  const uploadImagine = () => {\r\n    const e3 = document.getElementById(\"avartar\");\r\n    // const e4 = refImage.current;\r\n    e3.click();\r\n  };\r\n\r\n  const updateProfile = async () => {\r\n    setLoading(true);\r\n\r\n    var DatePresent = new Date().getFullYear();\r\n    var birhtUser = new Date(birth).getFullYear();\r\n    if (name.length <= 0) {\r\n      toast({\r\n        title: \"Please Enter your name \",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    // console.log(DatePresent - birhtUser);\r\n    if (DatePresent - birhtUser < 0) {\r\n      toast({\r\n        title: \"Age > 0\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // console.log(\"sex\", sex);\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.post(\r\n        \"/api/user/updateProfile\",\r\n        {\r\n          userId,\r\n          name,\r\n          sex,\r\n          birth,\r\n          pic,\r\n        },\r\n        config\r\n      );\r\n      localStorage.removeItem(\"userInfo\");\r\n      data.token = token;\r\n      localStorage.setItem(\"userInfo\", JSON.stringify(data));\r\n      setTimeout(() => {\r\n\r\n        history.push(\"/\");\r\n      }, 1000);\r\n      toast({\r\n        title: \"Update Success\",\r\n        status: \"success\",\r\n        duration: 7000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n      onClose();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error.response.data.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom\",\r\n      });\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {children ? (\r\n        <span onClick={onOpen}>{children}</span>\r\n      ) : (\r\n        <IconButton\r\n          d={{ base: \"flex\" }}\r\n          icon={<InfoOutlineIcon />}\r\n          onClick={onOpen}\r\n        />\r\n      )}\r\n      <Modal\r\n        // scrollBehavior={scrollBehavior}\r\n        size=\"lg\"\r\n        onClose={() => {\r\n          onClose();\r\n          setPic(user.pic);\r\n          setName(user.name);\r\n          setBirth(user.birth);\r\n          deleteImageInInput();\r\n        }}\r\n        isOpen={isOpen}\r\n        // isCentered\r\n        // height=\"1300px\"\r\n        // styleConfig={{outerHeight:\"5000px\"}}\r\n      >\r\n        <ModalOverlay />\r\n        <ModalContent h=\"410px\">\r\n          <ModalHeader\r\n            fontSize=\"40px\"\r\n            fontFamily=\"Work sans\"\r\n            d=\"flex\"\r\n            justifyContent=\"center\"\r\n          ></ModalHeader>\r\n          <ModalCloseButton />\r\n          <ModalBody\r\n            d=\"flex\"\r\n            flexDir=\"column\"\r\n            alignItems=\"center\"\r\n            justifyContent=\"space-between\"\r\n          >\r\n            <Avatar\r\n              borderRadius=\"full\"\r\n              boxSize=\"100px\"\r\n              src={pic}\r\n              // alt={user.name}\r\n              // id=\"avartar\"\r\n              onClick={uploadImagine}\r\n            />\r\n            <input\r\n              type=\"file\"\r\n              style={{ display: \"none\" }}\r\n              id=\"avartar\"\r\n              accept=\"image/*\"\r\n              onChange={(e) => postDetails(e.target.files[0])}\r\n            />\r\n\r\n            <FormControl id=\"first-name\" isRequired>\r\n              <FormLabel>Name</FormLabel>\r\n              <Input\r\n                placeholder=\"Enter Your Name\"\r\n                value={name}\r\n                onChange={(e) => setName(e.target.value)}\r\n              />\r\n            </FormControl>\r\n\r\n            <FormControl id=\"birthday\" isRequired>\r\n              <FormLabel>Birthday</FormLabel>\r\n              <Input\r\n                type=\"date\"\r\n                value={handleTimeSend()}\r\n                // placeholder={handleTimeSend(user.birth)}\r\n                onChange={(e) => {\r\n                  // console.log(e.target.value);\r\n                  setBirth(e.target.value);\r\n                }}\r\n              />\r\n            </FormControl>\r\n            <FormControl id=\"sex\" isRequired>\r\n              <FormLabel>Sex</FormLabel>\r\n              <RadioGroup value={sex} onChange={setsex}>\r\n                <Stack direction=\"row\">\r\n                  <Radio colorScheme=\"green\" value=\"1\">\r\n                    Male\r\n                  </Radio>\r\n                  <Radio colorScheme=\"green\" value=\"2\">\r\n                    Female\r\n                  </Radio>\r\n                  <Radio colorScheme=\"green\" value=\"3\">\r\n                    Other\r\n                  </Radio>\r\n                </Stack>\r\n              </RadioGroup>\r\n            </FormControl>\r\n          </ModalBody>\r\n          <ModalFooter>\r\n            <Button\r\n              isLoading={loading}\r\n              onClick={() => {\r\n                onClose();\r\n                setPic(user.pic);\r\n                setName(user.name);\r\n                setBirth(user.birth);\r\n                deleteImageInInput();\r\n              }}\r\n              mr={3}\r\n            >\r\n              Close\r\n            </Button>\r\n            <Button\r\n              isLoading={loading}\r\n              onClick={updateProfile}\r\n              colorScheme=\"green\"\r\n            >\r\n              Update\r\n            </Button>\r\n          </ModalFooter>\r\n        </ModalContent>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default UpdateProfileModal;\r\n","import { Button } from \"@chakra-ui/button\";\r\nimport { useDisclosure } from \"@chakra-ui/hooks\";\r\nimport { Input } from \"@chakra-ui/input\";\r\nimport { Box, Text } from \"@chakra-ui/layout\";\r\nimport {\r\n  Menu,\r\n  MenuButton,\r\n  MenuDivider,\r\n  MenuItem,\r\n  MenuList,\r\n} from \"@chakra-ui/menu\";\r\nimport { IoHome } from \"react-icons/io5\";\r\nimport { FaUserFriends } from \"react-icons/fa\";\r\nimport { TiGroup } from \"react-icons/ti\";\r\nimport { MdOutlineLiveTv } from \"react-icons/md\";\r\nimport {\r\n  Accordion,\r\n  AccordionItem,\r\n  AccordionButton,\r\n  AccordionPanel,\r\n  IconButton,\r\n  AccordionIcon,\r\n} from \"@chakra-ui/react\";\r\nimport {\r\n  Drawer,\r\n  DrawerBody,\r\n  DrawerContent,\r\n  DrawerHeader,\r\n  DrawerOverlay,\r\n} from \"@chakra-ui/modal\";\r\nimport { Tooltip } from \"@chakra-ui/tooltip\";\r\nimport { BellIcon, ChevronDownIcon, Search2Icon } from \"@chakra-ui/icons\";\r\nimport { Avatar } from \"@chakra-ui/avatar\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useToast } from \"@chakra-ui/toast\";\r\nimport ChatLoading from \"../ChatLoading\";\r\nimport { Spinner } from \"@chakra-ui/spinner\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport NotificationBadge from \"react-notification-badge\";\r\nimport { Effect } from \"react-notification-badge\";\r\nimport { getSender } from \"../../config/ChatLogics\";\r\nimport UserListItem from \"../userAvatar/UserListItem\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\nimport GroupListItem from \"../userAvatar/GroupListItem\";\r\nimport UpdateProfileModal from \"./UpdateProfileModal\";\r\n\r\nfunction SideDrawer() {\r\n  const [search, setSearch] = useState(\"\");\r\n  const [searchResult, setSearchResult] = useState([]);\r\n  const [searchResultGroup, setsearchResultGroup] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingChat, setLoadingChat] = useState(false);\r\n\r\n  const {\r\n    setSelectedChat,\r\n    setuser,\r\n    notification,\r\n    setNotification,\r\n    chats,\r\n    selectedFriend,\r\n    setselectedFriend,\r\n    setChats,\r\n    input,\r\n  } = ChatState();\r\n  useEffect(() => {\r\n    // console.log(\"MY CHAT: \", input);\r\n  }, [input]);\r\n  const user = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n  const history = useHistory();\r\n  useEffect(() => {\r\n    if (user == null) {\r\n      history.push(\"/\");\r\n    }\r\n  }, [history]);\r\n\r\n  const toast = useToast();\r\n  const { isOpen, onOpen, onClose } = useDisclosure();\r\n\r\n  const logoutHandler = () => {\r\n    setuser(null);\r\n    localStorage.removeItem(\"userInfo\");\r\n    setSelectedChat(null);\r\n    history.push(\"/\");\r\n  };\r\n\r\n  const handleSearch = async () => {\r\n    setSearchResult([]);\r\n    if (!search) {\r\n      toast({\r\n        title: \"Please Enter something in search\",\r\n        status: \"warning\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"top-left\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n\r\n      const { data } = await axios.get(\r\n        `/api/friend/findUserFriend?search=${search}&userId=${user._id}`,\r\n        config\r\n      );\r\n      if (data.length > 0) {\r\n        // console.log(\"BAN\", data);\r\n        setSearchResult(data);\r\n        setLoading(false);\r\n      }\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n    try {\r\n      setLoading(true);\r\n\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n\r\n      const { data } = await axios.get(`/api/user?search=${search}`, config);\r\n      if (data.length > 0) {\r\n        setSearchResult(data);\r\n        console.log(\"in ra ne\");\r\n      }\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to Load the Search Results\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n\r\n      const { data } = await axios.get(\r\n        `/api/chat/searchGroupChat?id=${user._id}&chatName=${search}`,\r\n        config\r\n      );\r\n      setLoading(false);\r\n      setsearchResultGroup(data);\r\n      console.log(\"toi\");\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: error,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const accessChat = async (userId) => {\r\n    try {\r\n      setLoadingChat(true);\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      // const { data } = await axios.post(`/api/chat`, { userId }, config);\r\n      const { data } = await axios.post(`/api/chat`, { userId }, config);\r\n      if (!chats.find((c) => c._id === data._id)) setChats([data, ...chats]);\r\n      setSelectedChat(data);\r\n      setLoadingChat(false);\r\n      onClose();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error fetching the chat\",\r\n        description: error.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        d=\"flex\"\r\n        justifyContent=\"space-between\"\r\n        alignItems=\"center\"\r\n        bg=\"#117A65\"\r\n        w=\"100%\"\r\n        p=\"5px 10px 5px 10px\"\r\n      >\r\n        <Tooltip label=\"Search Users to chat\" hasArrow placement=\"bottom-end\">\r\n          <Button\r\n            _hover={{ background: \"gray.400\" }}\r\n            leftIcon={<Search2Icon color=\"white\" />}\r\n            variant=\"ghost\"\r\n            onClick={onOpen}\r\n          >\r\n            <Text d={{ base: \"none\", md: \"flex\" }} color=\"white\" px={4}>\r\n              Search User\r\n            </Text>\r\n          </Button>\r\n        </Tooltip>\r\n        <Box w=\"450px\" d=\"flex\" justifyContent=\"space-between\">\r\n          <IconButton\r\n            variant=\"ghost\"\r\n            fontSize=\"35px\"\r\n            size=\"lg\"\r\n            _hover={{ background: \"#16A085\" }}\r\n            onClick={() => {\r\n              history.push(\"/chats\");\r\n              setselectedFriend(false);\r\n            }}\r\n            style={{\r\n              background: `${selectedFriend === false ? \"#16A085\" : \"117A65\"}`,\r\n            }}\r\n            icon={<IoHome color=\"white\" />}\r\n          />\r\n          <IconButton\r\n            variant=\"ghost\"\r\n            fontSize=\"35px\"\r\n            size=\"lg\"\r\n            _hover={{ background: \"#16A085\" }}\r\n            onClick={() => {\r\n              history.push(\"/friend\");\r\n              setselectedFriend(true);\r\n              // console.log(selectedFriend);\r\n            }}\r\n            style={{\r\n              background: `${selectedFriend === true ? \"#16A085\" : \"117A65\"}`,\r\n            }}\r\n            icon={<FaUserFriends color=\"white\" />}\r\n          />\r\n          <IconButton\r\n            variant=\"ghost\"\r\n            fontSize=\"35px\"\r\n            size=\"lg\"\r\n            _hover={{ background: \"gray.400\" }}\r\n            icon={<TiGroup color=\"white\" />}\r\n          />\r\n\r\n          <IconButton\r\n            variant=\"ghost\"\r\n            fontSize=\"35px\"\r\n            size=\"lg\"\r\n            _hover={{ background: \"gray.400\" }}\r\n            icon={<MdOutlineLiveTv color=\"white\" />}\r\n          />\r\n        </Box>\r\n        <div>\r\n          <Menu>\r\n            <MenuButton p={1}>\r\n              <NotificationBadge\r\n                count={notification.length}\r\n                effect={Effect.SCALE}\r\n              />\r\n              <BellIcon fontSize=\"2xl\" m={1} color=\"white\" />\r\n            </MenuButton>\r\n            <MenuList pl={2}>\r\n              {!notification.length && \"No New Messages\"}\r\n              {notification.map((notif) => (\r\n                <MenuItem\r\n                  key={notif._id}\r\n                  onClick={() => {\r\n                    setSelectedChat(notif.chat);\r\n                    setNotification(notification.filter((n) => n !== notif));\r\n                  }}\r\n                >\r\n                  {notif.chat.isGroupChat\r\n                    ? `New Message in ${notif.chat.chatName}`\r\n                    : `New Message from ${getSender(user, notif.chat.users)}`}\r\n                </MenuItem>\r\n              ))}\r\n            </MenuList>\r\n          </Menu>\r\n\r\n          <Menu>\r\n            <MenuButton as={Button} bg=\"white\" rightIcon={<ChevronDownIcon />}>\r\n              <Avatar\r\n                size=\"sm\"\r\n                cursor=\"pointer\"\r\n                name={user.name}\r\n                src={user.pic}\r\n              />\r\n            </MenuButton>\r\n            <MenuList\r\n              style={{\r\n                right: -80,\r\n                top: -9,\r\n                zIndex: 1,\r\n                position: \"absolute\",\r\n              }}\r\n            >\r\n              <ProfileModal user={user}>\r\n                <MenuItem>My Profile</MenuItem>{\" \"}\r\n              </ProfileModal>\r\n              <UpdateProfileModal user={user}>\r\n                <MenuItem>Update my profile</MenuItem>\r\n              </UpdateProfileModal>\r\n              <MenuDivider />\r\n              <MenuItem onClick={logoutHandler}>Logout</MenuItem>\r\n            </MenuList>\r\n          </Menu>\r\n        </div>\r\n      </Box>\r\n      <Drawer placement=\"left\" onClose={onClose} isOpen={isOpen}>\r\n        <DrawerOverlay />\r\n        <DrawerContent>\r\n          <DrawerHeader borderBottomWidth=\"1px\">Search Users</DrawerHeader>\r\n          <DrawerBody>\r\n            <Box d=\"flex\" pb={2}>\r\n              <Input\r\n                placeholder=\"Search by name or email\"\r\n                mr={2}\r\n                value={search}\r\n                onChange={(e) => setSearch(e.target.value)}\r\n              />\r\n              <Button onClick={handleSearch}>Go</Button>\r\n            </Box>\r\n            {loading ? (\r\n              <ChatLoading />\r\n            ) : (\r\n              <Accordion defaultIndex={[0]} allowMultiple>\r\n                {searchResult.length > 0 && (\r\n                  <AccordionItem>\r\n                    <AccordionButton>\r\n                      <Box flex=\"1\" textAlign=\"left\" fontWeight=\"bold\">\r\n                        Individual ({searchResult.length})\r\n                      </Box>\r\n                      <AccordionIcon />\r\n                    </AccordionButton>\r\n                    <AccordionPanel pb={4}>\r\n                      {searchResult?.map((user) => (\r\n                        <UserListItem\r\n                          key={user._id}\r\n                          user={user}\r\n                          handleFunction={() => accessChat(user._id)}\r\n                        />\r\n                      ))}\r\n                    </AccordionPanel>\r\n                  </AccordionItem>\r\n                )}\r\n\r\n                {searchResultGroup.length > 0 && (\r\n                  <AccordionItem>\r\n                    <h2>\r\n                      <AccordionButton>\r\n                        <Box flex=\"1\" textAlign=\"left\" fontWeight=\"bold\">\r\n                          Group ({searchResultGroup.length})\r\n                        </Box>\r\n                        <AccordionIcon />\r\n                      </AccordionButton>\r\n                    </h2>\r\n                    <AccordionPanel pb={4}>\r\n                      {searchResultGroup?.map((chat, i) => (\r\n                        <GroupListItem\r\n                          key={chat._id}\r\n                          chat={chat}\r\n                          handleFunction={() => accessChat(chat._id)}\r\n                        />\r\n                      ))}\r\n                    </AccordionPanel>\r\n                  </AccordionItem>\r\n                )}\r\n              </Accordion>\r\n            )}\r\n            {/* Cái cục xoay xoay ở dưới cái kq tìm kím */}\r\n            {loadingChat && <Spinner ml=\"auto\" d=\"flex\" />}\r\n          </DrawerBody>\r\n        </DrawerContent>\r\n      </Drawer>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default SideDrawer;\r\n","import { Box } from \"@chakra-ui/layout\";\r\nimport { useEffect, useState, useContext } from \"react\";\r\nimport Chatbox from \"../components/Chatbox\";\r\nimport MyChats from \"../components/MyChats\";\r\nimport SideDrawer from \"../components/miscellaneous/SideDrawer\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport io from \"socket.io-client\";\r\nimport CallModal from \"../components/Call/CallModal\";\r\nimport {\r\n  useDisclosure,\r\n  useToast,\r\n} from \"@chakra-ui/react\";\r\nimport { getUserOther } from \"../config/ChatLogics\";\r\n// CallModal\r\n\r\nconst ENDPOINT = \"http://localhost:5000\"; // socket den\r\nvar socket;\r\nconst Chatpage = () => {\r\n  // dùng trong ChatBox\r\n  const user = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n  const [fetchAgain, setFetchAgain] = useState(false);\r\n  const history = useHistory();\r\n  const [socketConnected, setSocketConnected] = useState(false);\r\n  const { isOpen, onOpen, onClose } = useDisclosure();\r\n  const toast = useToast();\r\n  const [otherUser, setotherUser] = useState();\r\n  \r\n\r\n  useEffect(() => {\r\n    if (user == null) {\r\n      history.go(0);\r\n    }\r\n  }, [history]);\r\n\r\n  useEffect(() => {\r\n    socket = io(ENDPOINT);\r\n    socket.emit(\"setup\", user);\r\n    socket.on(\"connected\", () => setSocketConnected(true)); // client nhận được rồi mơi save dô client\r\n    \r\n    console.log(\"SINGLE CHAT:\", socket);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if(socket){\r\n      socket.on(\"callYYY\", (selectedChat) => {\r\n        console.log(\"alo call\");\r\n        if(user._id != getUserOther(user, selectedChat.users)._id){\r\n          setotherUser(getUserOther(user, selectedChat.users));\r\n          console.log(\"nguoi kia\", otherUser);\r\n          onOpen();\r\n        }\r\n        \r\n      });\r\n    }\r\n    \r\n  });\r\n\r\n  \r\n\r\n  return (\r\n    <>\r\n      <div style={{ width: \"100%\" }}>\r\n        {user && <SideDrawer />}\r\n        {/* <Button onClick={onOpen} >Hello</Button> */}\r\n        <Box\r\n          d=\"flex\"\r\n          justifyContent=\"space-between\"\r\n          w=\"100%\"\r\n          h=\"91.5vh\"\r\n          p=\"10px\"\r\n        >\r\n          {user && <MyChats fetchAgain={fetchAgain} socket={socket} />}\r\n          {user && (\r\n            <Chatbox\r\n              fetchAgain={fetchAgain}\r\n              setFetchAgain={setFetchAgain}\r\n              socket={socket}\r\n              socketConnected={socketConnected}\r\n            />\r\n          )}\r\n        </Box>\r\n      </div>\r\n\r\n      <CallModal \r\n      onOpen={onOpen} \r\n      onClose={onClose} \r\n      isOpen={isOpen} \r\n      otherUser={otherUser}\r\n      socket={socket} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Chatpage;\r\n","import {\r\n  Modal,\r\n  ModalOverlay,\r\n  ModalContent,\r\n  ModalHeader,\r\n  ModalFooter,\r\n  ModalBody,\r\n  ModalCloseButton,\r\n  Text,\r\n  useToast,\r\n  Box,\r\n  IconButton,\r\n} from \"@chakra-ui/react\";\r\nimport { Avatar } from \"@chakra-ui/avatar\";\r\nimport { IoCallOutline } from \"react-icons/io5\";\r\n\r\nconst CallModal = ({ isOpen, onOpen, onClose, otherUser, socket }) => {\r\n  const toast = useToast();\r\n\r\n  const openNewWindow = () => {\r\n    // console.log(\"hello ko ra\");\r\n    const params = `scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no,width=300,height=300`;\r\n    window.open(\r\n      \"http://localhost:3002/?id=\" + otherUser._id,\r\n      \"tri\",\r\n      params\r\n    );\r\n    if (socket) {\r\n      // socket.emit(\"callXXX\", selectedChat);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* <span onChange={onOpen}>{children}</span> */}\r\n      {otherUser && (\r\n        <Modal size=\"xl\" onOpen={onOpen} onClose={onClose} isOpen={isOpen}>\r\n          <ModalOverlay />\r\n          <ModalContent>\r\n            <ModalHeader\r\n              fontSize=\"35px\"\r\n              fontFamily=\"Work sans\"\r\n              d=\"flex\"\r\n              justifyContent=\"center\"\r\n            >\r\n              <Avatar\r\n                mr={2}\r\n                size=\"md\"\r\n                cursor=\"pointer\"\r\n                name={otherUser.name}\r\n                src={otherUser.pic}\r\n              />\r\n              <Text fontSize=\"15px\">{otherUser.name}</Text>\r\n            </ModalHeader>\r\n            <ModalCloseButton />\r\n            <ModalBody d=\"flex\" flexDir=\"column\" alignItems=\"center\">\r\n              <IconButton \r\n              onClick={openNewWindow}\r\n              icon={<IoCallOutline />} />\r\n              <IconButton />\r\n            </ModalBody>\r\n            <ModalFooter></ModalFooter>\r\n          </ModalContent>\r\n        </Modal>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CallModal;\r\n","import { AddIcon } from \"@chakra-ui/icons\";\r\nimport { Text, Box } from \"@chakra-ui/react\";\r\nimport {  Stack } from \"@chakra-ui/layout\";\r\nimport { useToast } from \"@chakra-ui/toast\";\r\nimport axios from \"axios\";\r\nimport { useDisclosure } from \"@chakra-ui/hooks\";\r\nimport { useEffect, useState } from \"react\";\r\nimport {\r\n  Accordion,\r\n  AccordionItem,\r\n  AccordionButton,\r\n  AccordionPanel,\r\n  IconButton,\r\n  AccordionIcon,\r\n} from \"@chakra-ui/react\";\r\nimport { Button } from \"@chakra-ui/react\";\r\nimport { ChatState } from \"../../Context/ChatProvider\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport ScrollableFeed from \"react-scrollable-feed\";\r\nimport { Divider } from \"@chakra-ui/react\";\r\nimport UserListItem from \"../userAvatar/UserListItem\";\r\nimport ChatLoading from \"../ChatLoading\";\r\n\r\nconst MyFriends = () => {\r\n  const { user, setSelectedChat, chats, setChats, setselectedFriend } = ChatState();\r\n\r\n  const toast = useToast();\r\n  const [friends, setFriens] = useState([]);\r\n  const [loadingChat, setLoadingChat] = useState(false);\r\n\r\n  const history = useHistory();\r\n\r\n  const handleTimeSend = (timeSend) => {\r\n    const date = new Date(timeSend);\r\n\r\n    return date.toLocaleString(\"en-US\", {\r\n      hour12: false,\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchFriend();\r\n  }, []);\r\n\r\n  const fetchFriend = async () => {\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      const { data } = await axios.post(\r\n        \"/api/friend/getListFriend\",\r\n        {\r\n          userId: user._id,\r\n        },\r\n        config\r\n      );\r\n      console.log(\"friends\", data);\r\n      setFriens(data);\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error Occured!\",\r\n        description: \"Failed to Load the chats\",\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n  const accessChat = async (userId) => {\r\n    try {\r\n      setLoadingChat(true);\r\n      const config = {\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n          Authorization: `Bearer ${user.token}`,\r\n        },\r\n      };\r\n      // const { data } = await axios.post(`/api/chat`, { userId }, config);\r\n      const { data } = await axios.post(`/api/chat`, { userId }, config);\r\n      if (!chats.find((c) => c._id === data._id)) setChats([data, ...chats]);\r\n\r\n      // console.log(\"ban be: \", data);\r\n\r\n      setSelectedChat(data);\r\n      setselectedFriend(false);\r\n      setLoadingChat(false);\r\n      // console.log(\"ra ta ta ta: \", data);\r\n      history.push(\"/chats\");\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Error fetching the chat\",\r\n        description: error.message,\r\n        status: \"error\",\r\n        duration: 5000,\r\n        isClosable: true,\r\n        position: \"bottom-left\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        d=\"flex\"\r\n        flexDir=\"column\"\r\n        alignItems=\"left\"\r\n        pt={3}\r\n        bg=\"white\"\r\n        w={{ base: \"100%\", md: \"25%\" }}\r\n        borderRadius=\"lg\"\r\n        borderWidth=\"1px\"\r\n      >\r\n        <Box\r\n          fontSize={{ base: \"28px\", md: \"50px\" }}\r\n          w=\"100%\"\r\n          bg=\"white\"\r\n          alignItems=\"center\"\r\n        >\r\n          <ScrollableFeed bg=\"white\">\r\n            <Box\r\n              fontSize={{ base: \"28px\", md: \"30px\" }}\r\n              fontFamily=\"Work sans\"\r\n              d=\"block\"\r\n              w=\"100%\"\r\n              justifyContent=\"space-between\"\r\n              alignItems=\"initial\"\r\n            >\r\n              <Button\r\n                d=\"flex\"\r\n                w=\"100%\"\r\n                leftIcon={<AddIcon />}\r\n                bg=\"white\"\r\n                fontSize=\"15px\"\r\n                justifyContent=\"initial\"\r\n              >\r\n                Add New Friend By Email\r\n              </Button>\r\n              <Button\r\n                d=\"flex\"\r\n                w=\"100%\"\r\n                leftIcon={<AddIcon />}\r\n                bg=\"white\"\r\n                justifyContent=\"initial\"\r\n                fontSize=\"17px\"\r\n              >\r\n                List Friends\r\n              </Button>\r\n              <Button\r\n                d=\"flex\"\r\n                w=\"100%\"\r\n                leftIcon={<AddIcon />}\r\n                bg=\"white\"\r\n                justifyContent=\"initial\"\r\n                fontSize=\"17px\"\r\n              >\r\n                List Groups\r\n              </Button>\r\n            </Box>\r\n            <Divider orientation=\"horizontal\" bg=\"gray.200\" h=\"2px\" />\r\n            <Box\r\n              d=\"flex\"\r\n              flexDir=\"column\"\r\n              p={3}\r\n              bg=\"white\"\r\n              w=\"100%\"\r\n              h=\"100%\"\r\n              borderRadius=\"lg\"\r\n              overflowY=\"hidden\"\r\n            >\r\n              <Accordion defaultIndex={[0]} allowMultiple>\r\n                <AccordionItem>\r\n                  <AccordionButton>\r\n                    <Box flex=\"1\" textAlign=\"left\">\r\n                      My Friends\r\n                    </Box>\r\n                    <AccordionIcon />\r\n                  </AccordionButton>\r\n\r\n                  <AccordionPanel pb={4}>\r\n                    {friends ? (\r\n                      <Stack overflowY=\"scroll\">\r\n                        {friends.map((friend) => (\r\n                          <Box key={friend._id}>\r\n                            <Text fontSize=\"20px\">\r\n                              <UserListItem\r\n                                key={friend._id}\r\n                                user={friend}\r\n                                handleFunction={() => accessChat(friend._id)}\r\n                              />\r\n                            </Text>\r\n                          </Box>\r\n                        ))}\r\n                      </Stack>\r\n                    ) : (\r\n                      <ChatLoading />\r\n                    )}\r\n                  </AccordionPanel>\r\n                </AccordionItem>\r\n              </Accordion>\r\n            </Box>\r\n          </ScrollableFeed>\r\n        </Box>\r\n      </Box>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MyFriends;\r\n","import { Box, Text } from \"@chakra-ui/layout\";\r\nimport ScrollableFeed from \"react-scrollable-feed\";\r\n\r\n\r\n\r\nconst ScrollableFriend = () => {\r\n  // const [displayText, setDisplayText] = useState(\"flex\");\r\n  // const [displayPic, setDisplayPic] = useState(\"flex\");\r\n  \r\n \r\n  return (\r\n\r\n    \r\n    <>\r\n    <ScrollableFeed>\r\n     \r\n    </ScrollableFeed>\r\n    \r\n    </>\r\n  );\r\n};\r\n\r\nexport default ScrollableFriend;","import { Box,  } from \"@chakra-ui/layout\";\r\nimport ScrollableFriend from \"./ScrollableFriend\";\r\n// import callwindow from \"./Call/callwindow\";\r\n\r\nconst FriendTable = ({ fetchAgain }) => {\r\n\r\n\r\n  return (\r\n    <>\r\n      <Box\r\n        // Boostrap, mất nếu thu nhỏ\r\n        d={{ base:  \"flex\" , md: \"flex\" }}\r\n        alignItems=\"center\"\r\n        flexDir=\"column\"\r\n        p={3}\r\n        bg=\"white\"\r\n        w={{ base: \"100%\", md: \"74%\" }}\r\n        borderRadius=\"lg\"\r\n        borderWidth=\"1px\"\r\n      >\r\n        <ScrollableFriend></ScrollableFriend>\r\n\r\n      </Box>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default FriendTable;\r\n\r\n{\r\n  /* Ko là group chat -> thì hiện tên user*/\r\n}","import { Box } from \"@chakra-ui/layout\";\r\nimport { useEffect, useState,  } from \"react\";\r\nimport SideDrawer from \"../components/miscellaneous/SideDrawer\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport MyFriends from \"../components/FriendComponent/MyFriend\";\r\nimport FriendTable from \"../components/FriendComponent/FriendTable\";\r\n\r\nconst Friendpage = () => {\r\n  // dùng trong ChatBox\r\n  const user = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n  const [fetchAgain, setFetchAgain] = useState(false);\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    if (user == null) {\r\n      history.go(0);\r\n    }\r\n  }, [history]);\r\n  return (\r\n    <div style={{ width: \"100%\" }}>\r\n      {user && <SideDrawer />}\r\n      <Box\r\n        d=\"flex\"\r\n        justifyContent=\"space-between\"\r\n        w=\"100%\"\r\n        h=\"91.5vh\"\r\n        p=\"10px\"\r\n      >\r\n        {/* fetchAgain={fetchAgain}  */}\r\n        {user && <MyFriends />}\r\n        <FriendTable fetchAgain={fetchAgain} />\r\n      </Box>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Friendpage;\r\n","import \"./App.css\";\r\nimport Homepage from \"./Pages/Homepage\";\r\nimport { Route } from \"react-router-dom\";\r\nimport Chatpage from \"./Pages/Chatpage\";\r\nimport ChatProvider from \"./Context/ChatProvider\";\r\nimport Friendpage from \"./Pages/ChatFriend\";\r\n\r\nfunction App() {\r\n  return (\r\n    <ChatProvider>\r\n      <div className=\"App\">\r\n        {/* exact: 2 route sẽ đụng nhau, do cùng path nên thêm keyword -> khỏi đụn */}\r\n        <Route path=\"/\" component={Homepage} exact />\r\n        <Route path=\"/provider\" component={ChatProvider} />\r\n        <Route path=\"/chats\" component={Chatpage} />\r\n        <Route path=\"/friend\" component={Friendpage} />\r\n        \r\n      </div>\r\n    </ChatProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport { ChakraProvider } from \"@chakra-ui/react\";\r\nimport ChatProvider from \"./Context/ChatProvider\";\r\nimport { BrowserRouter, HashRouter } from \"react-router-dom\";\r\n\r\nReactDOM.render(\r\n  \r\n  <ChakraProvider>\r\n    <BrowserRouter>\r\n    <ChatProvider>\r\n        <App />\r\n    </ChatProvider> \r\n    </BrowserRouter>\r\n  </ChakraProvider>,\r\n  document.getElementById(\"root\")\r\n);\r\nreportWebVitals();\r\n"],"sourceRoot":""}